<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>A Computer Practical 1 - Missing data | Clinical Trials 4H</title>
  <meta name="description" content="These notes mirror what we’ll follow in lectures for Clinical Trials 4H. If you have any questions or notice any errors, please email me (Rachel Oughton)." />
  <meta name="generator" content="bookdown 0.42 and GitBook 2.6.7" />

  <meta property="og:title" content="A Computer Practical 1 - Missing data | Clinical Trials 4H" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="These notes mirror what we’ll follow in lectures for Clinical Trials 4H. If you have any questions or notice any errors, please email me (Rachel Oughton)." />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="A Computer Practical 1 - Missing data | Clinical Trials 4H" />
  
  <meta name="twitter:description" content="These notes mirror what we’ll follow in lectures for Clinical Trials 4H. If you have any questions or notice any errors, please email me (Rachel Oughton)." />
  

<meta name="author" content="Rachel Oughton" />


<meta name="date" content="2025-03-14" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="comparing-survival-curves.html"/>
<link rel="next" href="computer-practical-2---allocation-analysis.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<link href="libs/font-awesome-6.5.2/css/all.min.css" rel="stylesheet" />
<link href="libs/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet" />
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<link href="libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="libs/pagedtable-1.1/js/pagedtable.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #204a87; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #8f5902; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #204a87; font-weight: bold; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #ce5c00; font-weight: bold; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Welcome to Clinical Trials 4H!</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#practical-details"><i class="fa fa-check"></i>Practical details</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#lectures"><i class="fa fa-check"></i>Lectures</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#computer-classes"><i class="fa fa-check"></i>Computer classes</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#office-hour"><i class="fa fa-check"></i>Office Hour</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#assessment"><i class="fa fa-check"></i>Assessment</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#books-and-resources"><i class="fa fa-check"></i>Books and resources</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#what-to-expect-from-this-module"><i class="fa fa-check"></i>What to expect from this module</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#what-i-expect-from-you"><i class="fa fa-check"></i>What I expect from you</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="1" data-path="rct-intro.html"><a href="rct-intro.html"><i class="fa fa-check"></i><b>1</b> Introduction to Clinical Trials</a>
<ul>
<li class="chapter" data-level="1.1" data-path="rct-intro.html"><a href="rct-intro.html#causal-inference-and-clinical-trials"><i class="fa fa-check"></i><b>1.1</b> Causal inference and clinical trials</a></li>
<li class="chapter" data-level="1.2" data-path="rct-intro.html"><a href="rct-intro.html#the-structure-of-a-clinical-trial"><i class="fa fa-check"></i><b>1.2</b> The structure of a clinical trial</a>
<ul>
<li class="chapter" data-level="" data-path="rct-intro.html"><a href="rct-intro.html#the-population-of-eligible-patients"><i class="fa fa-check"></i>The population of eligible patients</a></li>
<li class="chapter" data-level="" data-path="rct-intro.html"><a href="rct-intro.html#entry-to-the-trial"><i class="fa fa-check"></i>Entry to the trial</a></li>
<li class="chapter" data-level="" data-path="rct-intro.html"><a href="rct-intro.html#allocation-to-groups"><i class="fa fa-check"></i>Allocation to groups</a></li>
<li class="chapter" data-level="" data-path="rct-intro.html"><a href="rct-intro.html#comparing-results"><i class="fa fa-check"></i>Comparing results</a></li>
<li class="chapter" data-level="" data-path="rct-intro.html"><a href="rct-intro.html#why-bother-with-a-control-group"><i class="fa fa-check"></i>Why bother with a control group?</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="rct-intro.html"><a href="rct-intro.html#primout"><i class="fa fa-check"></i><b>1.3</b> The primary outcome</a></li>
<li class="chapter" data-level="1.4" data-path="rct-intro.html"><a href="rct-intro.html#ethical-issues"><i class="fa fa-check"></i><b>1.4</b> Ethical issues</a></li>
<li class="chapter" data-level="1.5" data-path="rct-intro.html"><a href="rct-intro.html#phases-of-clinical-trials"><i class="fa fa-check"></i><b>1.5</b> Phases of clinical trials</a>
<ul>
<li class="chapter" data-level="" data-path="rct-intro.html"><a href="rct-intro.html#phase-zero"><i class="fa fa-check"></i>Phase zero</a></li>
<li class="chapter" data-level="" data-path="rct-intro.html"><a href="rct-intro.html#phase-one"><i class="fa fa-check"></i>Phase one</a></li>
<li class="chapter" data-level="" data-path="rct-intro.html"><a href="rct-intro.html#phase-two"><i class="fa fa-check"></i>Phase two</a></li>
<li class="chapter" data-level="" data-path="rct-intro.html"><a href="rct-intro.html#phase-three"><i class="fa fa-check"></i>Phase three</a></li>
<li class="chapter" data-level="" data-path="rct-intro.html"><a href="rct-intro.html#phase-four"><i class="fa fa-check"></i>Phase four</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>I Part I: Continuous outcome variables</b></span></li>
<li class="chapter" data-level="2" data-path="rct-plan.html"><a href="rct-plan.html"><i class="fa fa-check"></i><b>2</b> Sample size for a normally distributed primary outcome variable</a>
<ul>
<li class="chapter" data-level="2.1" data-path="rct-plan.html"><a href="rct-plan.html#the-treatment-effect"><i class="fa fa-check"></i><b>2.1</b> The treatment effect</a></li>
<li class="chapter" data-level="2.2" data-path="rct-plan.html"><a href="rct-plan.html#reminder-hypothesis-tests-with-a-focus-on-rcts"><i class="fa fa-check"></i><b>2.2</b> Reminder: hypothesis tests (with a focus on RCTs)</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="rct-plan.html"><a href="rct-plan.html#one-tailed-or-two-tailed"><i class="fa fa-check"></i><b>2.2.1</b> One-tailed or two-tailed?</a></li>
<li class="chapter" data-level="2.2.2" data-path="rct-plan.html"><a href="rct-plan.html#insignificant-results"><i class="fa fa-check"></i><b>2.2.2</b> Insignificant results</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="rct-plan.html"><a href="rct-plan.html#sec-measDcont"><i class="fa fa-check"></i><b>2.3</b> Constructing a measure of effect size</a></li>
<li class="chapter" data-level="2.4" data-path="rct-plan.html"><a href="rct-plan.html#sec-power"><i class="fa fa-check"></i><b>2.4</b> Power: If <span class="math inline">\(H_0\)</span> is false</a></li>
<li class="chapter" data-level="2.5" data-path="rct-plan.html"><a href="rct-plan.html#sec-ssformulacont"><i class="fa fa-check"></i><b>2.5</b> A sample size formula</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="alloc.html"><a href="alloc.html"><i class="fa fa-check"></i><b>3</b> Allocation</a>
<ul>
<li class="chapter" data-level="3.1" data-path="alloc.html"><a href="alloc.html#bias"><i class="fa fa-check"></i><b>3.1</b> Bias</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="alloc.html"><a href="alloc.html#where-does-bias-come-from"><i class="fa fa-check"></i><b>3.1.1</b> Where does bias come from?</a></li>
<li class="chapter" data-level="3.1.2" data-path="alloc.html"><a href="alloc.html#implications-for-allocation"><i class="fa fa-check"></i><b>3.1.2</b> Implications for allocation</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="alloc.html"><a href="alloc.html#sec-allocation"><i class="fa fa-check"></i><b>3.2</b> Allocation methods</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="alloc.html"><a href="alloc.html#simple-random-allocation"><i class="fa fa-check"></i><b>3.2.1</b> Simple random allocation</a></li>
<li class="chapter" data-level="3.2.2" data-path="alloc.html"><a href="alloc.html#random-permuted-blocks"><i class="fa fa-check"></i><b>3.2.2</b> Random permuted blocks</a></li>
<li class="chapter" data-level="3.2.3" data-path="alloc.html"><a href="alloc.html#bcurn"><i class="fa fa-check"></i><b>3.2.3</b> Biased coin designs and urn schemes</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="alloc.html"><a href="alloc.html#incorporating-baseline-measurements"><i class="fa fa-check"></i><b>3.3</b> Incorporating baseline measurements</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="alloc.html"><a href="alloc.html#stratified-sampling"><i class="fa fa-check"></i><b>3.3.1</b> Stratified sampling</a></li>
<li class="chapter" data-level="3.3.2" data-path="alloc.html"><a href="alloc.html#minimization"><i class="fa fa-check"></i><b>3.3.2</b> Minimization</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="alloc.html"><a href="alloc.html#problems-around-allocation"><i class="fa fa-check"></i><b>3.4</b> Problems around allocation</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="rct-analysis.html"><a href="rct-analysis.html"><i class="fa fa-check"></i><b>4</b> Analyzing RCT data</a>
<ul>
<li class="chapter" data-level="4.1" data-path="rct-analysis.html"><a href="rct-analysis.html#ttest"><i class="fa fa-check"></i><b>4.1</b> Confidence intervals and P-values</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="rct-analysis.html"><a href="rct-analysis.html#what-do-we-do-with-this-outcome"><i class="fa fa-check"></i><b>4.1.1</b> What do we do with this outcome?</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="rct-analysis.html"><a href="rct-analysis.html#baseline"><i class="fa fa-check"></i><b>4.2</b> Using baseline values</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="rct-analysis.html"><a href="rct-analysis.html#the-variance-of-the-treatment-effect-estimate"><i class="fa fa-check"></i><b>4.2.1</b> The variance of the treatment effect estimate</a></li>
<li class="chapter" data-level="4.2.2" data-path="rct-analysis.html"><a href="rct-analysis.html#a-dodgy-way-to-use-baseline-variables"><i class="fa fa-check"></i><b>4.2.2</b> A dodgy way to use baseline variables</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="rct-analysis.html"><a href="rct-analysis.html#analysis-of-covariance-ancova"><i class="fa fa-check"></i><b>4.3</b> Analysis of covariance (ANCOVA)</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="rct-analysis.html"><a href="rct-analysis.html#ancovatheory"><i class="fa fa-check"></i><b>4.3.1</b> The theory</a></li>
<li class="chapter" data-level="4.3.2" data-path="rct-analysis.html"><a href="rct-analysis.html#ancova-practice"><i class="fa fa-check"></i><b>4.3.2</b> The practice</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="rct-analysis.html"><a href="rct-analysis.html#some-follow-up-questions."><i class="fa fa-check"></i><b>4.4</b> Some follow-up questions….</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="rct-analysis.html"><a href="rct-analysis.html#didnt-we-say-that-x_t---x_c-was-an-unbiased-estimator-of-tau"><i class="fa fa-check"></i><b>4.4.1</b> Didn’t we say that <span class="math inline">\(X_T - X_C\)</span> was an unbiased estimator of <span class="math inline">\(\tau\)</span>?</a></li>
<li class="chapter" data-level="4.4.2" data-path="rct-analysis.html"><a href="rct-analysis.html#what-if-the-lines-shouldnt-be-parallel-the-unequal-slopes-model"><i class="fa fa-check"></i><b>4.4.2</b> What if the lines shouldn’t be parallel? The unequal slopes model</a></li>
<li class="chapter" data-level="4.4.3" data-path="rct-analysis.html"><a href="rct-analysis.html#can-we-include-any-other-baseline-covariates"><i class="fa fa-check"></i><b>4.4.3</b> Can we include any other baseline covariates?</a></li>
<li class="chapter" data-level="" data-path="rct-analysis.html"><a href="rct-analysis.html#an-important-caution"><i class="fa fa-check"></i>An important caution!</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>II Part II: Binary outcome variable</b></span></li>
<li class="chapter" data-level="5" data-path="ss-bin.html"><a href="ss-bin.html"><i class="fa fa-check"></i><b>5</b> Sample size for a binary variable</a>
<ul>
<li class="chapter" data-level="5.1" data-path="ss-bin.html"><a href="ss-bin.html#delta-method"><i class="fa fa-check"></i><b>5.1</b> The Delta Method</a></li>
<li class="chapter" data-level="5.2" data-path="ss-bin.html"><a href="ss-bin.html#a-sample-size-formula"><i class="fa fa-check"></i><b>5.2</b> A sample size formula</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="binary-analysis.html"><a href="binary-analysis.html"><i class="fa fa-check"></i><b>6</b> Analysis for binary outcomes</a>
<ul>
<li class="chapter" data-level="6.1" data-path="binary-analysis.html"><a href="binary-analysis.html#bin-point-est"><i class="fa fa-check"></i><b>6.1</b> Simple hypothesis tests</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="binary-analysis.html"><a href="binary-analysis.html#a-simple-method-chi-squared"><i class="fa fa-check"></i><b>6.1.1</b> A simple method: chi-squared</a></li>
<li class="chapter" data-level="6.1.2" data-path="binary-analysis.html"><a href="binary-analysis.html#likelihood-a-more-rigorous-way"><i class="fa fa-check"></i><b>6.1.2</b> Likelihood: A more rigorous way</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="binary-analysis.html"><a href="binary-analysis.html#measures-of-difference-for-binary-data"><i class="fa fa-check"></i><b>6.2</b> Measures of difference for binary data</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="binary-analysis.html"><a href="binary-analysis.html#ard-and-nnt"><i class="fa fa-check"></i><b>6.2.1</b> Absolute risk difference and Number Needed to Treat</a></li>
<li class="chapter" data-level="6.2.2" data-path="binary-analysis.html"><a href="binary-analysis.html#risk-ratio-rr-and-odds-ratio-or"><i class="fa fa-check"></i><b>6.2.2</b> Risk Ratio (RR) and Odds ratio (OR)</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="binary-analysis.html"><a href="binary-analysis.html#logreg"><i class="fa fa-check"></i><b>6.3</b> Accounting for baseline observations: logistic regression</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="binary-analysis.html"><a href="binary-analysis.html#what-does-this-model-tell-us"><i class="fa fa-check"></i><b>6.3.1</b> What does this model tell us?</a></li>
<li class="chapter" data-level="6.3.2" data-path="binary-analysis.html"><a href="binary-analysis.html#fitting-a-logistic-regression-model"><i class="fa fa-check"></i><b>6.3.2</b> Fitting a logistic regression model</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="binary-analysis.html"><a href="binary-analysis.html#diaglogreg"><i class="fa fa-check"></i><b>6.4</b> Diagnostics for logistic regression</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="binary-analysis.html"><a href="binary-analysis.html#discrimination"><i class="fa fa-check"></i><b>6.4.1</b> Discrimination</a></li>
<li class="chapter" data-level="6.4.2" data-path="binary-analysis.html"><a href="binary-analysis.html#calibration"><i class="fa fa-check"></i><b>6.4.2</b> Calibration</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>III Part III: Survival data</b></span></li>
<li class="chapter" data-level="7" data-path="working-with-time-to-event-data.html"><a href="working-with-time-to-event-data.html"><i class="fa fa-check"></i><b>7</b> Working with time-to-event data</a>
<ul>
<li class="chapter" data-level="7.1" data-path="working-with-time-to-event-data.html"><a href="working-with-time-to-event-data.html#censored-times"><i class="fa fa-check"></i><b>7.1</b> Censored times</a></li>
<li class="chapter" data-level="7.2" data-path="working-with-time-to-event-data.html"><a href="working-with-time-to-event-data.html#survhaz"><i class="fa fa-check"></i><b>7.2</b> The Survival Curve and the Hazard function</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="working-with-time-to-event-data.html"><a href="working-with-time-to-event-data.html#the-kaplan-meier-estimator"><i class="fa fa-check"></i><b>7.2.1</b> The Kaplan-Meier estimator</a></li>
<li class="chapter" data-level="7.2.2" data-path="working-with-time-to-event-data.html"><a href="working-with-time-to-event-data.html#a-parametric-approach"><i class="fa fa-check"></i><b>7.2.2</b> A parametric approach</a></li>
<li class="chapter" data-level="7.2.3" data-path="working-with-time-to-event-data.html"><a href="working-with-time-to-event-data.html#weibull"><i class="fa fa-check"></i><b>7.2.3</b> The Weibull distribution</a></li>
<li class="chapter" data-level="" data-path="working-with-time-to-event-data.html"><a href="working-with-time-to-event-data.html#aside-sample-size-calculations-for-time-to-event-data"><i class="fa fa-check"></i>Aside: Sample size calculations for time-to-event data</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="comparing-survival-curves.html"><a href="comparing-survival-curves.html"><i class="fa fa-check"></i><b>8</b> Comparing survival curves</a>
<ul>
<li class="chapter" data-level="8.1" data-path="comparing-survival-curves.html"><a href="comparing-survival-curves.html#survlrtest"><i class="fa fa-check"></i><b>8.1</b> Parametric: likelihood ratio test</a></li>
<li class="chapter" data-level="8.2" data-path="comparing-survival-curves.html"><a href="comparing-survival-curves.html#non-parametric-the-log-rank-test"><i class="fa fa-check"></i><b>8.2</b> Non-parametric: the log-rank test</a></li>
<li class="chapter" data-level="8.3" data-path="comparing-survival-curves.html"><a href="comparing-survival-curves.html#semi-parametric-the-proportional-hazards-model"><i class="fa fa-check"></i><b>8.3</b> Semi-parametric: the proportional hazards model</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="comparing-survival-curves.html"><a href="comparing-survival-curves.html#general-proportional-hazards-model"><i class="fa fa-check"></i><b>8.3.1</b> General proportional hazards model</a></li>
<li class="chapter" data-level="8.3.2" data-path="comparing-survival-curves.html"><a href="comparing-survival-curves.html#coxreg"><i class="fa fa-check"></i><b>8.3.2</b> Cox regression</a></li>
<li class="chapter" data-level="" data-path="comparing-survival-curves.html"><a href="comparing-survival-curves.html#how-can-we-tell-if-a-proportional-hazards-model-is-appropriate"><i class="fa fa-check"></i>How can we tell if a proportional hazards model is appropriate?</a></li>
<li class="chapter" data-level="8.3.3" data-path="comparing-survival-curves.html"><a href="comparing-survival-curves.html#diagnostics-for-cox-regression"><i class="fa fa-check"></i><b>8.3.3</b> Diagnostics for Cox regression</a></li>
</ul></li>
</ul></li>
<li class="appendix"><span><b>Computer practicals</b></span></li>
<li class="chapter" data-level="A" data-path="computer-practical-1---missing-data.html"><a href="computer-practical-1---missing-data.html"><i class="fa fa-check"></i><b>A</b> Computer Practical 1 - Missing data</a>
<ul>
<li class="chapter" data-level="" data-path="computer-practical-1---missing-data.html"><a href="computer-practical-1---missing-data.html#r-practicalities"><i class="fa fa-check"></i>R practicalities</a></li>
<li class="chapter" data-level="A.1" data-path="computer-practical-1---missing-data.html"><a href="computer-practical-1---missing-data.html#missing-data"><i class="fa fa-check"></i><b>A.1</b> Missing data</a>
<ul>
<li class="chapter" data-level="A.1.1" data-path="computer-practical-1---missing-data.html"><a href="computer-practical-1---missing-data.html#datasets"><i class="fa fa-check"></i><b>A.1.1</b> Datasets</a></li>
</ul></li>
<li class="chapter" data-level="A.2" data-path="computer-practical-1---missing-data.html"><a href="computer-practical-1---missing-data.html#understanding-the-patterns-of-missingness"><i class="fa fa-check"></i><b>A.2</b> Understanding the patterns of missingness</a>
<ul>
<li class="chapter" data-level="A.2.1" data-path="computer-practical-1---missing-data.html"><a href="computer-practical-1---missing-data.html#visualising-missingness"><i class="fa fa-check"></i><b>A.2.1</b> Visualising missingness</a></li>
<li class="chapter" data-level="A.2.2" data-path="computer-practical-1---missing-data.html"><a href="computer-practical-1---missing-data.html#summary-tables"><i class="fa fa-check"></i><b>A.2.2</b> Summary tables</a></li>
<li class="chapter" data-level="A.2.3" data-path="computer-practical-1---missing-data.html"><a href="computer-practical-1---missing-data.html#mechanisms-of-missingness"><i class="fa fa-check"></i><b>A.2.3</b> Mechanisms of missingness</a></li>
</ul></li>
<li class="chapter" data-level="A.3" data-path="computer-practical-1---missing-data.html"><a href="computer-practical-1---missing-data.html#exploring-the-relationship-between-missingness-and-other-variables"><i class="fa fa-check"></i><b>A.3</b> Exploring the relationship between missingness and other variables</a>
<ul>
<li class="chapter" data-level="A.3.1" data-path="computer-practical-1---missing-data.html"><a href="computer-practical-1---missing-data.html#sec-statsum"><i class="fa fa-check"></i><b>A.3.1</b> Statistical summaries of the effect of missingness</a></li>
<li class="chapter" data-level="A.3.2" data-path="computer-practical-1---missing-data.html"><a href="computer-practical-1---missing-data.html#modelling-missingness"><i class="fa fa-check"></i><b>A.3.2</b> Modelling missingness</a></li>
</ul></li>
<li class="chapter" data-level="A.4" data-path="computer-practical-1---missing-data.html"><a href="computer-practical-1---missing-data.html#what-to-do-about-missing-data"><i class="fa fa-check"></i><b>A.4</b> What to do about missing data?!</a>
<ul>
<li class="chapter" data-level="A.4.1" data-path="computer-practical-1---missing-data.html"><a href="computer-practical-1---missing-data.html#discarding-some-non-missing-data"><i class="fa fa-check"></i><b>A.4.1</b> Discarding some (non-missing) data</a></li>
<li class="chapter" data-level="A.4.2" data-path="computer-practical-1---missing-data.html"><a href="computer-practical-1---missing-data.html#imputing-data"><i class="fa fa-check"></i><b>A.4.2</b> Imputing data</a></li>
<li class="chapter" data-level="A.4.3" data-path="computer-practical-1---missing-data.html"><a href="computer-practical-1---missing-data.html#multiple-imputation"><i class="fa fa-check"></i><b>A.4.3</b> Multiple imputation</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="B" data-path="computer-practical-2---allocation-analysis.html"><a href="computer-practical-2---allocation-analysis.html"><i class="fa fa-check"></i><b>B</b> Computer Practical 2 - Allocation &amp; Analysis</a>
<ul>
<li class="chapter" data-level="" data-path="computer-practical-2---allocation-analysis.html"><a href="computer-practical-2---allocation-analysis.html#health-warning"><i class="fa fa-check"></i>Health warning!</a>
<ul>
<li class="chapter" data-level="" data-path="computer-practical-2---allocation-analysis.html"><a href="computer-practical-2---allocation-analysis.html#preliminaries"><i class="fa fa-check"></i>Preliminaries</a></li>
<li class="chapter" data-level="" data-path="computer-practical-2---allocation-analysis.html"><a href="computer-practical-2---allocation-analysis.html#r-practicalities-1"><i class="fa fa-check"></i>R practicalities</a></li>
</ul></li>
<li class="chapter" data-level="B.1" data-path="computer-practical-2---allocation-analysis.html"><a href="computer-practical-2---allocation-analysis.html#cp1allocation"><i class="fa fa-check"></i><b>B.1</b> Allocation</a>
<ul>
<li class="chapter" data-level="B.1.1" data-path="computer-practical-2---allocation-analysis.html"><a href="computer-practical-2---allocation-analysis.html#licorice-gargle-dataset"><i class="fa fa-check"></i><b>B.1.1</b> Licorice gargle dataset</a></li>
<li class="chapter" data-level="B.1.2" data-path="computer-practical-2---allocation-analysis.html"><a href="computer-practical-2---allocation-analysis.html#allocmethods"><i class="fa fa-check"></i><b>B.1.2</b> Allocation methods</a></li>
<li class="chapter" data-level="B.1.3" data-path="computer-practical-2---allocation-analysis.html"><a href="computer-practical-2---allocation-analysis.html#stratifying-the-dataset"><i class="fa fa-check"></i><b>B.1.3</b> Stratifying the dataset</a></li>
<li class="chapter" data-level="B.1.4" data-path="computer-practical-2---allocation-analysis.html"><a href="computer-practical-2---allocation-analysis.html#minimisation"><i class="fa fa-check"></i><b>B.1.4</b> Minimisation</a></li>
</ul></li>
<li class="chapter" data-level="B.2" data-path="computer-practical-2---allocation-analysis.html"><a href="computer-practical-2---allocation-analysis.html#cp1analysis"><i class="fa fa-check"></i><b>B.2</b> Analysis</a>
<ul>
<li class="chapter" data-level="B.2.1" data-path="computer-practical-2---allocation-analysis.html"><a href="computer-practical-2---allocation-analysis.html#polyps-data"><i class="fa fa-check"></i><b>B.2.1</b> Polyps data</a></li>
</ul></li>
<li class="chapter" data-level="B.3" data-path="computer-practical-2---allocation-analysis.html"><a href="computer-practical-2---allocation-analysis.html#extension-problems"><i class="fa fa-check"></i><b>B.3</b> Extension problems</a>
<ul>
<li class="chapter" data-level="B.3.1" data-path="computer-practical-2---allocation-analysis.html"><a href="computer-practical-2---allocation-analysis.html#a-simulation-experiment"><i class="fa fa-check"></i><b>B.3.1</b> A simulation experiment!</a></li>
<li class="chapter" data-level="B.3.2" data-path="computer-practical-2---allocation-analysis.html"><a href="computer-practical-2---allocation-analysis.html#treatment-for-maternal-periodontal-disease"><i class="fa fa-check"></i><b>B.3.2</b> Treatment for maternal periodontal disease</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="C" data-path="cp3sim.html"><a href="cp3sim.html"><i class="fa fa-check"></i><b>C</b> Computer Practical 3 - Sample size by simulation</a>
<ul>
<li class="chapter" data-level="C.1" data-path="cp3sim.html"><a href="cp3sim.html#power-simulation-for-a-t-test"><i class="fa fa-check"></i><b>C.1</b> Power simulation for a t-test</a></li>
<li class="chapter" data-level="C.2" data-path="cp3sim.html"><a href="cp3sim.html#power-simulation-for-ancova"><i class="fa fa-check"></i><b>C.2</b> Power simulation for ANCOVA</a></li>
<li class="chapter" data-level="C.3" data-path="cp3sim.html"><a href="cp3sim.html#conclusion"><i class="fa fa-check"></i><b>C.3</b> Conclusion</a></li>
</ul></li>
<li class="chapter" data-level="D" data-path="computer-practical-4---analysis-for-binary-and-survival-data.html"><a href="computer-practical-4---analysis-for-binary-and-survival-data.html"><i class="fa fa-check"></i><b>D</b> Computer practical 4 - Analysis for Binary and Survival data</a>
<ul>
<li class="chapter" data-level="D.1" data-path="computer-practical-4---analysis-for-binary-and-survival-data.html"><a href="computer-practical-4---analysis-for-binary-and-survival-data.html#binary-outcome-data"><i class="fa fa-check"></i><b>D.1</b> Binary outcome data</a>
<ul>
<li class="chapter" data-level="D.1.1" data-path="computer-practical-4---analysis-for-binary-and-survival-data.html"><a href="computer-practical-4---analysis-for-binary-and-survival-data.html#confidence-intervals"><i class="fa fa-check"></i><b>D.1.1</b> Confidence Intervals</a></li>
<li class="chapter" data-level="D.1.2" data-path="computer-practical-4---analysis-for-binary-and-survival-data.html"><a href="computer-practical-4---analysis-for-binary-and-survival-data.html#cp2logreg"><i class="fa fa-check"></i><b>D.1.2</b> Logistic regression</a></li>
</ul></li>
<li class="chapter" data-level="D.2" data-path="computer-practical-4---analysis-for-binary-and-survival-data.html"><a href="computer-practical-4---analysis-for-binary-and-survival-data.html#cp2-surv"><i class="fa fa-check"></i><b>D.2</b> Analysis for Survival data</a>
<ul>
<li class="chapter" data-level="D.2.1" data-path="computer-practical-4---analysis-for-binary-and-survival-data.html"><a href="computer-practical-4---analysis-for-binary-and-survival-data.html#fitting-a-survival-curve"><i class="fa fa-check"></i><b>D.2.1</b> Fitting a survival curve</a></li>
<li class="chapter" data-level="D.2.2" data-path="computer-practical-4---analysis-for-binary-and-survival-data.html"><a href="computer-practical-4---analysis-for-binary-and-survival-data.html#comparing-survival-curves-1"><i class="fa fa-check"></i><b>D.2.2</b> Comparing survival curves</a></li>
</ul></li>
<li class="chapter" data-level="D.3" data-path="computer-practical-4---analysis-for-binary-and-survival-data.html"><a href="computer-practical-4---analysis-for-binary-and-survival-data.html#cp2sim2"><i class="fa fa-check"></i><b>D.3</b> Extension problem: Sample size by simulation (part II)</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Clinical Trials 4H</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="computer-practical-1---missing-data" class="section level1 hasAnchor" number="9">
<h1><span class="header-section-number">A</span> Computer Practical 1 - Missing data<a href="computer-practical-1---missing-data.html#computer-practical-1---missing-data" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>In this computer practical we focus on an important issue in clinical trials (and most real world projects!): <strong>missing data</strong>. There will be a bit more reading than in future practicals, to give you the necessary theory and background. We will only have time to skim the surface of working with missing data, but if you want to find out more, some good references are <span class="citation">Little and Rubin (<a href="#ref-little2019statistical">2019</a>)</span> and chapter 17 of <span class="citation">Gelman, Hill, and Vehtari (<a href="#ref-gelman2021regression">2021</a>)</span>.</p>
<p>Consider it a sort of informal formative assignment to finish this practical in your own time if you don’t in class. Or, at the very least, you might need to return to it while working on future assignments. <strong>For this reason, it would be sensible to keep track of everything you do in an .R file that you can return to in the future</strong>.</p>
<p>There will be a mixture of full solutions, examples of possible solutions and example code to adapt. If you’re not sure how to do something, please ask!</p>
<!-- **In the example code, I have used the same names for most objects. In order to store your results and avoid confusion, it will be sensible to name things intelligently! For example, suffix each allocation data frame so that you know which allocation method you used. Create an R file with the commands in that you use, so that you can easily replicate your work.** -->
<div id="r-practicalities" class="section level3 unnumbered hasAnchor">
<h3>R practicalities<a href="computer-practical-1---missing-data.html#r-practicalities" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>There are many, many packages in R that implement methods for designing and analysing clinical trials (see a list at <a href="https://cran.r-project.org/web/views/ClinicalTrials.html">CRAN task view</a>). We will look at some of these, and will also write our own code for some tasks. Remember that to install a package, you can do</p>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="computer-practical-1---missing-data.html#cb88-1" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&quot;&lt;packagename&gt;&quot;</span>)</span></code></pre></div>
<p>and to then load the package (it doesn’t load automatically on install) enter</p>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="computer-practical-1---missing-data.html#cb89-1" tabindex="-1"></a><span class="fu">library</span>(<span class="sc">&lt;</span>packagename<span class="sc">&gt;</span>)</span></code></pre></div>
<p>If you have problems running R on your laptop, or on the university machines, the most foolproof way might be to use Github codespaces (thanks to Louis Aslett, who developed this for Data Science and Statistical Computing II). You may be familiar with this approach if you did Bayesian Computational Modelling III.</p>
<p>An advantage of this is that you can open the same codespace (the same instance of R) from any computer, so if you plan to work on things (for example your summative assignment, which will involve some R) from more than one computer, this might be ideal.</p>
<p>Codespace requires you to have a github account (you can sign up for free <a href="https://github.com/">here</a>) and there is a short guide to creating a github account <a href="https://eur01.safelinks.protection.outlook.com/?url=https%3A%2F%2Fwww.louisaslett.com%2FCourses%2FDSSC%2Fnotes%2Fgithub.html&amp;data=05%7C02%7Cr.h.oughton%40durham.ac.uk%7Ccd09b90284364f8558ba08dc1ccf06f8%7C7250d88b4b684529be44d59a2d8a6f94%7C0%7C0%7C638416922691502641%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&amp;sdata=f5gJFI3CJPOQ1P16l%2FIdhtIAgQul7s5BhIPwi4GAyLk%3D&amp;reserved=0">here</a>.</p>
<p><a href="https://eur01.safelinks.protection.outlook.com/?url=https%3A%2F%2Fcodespaces.new%2Flouisaslett%2Fdssc%3Fquickstart%3D1&amp;data=05%7C02%7Cr.h.oughton%40durham.ac.uk%7Ccd09b90284364f8558ba08dc1ccf06f8%7C7250d88b4b684529be44d59a2d8a6f94%7C0%7C0%7C638416922691485947%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&amp;sdata=Lsw6mz0L5G%2FvZoZN29D2FgOyOkPMNboJgXPJt7BMPk8%3D&amp;reserved=0">Direct link to codespace</a></p>
<p><a href="https://eur01.safelinks.protection.outlook.com/?url=https%3A%2F%2Fwww.louisaslett.com%2FCourses%2FDSSC%2Fnotes%2Finstallr.html%23codespaces&amp;data=05%7C02%7Cr.h.oughton%40durham.ac.uk%7Ccd09b90284364f8558ba08dc1ccf06f8%7C7250d88b4b684529be44d59a2d8a6f94%7C0%7C0%7C638416922691495230%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&amp;sdata=hNtp7fT0qZWiQXRwEOUXbMvPWxy1jMtsCd9J7nXlAug%3D&amp;reserved=0">Instructions for how to use codespace</a></p>
</div>
<div id="missing-data" class="section level2 hasAnchor" number="9.1">
<h2><span class="header-section-number">A.1</span> Missing data<a href="computer-practical-1---missing-data.html#missing-data" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In [almost] any real-world study or trial, there will be some missing data. This can happen for a whole host of reasons: perhaps some participants dropped out completely, or couldn’t make some appointments. Perhaps some data were lost or corrupted. Perhaps some participants decided not to provide certain details, or didn’t comply properly with the study.</p>
<p>Why does this matter? Or, why do we need to think properly about this? Well, a huge amount of work in the planning and design of an RCT goes into the random allocation: we want to eliminate all sources of bias (including those we can’t observe, or aren’t even aware of) by randomly balancing the participants between the trial arms. If some of these participants’ data are missing, we can no longer be confident that we still have this balance.</p>
<p>Dealing with missing data boils down to two main tasks:</p>
<ul>
<li>Understanding the pattern(s) of missingness</li>
<li>Processing the data to mitigate against the effect of the missingness</li>
</ul>
<p>so this is what we’ll be working on now. Before that though, we need some data to work with!</p>
<div id="datasets" class="section level3 hasAnchor" number="9.1.1">
<h3><span class="header-section-number">A.1.1</span> Datasets<a href="computer-practical-1---missing-data.html#datasets" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The datasets we’ll work with come from the packages <code>medicaldata</code> and <code>smdi</code>, so you’ll need to install those if you don’t have them. We’ll also be using the packages <code>naniar</code> and <code>visdat</code>, which contain lots of methods for handling missing data, and <code>rstanarm</code>, which will enable us to easily sample from regression models. Other packages are available, as you can see from <a href="https://cran.r-project.org/web/views/MissingData.html">the CRAN task view on Missing Data</a>. We’ll also use <code>tidyverse</code> for various plotting and data handling tasks.</p>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="computer-practical-1---missing-data.html#cb90-1" tabindex="-1"></a><span class="fu">require</span>(medicaldata)</span>
<span id="cb90-2"><a href="computer-practical-1---missing-data.html#cb90-2" tabindex="-1"></a><span class="fu">library</span>(naniar)</span>
<span id="cb90-3"><a href="computer-practical-1---missing-data.html#cb90-3" tabindex="-1"></a><span class="fu">library</span>(smdi)</span>
<span id="cb90-4"><a href="computer-practical-1---missing-data.html#cb90-4" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb90-5"><a href="computer-practical-1---missing-data.html#cb90-5" tabindex="-1"></a><span class="fu">library</span>(visdat)</span>
<span id="cb90-6"><a href="computer-practical-1---missing-data.html#cb90-6" tabindex="-1"></a><span class="fu">library</span>(rstanarm)</span></code></pre></div>
<p>Throughout this practical we’ll work with three datasets.</p>
<div id="supraclavicular" class="section level4 hasAnchor" number="9.1.1.1">
<h4><span class="header-section-number">A.1.1.1</span> Supraclavicular<a href="computer-practical-1---missing-data.html#supraclavicular" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The first dataset is the <code>supraclavicular</code> data. This is a fairly simple data set (at least in terms of missingness) which I’ll use to to demonstrate techniques before asking you to work on the more complex data!</p>
<div class="exercise">
<p><span id="exr:unlabeled-div-50" class="exercise"><strong>Exercise A.1  </strong></span>Load the <code>supraclavicular</code> data.
- What is the study about?
- What is the primary outcome?
- What are the baseline covariates (remember these must be measured <strong>before</strong> allocation)
Create a data frame containing just the baseline covariates, the allocation and the primary outcome variable. Make sure these are of the correct type.</p>
</div>
<details>
<summary>
Click for solution
</summary>
<div class="solution">
<p><span id="unlabeled-div-51" class="solution"><em>Solution</em>. </span>The details of the study can be found using <code>?supraclavicular</code>.</p>
<p>The primary outcome variable is time to 4-nerve sensory block, which has the column name <code>onset_sensory</code>.</p>
<p>The baseline covariates are gender, BMI and age. To create our data frame, we need</p>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="computer-practical-1---missing-data.html#cb91-1" tabindex="-1"></a>sup_df <span class="ot">=</span> supraclavicular[ ,<span class="fu">c</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>, <span class="dv">9</span>)]</span>
<span id="cb91-2"><a href="computer-practical-1---missing-data.html#cb91-2" tabindex="-1"></a>sup_df <span class="ot">=</span> sup_df<span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">c</span>(group, gender), factor))</span></code></pre></div>
</div>
</details>
</div>
<div id="lung-cancer-dataset" class="section level4 hasAnchor" number="9.1.1.2">
<h4><span class="header-section-number">A.1.1.2</span> Lung cancer dataset<a href="computer-practical-1---missing-data.html#lung-cancer-dataset" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>This is the <code>smdi_data</code> dataset from the package <code>smdi</code>. The intervention group variable is <code>exposure</code>. The outcome data are survival (or ‘time-to-event’) data: in this study, the ‘event’ is death and the follow-up period is five (probably years, but it doesn’t say!). Some participants are still alive at the end of the follow-up period (so they have <code>status=0</code>) and the data are therefore <em>right censored</em>. We will learn more about this type of data later in the course.</p>
<p>For now, the only preparation to do is to convert <code>status</code> to a factor variable:</p>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb92-1"><a href="computer-practical-1---missing-data.html#cb92-1" tabindex="-1"></a>smdi_data<span class="sc">$</span>status <span class="ot">=</span> <span class="fu">factor</span>(smdi_data<span class="sc">$</span>status)</span></code></pre></div>
<p>This is a synthetic (or possibly synthetically altered) dataset designed for use with missing data exploration, so we have the advantage that the help file tells about the missingness mechanisms (more on that soon).</p>
</div>
<div id="obstetrics-and-periodontal-therapy" class="section level4 hasAnchor" number="9.1.1.3">
<h4><span class="header-section-number">A.1.1.3</span> Obstetrics and Periodontal Therapy<a href="computer-practical-1---missing-data.html#obstetrics-and-periodontal-therapy" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The final dataset we’ll work with is <code>opt</code>, which is about the treatment of maternal periodontal disease and its effect on birthweight and term.</p>
<div class="exercise">
<p><span id="exr:unlabeled-div-52" class="exercise"><strong>Exercise A.2  </strong></span>Use <code>?opt</code> to find out about this trial.</p>
</div>
<p>There are a lot of columns here, but we won’t keep all of them. Our dataset (for now) will be</p>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="computer-practical-1---missing-data.html#cb93-1" tabindex="-1"></a>opt_df <span class="ot">=</span> opt[ ,<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>, <span class="dv">10</span><span class="sc">:</span><span class="dv">22</span>, <span class="dv">72</span>)]</span></code></pre></div>
<p>which retains most of the baseline covariates, intervention group and outcome variable (birthweight). There is some ‘messiness’ in the data, for example for some variables missing values are recorded as <code>""</code>, rather than <code>NA</code>. We’ll sort that now by running the following command</p>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="computer-practical-1---missing-data.html#cb94-1" tabindex="-1"></a>opt_df <span class="ot">=</span> opt_df <span class="sc">%&gt;%</span> </span>
<span id="cb94-2"><a href="computer-practical-1---missing-data.html#cb94-2" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">c</span>(Use.Tob, Use.Alc, Drug.Add), </span>
<span id="cb94-3"><a href="computer-practical-1---missing-data.html#cb94-3" tabindex="-1"></a>                gsub, <span class="at">pattern =</span> <span class="st">&quot;^ +$&quot;</span>, <span class="at">replacement =</span> <span class="cn">NA</span>))<span class="sc">%&gt;%</span></span>
<span id="cb94-4"><a href="computer-practical-1---missing-data.html#cb94-4" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">c</span>(Use.Tob, Use.Alc, Drug.Add), factor))</span></code></pre></div>
</div>
</div>
</div>
<div id="understanding-the-patterns-of-missingness" class="section level2 hasAnchor" number="9.2">
<h2><span class="header-section-number">A.2</span> Understanding the patterns of missingness<a href="computer-practical-1---missing-data.html#understanding-the-patterns-of-missingness" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The first thing we’ll do is explore the data to find out what the pattern of missingness is. First of all, we can visualise which data are missing.</p>
<div id="visualising-missingness" class="section level3 hasAnchor" number="9.2.1">
<h3><span class="header-section-number">A.2.1</span> Visualising missingness<a href="computer-practical-1---missing-data.html#visualising-missingness" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="technique">
<p>The function <code>vis_dat</code> (from <code>visdat</code>) gives an excellent first look at a dataset, colouring data by type (and missing data in grey). The default is to sort the columns by type, but you can see below that I’ve made it keep to the origianl order.</p>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb95-1"><a href="computer-practical-1---missing-data.html#cb95-1" tabindex="-1"></a><span class="fu">vis_dat</span>(sup_df, <span class="at">sort_type=</span>F)</span></code></pre></div>
<p><img src="CT4H_notes_files/figure-html/unnamed-chunk-133-1.png" width="672" /></p>
<p>The functions <code>gg_miss_var</code>, <code>gg_miss_case</code> and <code>gg_miss_upset</code> (all from <code>naniar</code>) allow us to quickly see how much missing data there is, either by variable, by case or by intersection. Look at the help files to find out what the arguments do.
We see that in <code>supraclavicular</code> there are three missing entries for BMI, and all other variables are complete.</p>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="computer-practical-1---missing-data.html#cb96-1" tabindex="-1"></a><span class="fu">gg_miss_var</span>(sup_df)</span></code></pre></div>
<p><img src="CT4H_notes_files/figure-html/unnamed-chunk-134-1.png" width="672" /></p>
<p>Plotting by cases shows that each of these missing data are associated with a different participant, so there are three participants with one missing item each.</p>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="computer-practical-1---missing-data.html#cb97-1" tabindex="-1"></a><span class="fu">gg_miss_case</span>(sup_df)</span></code></pre></div>
<p><img src="CT4H_notes_files/figure-html/unnamed-chunk-135-1.png" width="672" /></p>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="computer-practical-1---missing-data.html#cb98-1" tabindex="-1"></a><span class="fu">md.pattern</span>(sup_df)</span></code></pre></div>
<p><img src="CT4H_notes_files/figure-html/unnamed-chunk-135-2.png" width="672" /></p>
<pre><code>##     group gender age onset_sensory bmi  
## 100     1      1   1             1   1 0
## 3       1      1   1             1   0 1
##         0      0   0             0   3 3</code></pre>
</div>
<div class="exercise">
<p><span id="exr:unlabeled-div-53" class="exercise"><strong>Exercise A.3  </strong></span>Make these plots for the remaining datasets, <code>smdi_data</code> and <code>opt_df</code>. How does the missingness compare? Which plots do you find more useful and why?</p>
</div>
<details>
<summary>
Click for solution
</summary>
<div class="solution">
<p><span id="unlabeled-div-54" class="solution"><em>Solution</em>. </span><strong>Lung cancer</strong></p>
<p>We see there is missingness for three variables:</p>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="computer-practical-1---missing-data.html#cb100-1" tabindex="-1"></a><span class="fu">vis_dat</span>(smdi_data)</span></code></pre></div>
<p><img src="CT4H_notes_files/figure-html/unnamed-chunk-136-1.png" width="672" /></p>
<p>The <code>naniar</code> functions can show us how this is spread across the variables and participants.</p>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="computer-practical-1---missing-data.html#cb101-1" tabindex="-1"></a><span class="fu">gg_miss_var</span>(smdi_data, <span class="at">show_pct=</span>T)</span></code></pre></div>
<p><img src="CT4H_notes_files/figure-html/unnamed-chunk-137-1.png" width="672" /></p>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb102-1"><a href="computer-practical-1---missing-data.html#cb102-1" tabindex="-1"></a><span class="fu">gg_miss_case</span>(smdi_data, <span class="at">order_cases =</span> T)</span></code></pre></div>
<p><img src="CT4H_notes_files/figure-html/unnamed-chunk-137-2.png" width="672" /></p>
<p>The function <code>md.pattern</code> shows us how many participants have each combination of missing data:</p>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb103-1"><a href="computer-practical-1---missing-data.html#cb103-1" tabindex="-1"></a><span class="fu">md.pattern</span>(smdi_data, <span class="at">rotate.names =</span> T)</span></code></pre></div>
<p><img src="CT4H_notes_files/figure-html/unnamed-chunk-138-1.png" width="672" /></p>
<pre><code>##     exposure age_num female_cat smoking_cat physical_cat alk_cat histology_cat ses_cat
## 795        1       1          1           1            1       1             1       1
## 479        1       1          1           1            1       1             1       1
## 446        1       1          1           1            1       1             1       1
## 263        1       1          1           1            1       1             1       1
## 151        1       1          1           1            1       1             1       1
## 176        1       1          1           1            1       1             1       1
## 93         1       1          1           1            1       1             1       1
## 97         1       1          1           1            1       1             1       1
##            0       0          0           0            0       0             0       0
##     copd_cat eventtime status pdl1_num ecog_cat egfr_cat     
## 795        1         1      1        1        1        1    0
## 479        1         1      1        1        1        0    1
## 446        1         1      1        1        0        1    1
## 263        1         1      1        1        0        0    2
## 151        1         1      1        0        1        1    1
## 176        1         1      1        0        1        0    2
## 93         1         1      1        0        0        1    2
## 97         1         1      1        0        0        0    3
##            0         0      0      517      899     1015 2431</code></pre>
<p><strong>Obstetrics and Periodontal Therapy</strong>
Using <code>vis_dat</code> we see that there is a lot of missing data in the <code>opt</code> dataset, and that some variables are particularly badly affected.</p>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb105-1"><a href="computer-practical-1---missing-data.html#cb105-1" tabindex="-1"></a><span class="fu">vis_dat</span>(opt_df)</span></code></pre></div>
<p><img src="CT4H_notes_files/figure-html/unnamed-chunk-139-1.png" width="672" /></p>
<p>Now the <code>naniar</code> functions really do help us to understand what we’re dealing with!</p>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb106-1"><a href="computer-practical-1---missing-data.html#cb106-1" tabindex="-1"></a><span class="fu">gg_miss_var</span>(opt_df, <span class="at">show_pct=</span>T)</span></code></pre></div>
<p><img src="CT4H_notes_files/figure-html/unnamed-chunk-140-1.png" width="672" /></p>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb107-1"><a href="computer-practical-1---missing-data.html#cb107-1" tabindex="-1"></a><span class="fu">gg_miss_case</span>(opt_df, <span class="at">order_cases =</span> T, <span class="at">show_pct=</span>T)</span></code></pre></div>
<p><img src="CT4H_notes_files/figure-html/unnamed-chunk-140-2.png" width="672" /></p>
<p>Not many individual participants have more than about 25% of their data missing, but there are some variables that are missing for nearly all participants (more on this later).</p>
</div>
</details>
</div>
<div id="summary-tables" class="section level3 hasAnchor" number="9.2.2">
<h3><span class="header-section-number">A.2.2</span> Summary tables<a href="computer-practical-1---missing-data.html#summary-tables" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We may also want to visualise or summarise missingness in a table, and there are various ways to do this, for example <code>miss_case_summary</code>, <code>miss_var_summary</code> and <code>miss_var_summary</code>.</p>
<div class="exercise">
<p><span id="exr:unlabeled-div-55" class="exercise"><strong>Exercise A.4  </strong></span>Use the three table generating functions listed above on our datasets. Do they give you any new information compared to the plots?</p>
</div>
<details>
<summary>
Click for solution
</summary>
<div class="solution">
<p><span id="unlabeled-div-56" class="solution"><em>Solution</em>. </span>Working through the list of functions (just for <code>opt_df</code>), we have:</p>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb108-1"><a href="computer-practical-1---missing-data.html#cb108-1" tabindex="-1"></a><span class="fu">miss_case_summary</span>(opt_df)</span></code></pre></div>
<pre><code>## # A tibble: 823 × 3
##     case n_miss pct_miss
##    &lt;int&gt;  &lt;int&gt;    &lt;dbl&gt;
##  1   423      9     50  
##  2    80      8     44.4
##  3    93      8     44.4
##  4   477      8     44.4
##  5   539      8     44.4
##  6    11      7     38.9
##  7    21      7     38.9
##  8    43      7     38.9
##  9    54      7     38.9
## 10   150      7     38.9
## # ℹ 813 more rows</code></pre>
<p>This shows how many variables (both in number and as a percentage of the total number of variables) are missing, for each case (in decreasing order of missingness).</p>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb110-1"><a href="computer-practical-1---missing-data.html#cb110-1" tabindex="-1"></a><span class="fu">miss_case_table</span>(opt_df)</span></code></pre></div>
<pre><code>## # A tibble: 9 × 3
##   n_miss_in_case n_cases pct_cases
##            &lt;int&gt;   &lt;int&gt;     &lt;dbl&gt;
## 1              1       7     0.851
## 2              2      87    10.6  
## 3              3     462    56.1  
## 4              4     224    27.2  
## 5              5      17     2.07 
## 6              6      12     1.46 
## 7              7       9     1.09 
## 8              8       4     0.486
## 9              9       1     0.122</code></pre>
<p><code>miss_case_table</code> tabulates the number of cases with <span class="math inline">\(n\)</span> missing variables, for <span class="math inline">\(n=1,\ldots\)</span>.</p>
<p>The remaining functions look at things from the point of view of variables:</p>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb112-1"><a href="computer-practical-1---missing-data.html#cb112-1" tabindex="-1"></a><span class="fu">miss_var_summary</span>(opt_df)</span></code></pre></div>
<pre><code>## # A tibble: 18 × 3
##    variable      n_miss pct_miss
##    &lt;chr&gt;          &lt;int&gt;    &lt;num&gt;
##  1 BL.Drks.Day      810    98.4 
##  2 BL.Diab.Type     799    97.1 
##  3 BL.Cig.Day       731    88.8 
##  4 N.prev.preg      217    26.4 
##  5 BMI               73     8.87
##  6 Use.Alc           27     3.28
##  7 Drug.Add          27     3.28
##  8 Use.Tob           26     3.16
##  9 Birthweight       14     1.70
## 10 PID                0     0   
## 11 Clinic             0     0   
## 12 Group              0     0   
## 13 Age                0     0   
## 14 Education          0     0   
## 15 Public.Asstce      0     0   
## 16 Hypertension       0     0   
## 17 Diabetes           0     0   
## 18 Prev.preg          0     0</code></pre>
<p>Now we see how many (and what percentage) of cases are missing for each variable.</p>
</div>
</details>
<p>There are many, many possible ways to visualise or tabulate missing data, and we have used but a few. If you want to find more, you can look in the help file for <code>naniar</code>, or indeed at another package designed for working with missing data.</p>
</div>
<div id="mechanisms-of-missingness" class="section level3 hasAnchor" number="9.2.3">
<h3><span class="header-section-number">A.2.3</span> Mechanisms of missingness<a href="computer-practical-1---missing-data.html#mechanisms-of-missingness" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>So far, things have been a bit ad-hoc. We may have noticed some patterns or trends, but we haven’t subjected these to any scrutiny, or used any statistical methodology to understand the missingness.</p>
<p>When working with missing data, it’s important to think about the <em>mechanism</em> that is causing some data to be missing. Is there some systematic reason why some variables are missing?</p>
<p>Broadly speaking, there are three types of missing data. These were first coined by <span class="citation">Rubin (<a href="#ref-rubin1976inference">1976</a>)</span>.</p>
<div id="missing-completely-at-random-mcar" class="section level4 hasAnchor" number="9.2.3.1">
<h4><span class="header-section-number">A.2.3.1</span> Missing completely at random (MCAR)<a href="computer-practical-1---missing-data.html#missing-completely-at-random-mcar" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>If data are MCAR, then the probability of missingness is the same for all units: missingness is statistically independent of all covariates (observed and unobserved), of the treatment and of the outcome. If each participant decided whether or not to provide a certain piece of information by rolling a dice (eg. 1 = don’t provide), then the resulting missingness would be MCAR.</p>
<p>This type of missingness is the simplest to deal with, because removing the missing units is unlikely to cause any bias. However, it’s extremely rare in real life, and it’s difficult to even think of an example where it would definitely hold!</p>
</div>
<div id="missing-at-random-mar" class="section level4 hasAnchor" number="9.2.3.2">
<h4><span class="header-section-number">A.2.3.2</span> Missing at random (MAR)<a href="computer-practical-1---missing-data.html#missing-at-random-mar" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>For data to be MAR, the probability of missingness must depend only on <strong>available</strong> information. In this case, we can use the available information to model the missingness.</p>
<p>MAR data are somewhat more common (or at least the mechanism is more commonly assumed than MCAR), and is thankfully still moderately simple to deal with. If missingness is ‘at random’, then adjusting for the relevant covariates in the analysis will avoid bias.</p>
</div>
<div id="missing-not-at-random-mnar" class="section level4 hasAnchor" number="9.2.3.3">
<h4><span class="header-section-number">A.2.3.3</span> Missing not at random (MNAR)<a href="computer-practical-1---missing-data.html#missing-not-at-random-mnar" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>This is the trickiest (and probably most common) mechanism, in which the missingness depends on <strong>unobserved</strong> data. It is likely then that the unobserved (and therefore unavailable) information also predicts the value that is missing, and possibly also the outcome.</p>
<p>For example, suppose that the treatment in a clinical trial causes some unwanted side effect, such as pain. In this case, a participant in the intervention group is more likely to drop out of the study than a participant in the control group. Unless we measure this side effect (for example, a pain score), the resulting missingness is not at random.</p>
<p>The most difficult case of MNAR is when the missingness depends on the (potentially missing) variable itself. For example, in a trial of a weight loss intervention, participants with greater weights might be more reticent to reveal them, especially if they feel the trial is going badly.</p>
<p>MNAR mechanisms can be [imperfectly] modelled, or else mitigated by including more covariates in the data, which brings the mechanism closer to MAR. It is vital to work with the subject experts, who will have a much better idea of the sorts of mechanisms that might be causing missingness in their study.</p>
<p>We can never <strong>prove</strong> which of these is the case, since by definition we don’t have the information we would need to establish that the mechanism is (or isn’t) MNAR. All we can do is study patterns in the data and find evidence one way or the other.</p>
</div>
</div>
</div>
<div id="exploring-the-relationship-between-missingness-and-other-variables" class="section level2 hasAnchor" number="9.3">
<h2><span class="header-section-number">A.3</span> Exploring the relationship between missingness and other variables<a href="computer-practical-1---missing-data.html#exploring-the-relationship-between-missingness-and-other-variables" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In a clinical trial, ultimately what we care about is whether the missingness has changed our understanding of the outcome variable(s). This is most likely to happen if the missingness is related to the outcome variable. This could happen either directly, or because the missingness is correlated to a variable that affects the outcome.</p>
<p>Again, we will explore things visually before using some more rigorous methods. Now, instead of simply understanding how much missing data there is, and which variables and/or cases are involved, we want to look at the relationships between missingness and the values of the other variables.</p>
<div class="technique">
<p>In the package <code>naniar</code> you can create a copy of the data frame containing just <code>NA</code> and <code>!NA</code>, indexing exactly where the missing values are.</p>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb114-1"><a href="computer-practical-1---missing-data.html#cb114-1" tabindex="-1"></a><span class="fu">as_shadow</span>(sup_df)</span></code></pre></div>
<div style="border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:200px; overflow-x: scroll; width:100%; ">
<table class=" lightable-paper" style="font-family: &quot;Arial Narrow&quot;, arial, helvetica, sans-serif; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
group_NA
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
gender_NA
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
bmi_NA
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
age_NA
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
onset_sensory_NA
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
</tr>
<tr>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
</tr>
<tr>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
</tr>
<tr>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
</tr>
<tr>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
</tr>
<tr>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
</tr>
<tr>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
</tr>
<tr>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
</tr>
<tr>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
</tr>
<tr>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
</tr>
<tr>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
</tr>
<tr>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
</tr>
<tr>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
</tr>
<tr>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
</tr>
<tr>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
</tr>
<tr>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
</tr>
<tr>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
</tr>
<tr>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
</tr>
<tr>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
</tr>
<tr>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
</tr>
<tr>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
</tr>
<tr>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
</tr>
<tr>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
</tr>
<tr>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
</tr>
<tr>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
</tr>
<tr>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
</tr>
<tr>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
</tr>
<tr>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
</tr>
<tr>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
</tr>
<tr>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
</tr>
<tr>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
</tr>
<tr>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
</tr>
<tr>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
</tr>
<tr>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
</tr>
<tr>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
</tr>
<tr>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
</tr>
<tr>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
</tr>
<tr>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
</tr>
<tr>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
</tr>
<tr>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
</tr>
<tr>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
</tr>
<tr>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
</tr>
<tr>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
</tr>
<tr>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
</tr>
<tr>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
</tr>
<tr>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
</tr>
<tr>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
</tr>
<tr>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
</tr>
<tr>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
</tr>
<tr>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
</tr>
<tr>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
</tr>
<tr>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
</tr>
<tr>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
</tr>
<tr>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
</tr>
<tr>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
</tr>
<tr>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
</tr>
<tr>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
</tr>
<tr>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
</tr>
<tr>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
</tr>
<tr>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
</tr>
<tr>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
</tr>
<tr>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
</tr>
<tr>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
</tr>
<tr>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
</tr>
<tr>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
</tr>
<tr>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
</tr>
<tr>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
</tr>
<tr>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
</tr>
<tr>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
</tr>
<tr>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
</tr>
<tr>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
</tr>
<tr>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
</tr>
<tr>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
</tr>
<tr>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
</tr>
<tr>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
</tr>
<tr>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
</tr>
<tr>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
</tr>
<tr>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
</tr>
<tr>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
</tr>
<tr>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
</tr>
<tr>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
</tr>
<tr>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
</tr>
<tr>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
</tr>
<tr>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
</tr>
<tr>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
</tr>
<tr>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
</tr>
<tr>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
</tr>
<tr>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
</tr>
<tr>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
</tr>
<tr>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
</tr>
<tr>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
</tr>
<tr>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
</tr>
<tr>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
</tr>
<tr>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
</tr>
<tr>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
</tr>
<tr>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
</tr>
<tr>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
</tr>
<tr>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
</tr>
<tr>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
</tr>
<tr>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
</tr>
<tr>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
</tr>
<tr>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
</tr>
<tr>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
</tr>
</tbody>
</table>
</div>
<p>To avoid duplication of the original names, the column names are suffixed by ’_NA’. This means it can be appended to the original data frame to create what the authors of <code>naniar</code> call a <code>nabular</code> object.</p>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb115-1"><a href="computer-practical-1---missing-data.html#cb115-1" tabindex="-1"></a><span class="fu">nabular</span>(sup_df)</span></code></pre></div>
<div style="border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:200px; overflow-x: scroll; width:100%; ">
<table class=" lightable-paper" style="font-family: &quot;Arial Narrow&quot;, arial, helvetica, sans-serif; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
group
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
gender
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
bmi
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
age
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
onset_sensory
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
group_NA
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
gender_NA
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
bmi_NA
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
age_NA
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
onset_sensory_NA
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:right;">
41.15
</td>
<td style="text-align:right;">
52
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
</tr>
<tr>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:right;">
25.22
</td>
<td style="text-align:right;">
54
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
</tr>
<tr>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:right;">
34.14
</td>
<td style="text-align:right;">
46
</td>
<td style="text-align:right;">
24
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
</tr>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:right;">
41.57
</td>
<td style="text-align:right;">
54
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
</tr>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:right;">
27.17
</td>
<td style="text-align:right;">
41
</td>
<td style="text-align:right;">
30
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
</tr>
<tr>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:right;">
22.05
</td>
<td style="text-align:right;">
21
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
</tr>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:right;">
26.32
</td>
<td style="text-align:right;">
68
</td>
<td style="text-align:right;">
12
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
</tr>
<tr>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:right;">
24.69
</td>
<td style="text-align:right;">
61
</td>
<td style="text-align:right;">
13
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
</tr>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:right;">
35.63
</td>
<td style="text-align:right;">
44
</td>
<td style="text-align:right;">
27
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
</tr>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:right;">
35.12
</td>
<td style="text-align:right;">
28
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
</tr>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:right;">
36.11
</td>
<td style="text-align:right;">
36
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
</tr>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:right;">
28.34
</td>
<td style="text-align:right;">
60
</td>
<td style="text-align:right;">
21
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
</tr>
<tr>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:right;">
22.60
</td>
<td style="text-align:right;">
34
</td>
<td style="text-align:right;">
9
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
</tr>
<tr>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:right;">
30.14
</td>
<td style="text-align:right;">
64
</td>
<td style="text-align:right;">
9
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
</tr>
<tr>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:right;">
26.36
</td>
<td style="text-align:right;">
37
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
</tr>
<tr>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
51
</td>
<td style="text-align:right;">
50
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
</tr>
<tr>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:right;">
22.32
</td>
<td style="text-align:right;">
58
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
</tr>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:right;">
37.84
</td>
<td style="text-align:right;">
24
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
</tr>
<tr>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:right;">
39.85
</td>
<td style="text-align:right;">
28
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
</tr>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:right;">
31.21
</td>
<td style="text-align:right;">
50
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
</tr>
<tr>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:right;">
25.64
</td>
<td style="text-align:right;">
74
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
</tr>
<tr>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:right;">
21.26
</td>
<td style="text-align:right;">
52
</td>
<td style="text-align:right;">
41
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
</tr>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:right;">
24.22
</td>
<td style="text-align:right;">
53
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
</tr>
<tr>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:right;">
25.10
</td>
<td style="text-align:right;">
19
</td>
<td style="text-align:right;">
14
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
</tr>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:right;">
25.42
</td>
<td style="text-align:right;">
41
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
</tr>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:right;">
23.60
</td>
<td style="text-align:right;">
49
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
</tr>
<tr>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:right;">
28.20
</td>
<td style="text-align:right;">
46
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
</tr>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:right;">
28.33
</td>
<td style="text-align:right;">
57
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
</tr>
<tr>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:right;">
30.40
</td>
<td style="text-align:right;">
50
</td>
<td style="text-align:right;">
17
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
</tr>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:right;">
42.38
</td>
<td style="text-align:right;">
60
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
</tr>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:right;">
36.98
</td>
<td style="text-align:right;">
52
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
</tr>
<tr>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:right;">
30.67
</td>
<td style="text-align:right;">
39
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
</tr>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:right;">
23.43
</td>
<td style="text-align:right;">
53
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
</tr>
<tr>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:right;">
30.61
</td>
<td style="text-align:right;">
64
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
</tr>
<tr>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:right;">
23.62
</td>
<td style="text-align:right;">
51
</td>
<td style="text-align:right;">
20
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
</tr>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:right;">
30.17
</td>
<td style="text-align:right;">
47
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
</tr>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:right;">
18.80
</td>
<td style="text-align:right;">
66
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
</tr>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:right;">
24.52
</td>
<td style="text-align:right;">
59
</td>
<td style="text-align:right;">
33
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
</tr>
<tr>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:right;">
29.60
</td>
<td style="text-align:right;">
31
</td>
<td style="text-align:right;">
39
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
</tr>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:right;">
29.16
</td>
<td style="text-align:right;">
64
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
</tr>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:right;">
25.85
</td>
<td style="text-align:right;">
61
</td>
<td style="text-align:right;">
48
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
</tr>
<tr>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:right;">
25.84
</td>
<td style="text-align:right;">
50
</td>
<td style="text-align:right;">
9
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
</tr>
<tr>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:right;">
35.36
</td>
<td style="text-align:right;">
32
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
</tr>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:right;">
28.43
</td>
<td style="text-align:right;">
54
</td>
<td style="text-align:right;">
22
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
</tr>
<tr>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:right;">
35.25
</td>
<td style="text-align:right;">
53
</td>
<td style="text-align:right;">
27
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
</tr>
<tr>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:right;">
19.70
</td>
<td style="text-align:right;">
57
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
</tr>
<tr>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:right;">
27.50
</td>
<td style="text-align:right;">
56
</td>
<td style="text-align:right;">
37
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
</tr>
<tr>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:right;">
24.40
</td>
<td style="text-align:right;">
32
</td>
<td style="text-align:right;">
38
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
</tr>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:right;">
24.30
</td>
<td style="text-align:right;">
23
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
</tr>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:right;">
37.92
</td>
<td style="text-align:right;">
61
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
</tr>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:right;">
23.76
</td>
<td style="text-align:right;">
52
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
</tr>
<tr>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:right;">
22.12
</td>
<td style="text-align:right;">
18
</td>
<td style="text-align:right;">
19
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
</tr>
<tr>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:right;">
32.40
</td>
<td style="text-align:right;">
42
</td>
<td style="text-align:right;">
15
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
</tr>
<tr>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:right;">
20.49
</td>
<td style="text-align:right;">
44
</td>
<td style="text-align:right;">
23
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
</tr>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
22
</td>
<td style="text-align:right;">
16
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
</tr>
<tr>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:right;">
32.50
</td>
<td style="text-align:right;">
48
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
</tr>
<tr>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:right;">
36.72
</td>
<td style="text-align:right;">
52
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
</tr>
<tr>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:right;">
39.87
</td>
<td style="text-align:right;">
48
</td>
<td style="text-align:right;">
19
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
</tr>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:right;">
33.00
</td>
<td style="text-align:right;">
51
</td>
<td style="text-align:right;">
13
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
</tr>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:right;">
30.70
</td>
<td style="text-align:right;">
54
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
</tr>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:right;">
27.20
</td>
<td style="text-align:right;">
36
</td>
<td style="text-align:right;">
9
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
</tr>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:right;">
30.60
</td>
<td style="text-align:right;">
53
</td>
<td style="text-align:right;">
9
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
</tr>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:right;">
28.33
</td>
<td style="text-align:right;">
66
</td>
<td style="text-align:right;">
11
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
</tr>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:right;">
34.84
</td>
<td style="text-align:right;">
60
</td>
<td style="text-align:right;">
50
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
</tr>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
50
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
</tr>
<tr>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:right;">
29.00
</td>
<td style="text-align:right;">
53
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
</tr>
<tr>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:right;">
28.59
</td>
<td style="text-align:right;">
52
</td>
<td style="text-align:right;">
26
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
</tr>
<tr>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:right;">
38.19
</td>
<td style="text-align:right;">
36
</td>
<td style="text-align:right;">
18
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
</tr>
<tr>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:right;">
36.96
</td>
<td style="text-align:right;">
66
</td>
<td style="text-align:right;">
9
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
</tr>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:right;">
22.55
</td>
<td style="text-align:right;">
32
</td>
<td style="text-align:right;">
16
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
</tr>
<tr>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:right;">
35.15
</td>
<td style="text-align:right;">
57
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
</tr>
<tr>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:right;">
37.62
</td>
<td style="text-align:right;">
54
</td>
<td style="text-align:right;">
19
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
</tr>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:right;">
42.93
</td>
<td style="text-align:right;">
52
</td>
<td style="text-align:right;">
13
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
</tr>
<tr>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:right;">
20.98
</td>
<td style="text-align:right;">
31
</td>
<td style="text-align:right;">
9
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
</tr>
<tr>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:right;">
27.37
</td>
<td style="text-align:right;">
36
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
</tr>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:right;">
27.02
</td>
<td style="text-align:right;">
35
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
</tr>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:right;">
22.83
</td>
<td style="text-align:right;">
51
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
</tr>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:right;">
28.73
</td>
<td style="text-align:right;">
56
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
</tr>
<tr>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:right;">
29.49
</td>
<td style="text-align:right;">
62
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
</tr>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:right;">
34.08
</td>
<td style="text-align:right;">
32
</td>
<td style="text-align:right;">
18
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
</tr>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:right;">
25.59
</td>
<td style="text-align:right;">
57
</td>
<td style="text-align:right;">
15
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
</tr>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:right;">
34.17
</td>
<td style="text-align:right;">
59
</td>
<td style="text-align:right;">
12
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
</tr>
<tr>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:right;">
31.39
</td>
<td style="text-align:right;">
62
</td>
<td style="text-align:right;">
24
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
</tr>
<tr>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:right;">
21.26
</td>
<td style="text-align:right;">
25
</td>
<td style="text-align:right;">
50
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
</tr>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:right;">
24.20
</td>
<td style="text-align:right;">
29
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
</tr>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:right;">
32.28
</td>
<td style="text-align:right;">
65
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
</tr>
<tr>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:right;">
30.45
</td>
<td style="text-align:right;">
28
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
</tr>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:right;">
23.34
</td>
<td style="text-align:right;">
65
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
</tr>
<tr>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:right;">
24.54
</td>
<td style="text-align:right;">
46
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
</tr>
<tr>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:right;">
23.61
</td>
<td style="text-align:right;">
67
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
</tr>
<tr>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:right;">
43.46
</td>
<td style="text-align:right;">
55
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
</tr>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:right;">
19.91
</td>
<td style="text-align:right;">
59
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
</tr>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:right;">
24.45
</td>
<td style="text-align:right;">
38
</td>
<td style="text-align:right;">
20
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
</tr>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:right;">
27.78
</td>
<td style="text-align:right;">
60
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
</tr>
<tr>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:right;">
23.06
</td>
<td style="text-align:right;">
41
</td>
<td style="text-align:right;">
11
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
</tr>
<tr>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:right;">
32.79
</td>
<td style="text-align:right;">
68
</td>
<td style="text-align:right;">
14
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
</tr>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:right;">
24.96
</td>
<td style="text-align:right;">
66
</td>
<td style="text-align:right;">
12
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
</tr>
<tr>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:right;">
23.06
</td>
<td style="text-align:right;">
41
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
</tr>
<tr>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:right;">
24.40
</td>
<td style="text-align:right;">
19
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
</tr>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:right;">
22.24
</td>
<td style="text-align:right;">
31
</td>
<td style="text-align:right;">
9
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
</tr>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:right;">
33.91
</td>
<td style="text-align:right;">
40
</td>
<td style="text-align:right;">
11
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
</tr>
<tr>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:right;">
31.65
</td>
<td style="text-align:right;">
53
</td>
<td style="text-align:right;">
22
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
</tr>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:right;">
41.54
</td>
<td style="text-align:right;">
41
</td>
<td style="text-align:right;">
40
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
<td style="text-align:left;">
!NA
</td>
</tr>
</tbody>
</table>
</div>
<p>This is useful because we can investigate the values of the actual data while conditioning on the missingness. We can summarize the outcome distribution according to whether a variable is missing or observed:</p>
<div class="sourceCode" id="cb116"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb116-1"><a href="computer-practical-1---missing-data.html#cb116-1" tabindex="-1"></a>sup_nab <span class="sc">%&gt;%</span></span>
<span id="cb116-2"><a href="computer-practical-1---missing-data.html#cb116-2" tabindex="-1"></a>  <span class="fu">group_by</span>(bmi_NA) <span class="sc">%&gt;%</span></span>
<span id="cb116-3"><a href="computer-practical-1---missing-data.html#cb116-3" tabindex="-1"></a>  <span class="fu">summarise_at</span>(<span class="at">.vars =</span> <span class="st">&quot;onset_sensory&quot;</span>,</span>
<span id="cb116-4"><a href="computer-practical-1---missing-data.html#cb116-4" tabindex="-1"></a>               <span class="at">.funs =</span> <span class="fu">c</span>(<span class="st">&quot;mean&quot;</span>, <span class="st">&quot;sd&quot;</span>, <span class="st">&quot;var&quot;</span>, <span class="st">&quot;min&quot;</span>, <span class="st">&quot;max&quot;</span>),</span>
<span id="cb116-5"><a href="computer-practical-1---missing-data.html#cb116-5" tabindex="-1"></a>               <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>## # A tibble: 2 × 6
##   bmi_NA  mean    sd   var   min   max
##   &lt;fct&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
## 1 !NA       13  11.4  131.     0    50
## 2 NA        24  23.1  532      6    50</code></pre>
<p>and visualise the outcome distribution for missing and non-missing values of a covariate:</p>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb118-1"><a href="computer-practical-1---missing-data.html#cb118-1" tabindex="-1"></a><span class="fu">ggplot</span>(sup_nab,</span>
<span id="cb118-2"><a href="computer-practical-1---missing-data.html#cb118-2" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> onset_sensory,</span>
<span id="cb118-3"><a href="computer-practical-1---missing-data.html#cb118-3" tabindex="-1"></a>           <span class="at">fill =</span> bmi_NA)) <span class="sc">+</span> </span>
<span id="cb118-4"><a href="computer-practical-1---missing-data.html#cb118-4" tabindex="-1"></a>  <span class="fu">geom_histogram</span>()</span></code></pre></div>
<p><img src="CT4H_notes_files/figure-html/unnamed-chunk-149-1.png" width="672" /></p>
<p>We could also explore whether the missingness is related to the values of the other covariates, for example gender (in this data 0=female, 1=male)</p>
<div class="sourceCode" id="cb119"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb119-1"><a href="computer-practical-1---missing-data.html#cb119-1" tabindex="-1"></a><span class="fu">ggplot</span>(sup_nab,</span>
<span id="cb119-2"><a href="computer-practical-1---missing-data.html#cb119-2" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> gender,</span>
<span id="cb119-3"><a href="computer-practical-1---missing-data.html#cb119-3" tabindex="-1"></a>           <span class="at">fill =</span> bmi_NA)) <span class="sc">+</span> </span>
<span id="cb119-4"><a href="computer-practical-1---missing-data.html#cb119-4" tabindex="-1"></a>  <span class="fu">geom_bar</span>()</span></code></pre></div>
<p><img src="CT4H_notes_files/figure-html/unnamed-chunk-150-1.png" width="672" /></p>
<p>This isn’t a great example because there are only three missing BMI values, but you can probably guess what you’ll be doing next…</p>
</div>
<div class="exercise">
<p><span id="exr:unlabeled-div-57" class="exercise"><strong>Exercise A.5  </strong></span>For the lung cancer and obstetric periodontal treatment datasets, investigate whether / how the outcome distribution appears to be affected by the missing values.</p>
<ul>
<li>For the <code>smdi_data</code> dataset, remember that the outcome variable is the combination of <code>eventtime</code> and <code>status</code>. Can you think of a way to visualise the data that combines these pieces of information?</li>
<li>For <code>opt</code>, ignore the variables <code>BL.Diab.Type</code>, <code>BL.Cig.Day</code>, <code>BL.Cig.Day</code> and <code>N.prev.preg</code>. You can create a temporary <code>opt</code> data frame to work with</li>
</ul>
<div class="sourceCode" id="cb120"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb120-1"><a href="computer-practical-1---missing-data.html#cb120-1" tabindex="-1"></a>opt_tmp <span class="ot">=</span> opt_df[ ,<span class="sc">-</span><span class="fu">c</span>(<span class="dv">9</span>,<span class="dv">12</span>,<span class="dv">14</span>,<span class="dv">17</span>)]</span></code></pre></div>
<p><strong>There are many, many plots you could make here, but try not to spend too long on this - why not divide up tasks between you and your neighbours?</strong></p>
</div>
<details>
<summary>
Click for solution
</summary>
<div class="solution">
<p><span id="unlabeled-div-58" class="solution"><em>Solution</em>. </span>We’ll look here in some detail about the <strong>lung cancer</strong> dataset (<code>smdi_data</code>) - these aren’t really <em>solutions</em> as such, just some more detail of things you could do.</p>
<div class="sourceCode" id="cb121"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb121-1"><a href="computer-practical-1---missing-data.html#cb121-1" tabindex="-1"></a>smdi_nab <span class="ot">=</span> <span class="fu">nabular</span>(smdi_data)</span></code></pre></div>
<p>First by <code>ecog_cat</code>. Since there is a lot more missing data here, I’ve chosen to compare the distributions side-by-side using <code>facet_wrap</code>. This also allows me to colour by <code>status</code> (although it is sort of obvious from the large peak at <code>eventtime</code>=5 that those people are still alive). Setting <code>scales = "free_y"</code> makes it easier to compare the overall shape of the distribution. You may have found a different way to display the data that may be equally (or more!) informative - if so that’s fine!</p>
<div class="sourceCode" id="cb122"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb122-1"><a href="computer-practical-1---missing-data.html#cb122-1" tabindex="-1"></a>smdi_nab <span class="sc">%&gt;%</span></span>
<span id="cb122-2"><a href="computer-practical-1---missing-data.html#cb122-2" tabindex="-1"></a>  <span class="fu">group_by</span>(ecog_cat) <span class="sc">%&gt;%</span></span>
<span id="cb122-3"><a href="computer-practical-1---missing-data.html#cb122-3" tabindex="-1"></a>  <span class="fu">summarise_at</span>(<span class="at">.vars =</span> <span class="st">&quot;eventtime&quot;</span>,</span>
<span id="cb122-4"><a href="computer-practical-1---missing-data.html#cb122-4" tabindex="-1"></a>               <span class="at">.funs =</span> <span class="fu">c</span>(<span class="st">&quot;mean&quot;</span>, <span class="st">&quot;sd&quot;</span>, <span class="st">&quot;var&quot;</span>, <span class="st">&quot;min&quot;</span>, <span class="st">&quot;max&quot;</span>),</span>
<span id="cb122-5"><a href="computer-practical-1---missing-data.html#cb122-5" tabindex="-1"></a>               <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>## # A tibble: 3 × 6
##   ecog_cat  mean    sd   var       min   max
##   &lt;fct&gt;    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt; &lt;dbl&gt;
## 1 0         2.21  1.80  3.25 0.0000215     5
## 2 1         2.07  1.79  3.22 0.000754      5
## 3 &lt;NA&gt;      2.22  1.86  3.46 0.00248       5</code></pre>
<div class="sourceCode" id="cb124"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb124-1"><a href="computer-practical-1---missing-data.html#cb124-1" tabindex="-1"></a><span class="fu">ggplot</span>(smdi_nab,</span>
<span id="cb124-2"><a href="computer-practical-1---missing-data.html#cb124-2" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> eventtime,</span>
<span id="cb124-3"><a href="computer-practical-1---missing-data.html#cb124-3" tabindex="-1"></a>           <span class="at">fill =</span> status)) <span class="sc">+</span> </span>
<span id="cb124-4"><a href="computer-practical-1---missing-data.html#cb124-4" tabindex="-1"></a>  <span class="fu">geom_histogram</span>() <span class="sc">+</span> <span class="fu">facet_wrap</span>(<span class="sc">~</span>ecog_cat_NA, <span class="at">scales =</span> <span class="st">&quot;free_y&quot;</span>)</span></code></pre></div>
<p><img src="CT4H_notes_files/figure-html/unnamed-chunk-153-1.png" width="672" /></p>
<p>Next by <code>egfr_cat</code>:</p>
<div class="sourceCode" id="cb125"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb125-1"><a href="computer-practical-1---missing-data.html#cb125-1" tabindex="-1"></a>smdi_nab <span class="sc">%&gt;%</span></span>
<span id="cb125-2"><a href="computer-practical-1---missing-data.html#cb125-2" tabindex="-1"></a>  <span class="fu">group_by</span>(egfr_cat) <span class="sc">%&gt;%</span></span>
<span id="cb125-3"><a href="computer-practical-1---missing-data.html#cb125-3" tabindex="-1"></a>  <span class="fu">summarise_at</span>(<span class="at">.vars =</span> <span class="st">&quot;eventtime&quot;</span>,</span>
<span id="cb125-4"><a href="computer-practical-1---missing-data.html#cb125-4" tabindex="-1"></a>               <span class="at">.funs =</span> <span class="fu">c</span>(<span class="st">&quot;mean&quot;</span>, <span class="st">&quot;sd&quot;</span>, <span class="st">&quot;var&quot;</span>, <span class="st">&quot;min&quot;</span>, <span class="st">&quot;max&quot;</span>),</span>
<span id="cb125-5"><a href="computer-practical-1---missing-data.html#cb125-5" tabindex="-1"></a>               <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>## # A tibble: 3 × 6
##   egfr_cat  mean    sd   var       min   max
##   &lt;fct&gt;    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt; &lt;dbl&gt;
## 1 0         1.96  1.79  3.22 0.000754      5
## 2 1         2.94  1.91  3.66 0.0115        5
## 3 &lt;NA&gt;      2.15  1.76  3.10 0.0000215     5</code></pre>
<div class="sourceCode" id="cb127"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb127-1"><a href="computer-practical-1---missing-data.html#cb127-1" tabindex="-1"></a><span class="fu">ggplot</span>(smdi_nab,</span>
<span id="cb127-2"><a href="computer-practical-1---missing-data.html#cb127-2" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> eventtime,</span>
<span id="cb127-3"><a href="computer-practical-1---missing-data.html#cb127-3" tabindex="-1"></a>           <span class="at">fill =</span> status)) <span class="sc">+</span> </span>
<span id="cb127-4"><a href="computer-practical-1---missing-data.html#cb127-4" tabindex="-1"></a>  <span class="fu">geom_histogram</span>() <span class="sc">+</span> <span class="fu">facet_wrap</span>(<span class="sc">~</span>egfr_cat_NA, <span class="at">scales =</span> <span class="st">&quot;free_y&quot;</span>)</span></code></pre></div>
<p><img src="CT4H_notes_files/figure-html/unnamed-chunk-154-1.png" width="672" /></p>
<p>and finally by <code>pdl1_num</code>:</p>
<div class="sourceCode" id="cb128"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb128-1"><a href="computer-practical-1---missing-data.html#cb128-1" tabindex="-1"></a>smdi_nab <span class="sc">%&gt;%</span></span>
<span id="cb128-2"><a href="computer-practical-1---missing-data.html#cb128-2" tabindex="-1"></a>  <span class="fu">group_by</span>(pdl1_num) <span class="sc">%&gt;%</span></span>
<span id="cb128-3"><a href="computer-practical-1---missing-data.html#cb128-3" tabindex="-1"></a>  <span class="fu">summarise_at</span>(<span class="at">.vars =</span> <span class="st">&quot;eventtime&quot;</span>,</span>
<span id="cb128-4"><a href="computer-practical-1---missing-data.html#cb128-4" tabindex="-1"></a>               <span class="at">.funs =</span> <span class="fu">c</span>(<span class="st">&quot;mean&quot;</span>, <span class="st">&quot;sd&quot;</span>, <span class="st">&quot;var&quot;</span>, <span class="st">&quot;min&quot;</span>, <span class="st">&quot;max&quot;</span>),</span>
<span id="cb128-5"><a href="computer-practical-1---missing-data.html#cb128-5" tabindex="-1"></a>               <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>## # A tibble: 1,540 × 6
##    pdl1_num  mean    sd   var   min   max
##       &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
##  1     6.14 0.655    NA    NA 0.655 0.655
##  2    12.4  0.463    NA    NA 0.463 0.463
##  3    12.9  0.679    NA    NA 0.679 0.679
##  4    13.6  0.358    NA    NA 0.358 0.358
##  5    15.8  0.290    NA    NA 0.290 0.290
##  6    16.7  1.71     NA    NA 1.71  1.71 
##  7    17.4  0.245    NA    NA 0.245 0.245
##  8    17.8  1.52     NA    NA 1.52  1.52 
##  9    18.7  4.91     NA    NA 4.91  4.91 
## 10    19.0  2.03     NA    NA 2.03  2.03 
## # ℹ 1,530 more rows</code></pre>
<div class="sourceCode" id="cb130"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb130-1"><a href="computer-practical-1---missing-data.html#cb130-1" tabindex="-1"></a><span class="fu">ggplot</span>(smdi_nab,</span>
<span id="cb130-2"><a href="computer-practical-1---missing-data.html#cb130-2" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> eventtime,</span>
<span id="cb130-3"><a href="computer-practical-1---missing-data.html#cb130-3" tabindex="-1"></a>           <span class="at">fill =</span> status))<span class="sc">+</span></span>
<span id="cb130-4"><a href="computer-practical-1---missing-data.html#cb130-4" tabindex="-1"></a>  <span class="fu">geom_histogram</span>() <span class="sc">+</span> <span class="fu">facet_wrap</span>(<span class="sc">~</span>pdl1_num_NA, <span class="at">scales =</span> <span class="st">&quot;free_y&quot;</span>)</span></code></pre></div>
<p><img src="CT4H_notes_files/figure-html/unnamed-chunk-155-1.png" width="672" /></p>
<p>It appears that <code>pdl1_num</code> values are likely to be MNAR, since the outcome distribution looks different (proportionally more early deaths) for the missing values.</p>
<p>We could make many more plots of this type: for example, by plotting the distributions of other variables rather than the outcome.</p>
<p>For example, we could look at how the missingness of each variable relates to smoking category:</p>
<div class="sourceCode" id="cb131"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb131-1"><a href="computer-practical-1---missing-data.html#cb131-1" tabindex="-1"></a><span class="fu">library</span>(gridExtra)</span>
<span id="cb131-2"><a href="computer-practical-1---missing-data.html#cb131-2" tabindex="-1"></a>ecog_sm <span class="ot">=</span> <span class="fu">ggplot</span>(smdi_nab,</span>
<span id="cb131-3"><a href="computer-practical-1---missing-data.html#cb131-3" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> smoking_cat,</span>
<span id="cb131-4"><a href="computer-practical-1---missing-data.html#cb131-4" tabindex="-1"></a>           <span class="at">fill =</span> ecog_cat_NA))<span class="sc">+</span></span>
<span id="cb131-5"><a href="computer-practical-1---missing-data.html#cb131-5" tabindex="-1"></a>  <span class="fu">geom_bar</span>() </span>
<span id="cb131-6"><a href="computer-practical-1---missing-data.html#cb131-6" tabindex="-1"></a></span>
<span id="cb131-7"><a href="computer-practical-1---missing-data.html#cb131-7" tabindex="-1"></a></span>
<span id="cb131-8"><a href="computer-practical-1---missing-data.html#cb131-8" tabindex="-1"></a>egfr_sm <span class="ot">=</span> <span class="fu">ggplot</span>(smdi_nab,</span>
<span id="cb131-9"><a href="computer-practical-1---missing-data.html#cb131-9" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> smoking_cat,</span>
<span id="cb131-10"><a href="computer-practical-1---missing-data.html#cb131-10" tabindex="-1"></a>           <span class="at">fill =</span> egfr_cat_NA))<span class="sc">+</span></span>
<span id="cb131-11"><a href="computer-practical-1---missing-data.html#cb131-11" tabindex="-1"></a>  <span class="fu">geom_bar</span>() </span>
<span id="cb131-12"><a href="computer-practical-1---missing-data.html#cb131-12" tabindex="-1"></a></span>
<span id="cb131-13"><a href="computer-practical-1---missing-data.html#cb131-13" tabindex="-1"></a>pdl1_sm <span class="ot">=</span> <span class="fu">ggplot</span>(smdi_nab,</span>
<span id="cb131-14"><a href="computer-practical-1---missing-data.html#cb131-14" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> smoking_cat,</span>
<span id="cb131-15"><a href="computer-practical-1---missing-data.html#cb131-15" tabindex="-1"></a>           <span class="at">fill =</span> pdl1_num_NA))<span class="sc">+</span></span>
<span id="cb131-16"><a href="computer-practical-1---missing-data.html#cb131-16" tabindex="-1"></a>  <span class="fu">geom_bar</span>()</span>
<span id="cb131-17"><a href="computer-practical-1---missing-data.html#cb131-17" tabindex="-1"></a></span>
<span id="cb131-18"><a href="computer-practical-1---missing-data.html#cb131-18" tabindex="-1"></a><span class="fu">grid.arrange</span>(ecog_sm, egfr_sm, pdl1_sm, <span class="at">nrow=</span><span class="dv">1</span>)</span></code></pre></div>
<p><img src="CT4H_notes_files/figure-html/unnamed-chunk-156-1.png" width="672" /></p>
<p>So, it looks likely that the missingness of <code>egfr_cat</code> depends on smoking status, but less likely that the missingness of the other two variables does.</p>
</div>
</details>
<p>Looking into all the variables one by one like this would take a very long time, and wouldn’t even allow us to make any (useful) conclusions. Really what we want to know is whether there is a significant difference in the observed data compared to the missing data.</p>
<div id="sec-statsum" class="section level3 hasAnchor" number="9.3.1">
<h3><span class="header-section-number">A.3.1</span> Statistical summaries of the effect of missingness<a href="computer-practical-1---missing-data.html#sec-statsum" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>According to the framework coined by <span class="citation">Rubin (<a href="#ref-rubin1976inference">1976</a>)</span>, if the data are MAR (missing at random) then the missingness can be explained by (some of) the observed covariates. We would therefore expect the participant characteristics to be different between those with missing values and those without. If the missingness is MCAR (missing completely at random) we would expect no significant difference. Similarly, if the data are MNAR (missing not-at-random) due to some unobserved variable that is independent of all observed variables, we would expect no pattern. In reality this is almost never the case (the confounding variables are usually linked to some observed variables) and so really we are testing against the data being MCAR.</p>
<div id="hotellings-multivariate-t-test" class="section level4 hasAnchor" number="9.3.1.1">
<h4><span class="header-section-number">A.3.1.1</span> Hotelling’s multivariate t-test<a href="computer-practical-1---missing-data.html#hotellings-multivariate-t-test" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>This test examines the differences between those observations with an observation (of some partially observed variable) and those without. The test statistic is derived by assuming both groups are drawn from the same multivariate normal distribution, and so a high value of the test statistic (conversely a low p-value) suggests that there are significant differences between the groups. This test is from a generalisation of Student’s <span class="math inline">\(t\)</span>-test made by <span class="citation">Hotelling et al. (<a href="#ref-hotelling1931generalization">1931</a>)</span>.</p>
<div class="technique">
<p>To perform Hotelling’s multivariate <span class="math inline">\(t\)</span>-test on the <code>sup_df</code> data we enter</p>
<div class="sourceCode" id="cb132"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb132-1"><a href="computer-practical-1---missing-data.html#cb132-1" tabindex="-1"></a><span class="fu">smdi_hotelling</span>(sup_df)</span></code></pre></div>
<pre><code>##   covariate hotteling_p
## 1       bmi       0.340</code></pre>
<p>For this data, we find that there is insufficient evidence to reject the hypothesis that the BMI data are MCAR.</p>
</div>
<div class="exercise">
<p><span id="exr:unlabeled-div-59" class="exercise"><strong>Exercise A.6  </strong></span>Perform Hotelling’s multivariate <span class="math inline">\(t\)</span>-test on the other two datasets, <code>opt_tmp</code> and <code>smdi_data</code>. What do you find?</p>
</div>
<details>
<summary>
Click for solution
</summary>
<p>First we’ll look at <code>smdi_data</code>.</p>
<div class="sourceCode" id="cb134"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb134-1"><a href="computer-practical-1---missing-data.html#cb134-1" tabindex="-1"></a><span class="fu">smdi_hotelling</span>(smdi_data)</span></code></pre></div>
<pre><code>##   covariate hotteling_p
## 1  ecog_cat       0.783
## 2  egfr_cat       &lt;.001
## 3  pdl1_num       &lt;.001</code></pre>
<p>It appears that <code>ecog_cat</code> may be MCAR, but for <code>egfr_cat</code> and <code>pdl1_num</code> there is sufficient evidence to suggest MAR or MNAR.</p>
<p>Now for <code>opt_tmp</code></p>
<div class="sourceCode" id="cb136"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb136-1"><a href="computer-practical-1---missing-data.html#cb136-1" tabindex="-1"></a><span class="fu">smdi_hotelling</span>(opt_tmp)</span></code></pre></div>
<pre><code>##     covariate hotteling_p
## 1         BMI       &lt;.001
## 2     Use.Tob       &lt;.001
## 3     Use.Alc       &lt;.001
## 4    Drug.Add       &lt;.001
## 5 Birthweight       &lt;.001</code></pre>
<p>These all appear to have a significant departure from MCAR.</p>
</details>
<p><strong>Caution</strong>: The power of this test (and others like it) can be strongly influenced by sample size, so it is sensible to combine it with a more detailed approach.</p>
</div>
<div id="absolute-standardised-mean-difference" class="section level4 hasAnchor" number="9.3.1.2">
<h4><span class="header-section-number">A.3.1.2</span> Absolute standardised mean difference<a href="computer-practical-1---missing-data.html#absolute-standardised-mean-difference" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The <strong>absolute standardised mean difference</strong> (ASMD) gives a measure of how different the values of the observed covariates are for missing versus observed values of each partially observed covariate. For every partially observed covariate, there is an ASMD for each other covariate.</p>
<p>Label the partially observed covariate <span class="math inline">\(X_M\)</span>, and suppose <span class="math inline">\(X_1,\ldots,X_K\)</span> are the other covariates. The dataset is split into those cases with <span class="math inline">\(X_M\)</span> observed and those with <span class="math inline">\(X_M\)</span> missing. For each covariate <span class="math inline">\(X_1,\ldots,X_K\)</span> we find the absolute value of the difference in means, and divide this by the standard deviation of that covariate. The ASMD is therefore always non-negative, and should not be affected by sample size.</p>
<p>A general rule of thumb is that ASMD values over 0.1 are cause for concern, though again this can be vulnerable to small sample sizes.</p>
<div class="technique">
<p>The function <code>smdi_asmd</code> from <code>smdi</code> creates an <code>asmd</code> object, which has several parts to it. Note that we set <code>includeNA=T</code> so that we can see the effect of missingness, as well as observed values, of other variables. This won’t make a difference for <code>sup_df</code>, but it will in the exercise.</p>
<div class="sourceCode" id="cb138"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb138-1"><a href="computer-practical-1---missing-data.html#cb138-1" tabindex="-1"></a>asmd_sup <span class="ot">=</span> <span class="fu">smdi_asmd</span>(sup_df, <span class="at">includeNA=</span>T)</span></code></pre></div>
<p>Firstly there is a summary table, which shows the median, min and max of ASMD for each partially observed covariate.</p>
<div class="sourceCode" id="cb139"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb139-1"><a href="computer-practical-1---missing-data.html#cb139-1" tabindex="-1"></a>asmd_sup</span></code></pre></div>
<pre><code>## # A tibble: 1 × 4
##   covariate asmd_median asmd_min asmd_max
## * &lt;chr&gt;     &lt;chr&gt;       &lt;chr&gt;    &lt;chr&gt;   
## 1 bmi       0.471       0.343    0.604</code></pre>
<p>There is also a <code>Table 1</code>, so called because a summary table of this nature should always be included when summarising a dataset in terms of the difference between two groups. This is formatted a little strangely, as it is designed for use in printed works. This table includes the result of a statistical test (by default a chi-squared test) showing whether the differences are statistically significant. (The function <code>kable</code> here is to do with formatting the table for HTML, not to do with missing data).</p>
<div class="sourceCode" id="cb141"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb141-1"><a href="computer-practical-1---missing-data.html#cb141-1" tabindex="-1"></a><span class="fu">kable</span>(asmd_sup<span class="sc">$</span>bmi<span class="sc">$</span>asmd_table1)</span></code></pre></div>
<table>
<colgroup>
<col width="36%" />
<col width="19%" />
<col width="19%" />
<col width="8%" />
<col width="7%" />
<col width="8%" />
</colgroup>
<thead>
<tr class="header">
<th align="left"></th>
<th align="left">0</th>
<th align="left">1</th>
<th align="left">p</th>
<th align="left">test</th>
<th align="left">SMD</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">n</td>
<td align="left">100</td>
<td align="left">3</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left">group = 2 (%)</td>
<td align="left">50 (50.0)</td>
<td align="left">1 (33.3)</td>
<td align="left">1.000</td>
<td align="left"></td>
<td align="left">0.343</td>
</tr>
<tr class="odd">
<td align="left">gender = 1 (%)</td>
<td align="left">44 (44.0)</td>
<td align="left">2 (66.7)</td>
<td align="left">0.850</td>
<td align="left"></td>
<td align="left">0.468</td>
</tr>
<tr class="even">
<td align="left">age (mean (SD))</td>
<td align="left">48.10 (13.30)</td>
<td align="left">41.00 (16.46)</td>
<td align="left">0.367</td>
<td align="left"></td>
<td align="left">0.474</td>
</tr>
<tr class="odd">
<td align="left">onset_sensory (mean (SD))</td>
<td align="left">13.00 (11.44)</td>
<td align="left">24.00 (23.07)</td>
<td align="left">0.114</td>
<td align="left"></td>
<td align="left">0.604</td>
</tr>
</tbody>
</table>
<p>Finally there is a plot showing each ASMD</p>
<div class="sourceCode" id="cb142"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb142-1"><a href="computer-practical-1---missing-data.html#cb142-1" tabindex="-1"></a>asmd_sup<span class="sc">$</span>bmi<span class="sc">$</span>asmd_plot</span></code></pre></div>
<p><img src="CT4H_notes_files/figure-html/unnamed-chunk-163-1.png" width="672" /></p>
<p>We see that although the ASMD values are quite large (much bigger than the advised 0.1), because there are a very small number of them they are not statistically significant.</p>
</div>
<div class="exercise">
<p><span id="exr:unlabeled-div-60" class="exercise"><strong>Exercise A.7  </strong></span>Investigate the ASMD for our datasets <code>smdi_data</code> and <code>opt_tmp</code>. Of the partially observed covariates, which seem to be most strongly related to other covariates? Do any seem to be MCAR?</p>
<p><em>Make sure you remove any participant ID variables, since we don’t want to include those in our analysis!
Again, it might be a good idea to pair up!</em></p>
</div>
<details>
<summary>
Click for solution
</summary>
<div class="solution">
<p><span id="unlabeled-div-61" class="solution"><em>Solution</em>. </span>We will do this just for the <code>opt_tmp</code> data in the solutions.</p>
<div class="sourceCode" id="cb143"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb143-1"><a href="computer-practical-1---missing-data.html#cb143-1" tabindex="-1"></a>asmd_opt <span class="ot">=</span> <span class="fu">smdi_asmd</span>(opt_tmp[ ,<span class="sc">-</span><span class="dv">1</span>], <span class="at">includeNA=</span>T)</span>
<span id="cb143-2"><a href="computer-practical-1---missing-data.html#cb143-2" tabindex="-1"></a>asmd_opt</span></code></pre></div>
<pre><code>## # A tibble: 5 × 4
##   covariate   asmd_median asmd_min asmd_max
## * &lt;chr&gt;       &lt;chr&gt;       &lt;chr&gt;    &lt;chr&gt;   
## 1 BMI         0.195       0.041    1.717   
## 2 Use.Tob     0.093       0.004    39.900  
## 3 Use.Alc     0.099       0.004    8.204   
## 4 Drug.Add    0.073       0.004    7.229   
## 5 Birthweight 0.340       0.004    2.556</code></pre>
<p>These values are all well above 0.1, so it seems unlikely that the data are MCAR.</p>
<p>We can look in a little more detail, first at BMI:</p>
<div class="sourceCode" id="cb145"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb145-1"><a href="computer-practical-1---missing-data.html#cb145-1" tabindex="-1"></a>asmd_opt<span class="sc">$</span>BMI<span class="sc">$</span>asmd_plot</span></code></pre></div>
<p><img src="CT4H_notes_files/figure-html/unnamed-chunk-165-1.png" width="672" /></p>
<div class="sourceCode" id="cb146"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb146-1"><a href="computer-practical-1---missing-data.html#cb146-1" tabindex="-1"></a><span class="fu">kable</span>(asmd_opt<span class="sc">$</span>BMI<span class="sc">$</span>asmd_table1)</span></code></pre></div>
<table>
<colgroup>
<col width="31%" />
<col width="22%" />
<col width="22%" />
<col width="9%" />
<col width="6%" />
<col width="7%" />
</colgroup>
<thead>
<tr class="header">
<th align="left"></th>
<th align="left">0</th>
<th align="left">1</th>
<th align="left">p</th>
<th align="left">test</th>
<th align="left">SMD</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">n</td>
<td align="left">750</td>
<td align="left">73</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left">Clinic (%)</td>
<td align="left"></td>
<td align="left"></td>
<td align="left">&lt;0.001</td>
<td align="left"></td>
<td align="left">1.717</td>
</tr>
<tr class="odd">
<td align="left">KY</td>
<td align="left">205 (27.3)</td>
<td align="left">6 ( 8.2)</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left">MN</td>
<td align="left">237 (31.6)</td>
<td align="left">10 (13.7)</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left">MS</td>
<td align="left">192 (25.6)</td>
<td align="left">0 ( 0.0)</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left">NY</td>
<td align="left">116 (15.5)</td>
<td align="left">57 (78.1)</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left">Group = T (%)</td>
<td align="left">375 (50.0)</td>
<td align="left">38 (52.1)</td>
<td align="left">0.832</td>
<td align="left"></td>
<td align="left">0.041</td>
</tr>
<tr class="even">
<td align="left">Age (mean (SD))</td>
<td align="left">25.91 (5.54)</td>
<td align="left">26.68 (5.87)</td>
<td align="left">0.256</td>
<td align="left"></td>
<td align="left">0.136</td>
</tr>
<tr class="odd">
<td align="left">Education (%)</td>
<td align="left"></td>
<td align="left"></td>
<td align="left">0.137</td>
<td align="left"></td>
<td align="left">0.229</td>
</tr>
<tr class="even">
<td align="left">8-12 yrs</td>
<td align="left">441 (58.8)</td>
<td align="left">38 (52.1)</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left">LT 8 yrs</td>
<td align="left">134 (17.9)</td>
<td align="left">20 (27.4)</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left">MT 12 yrs</td>
<td align="left">175 (23.3)</td>
<td align="left">15 (20.5)</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left">Public.Asstce = Yes (%)</td>
<td align="left">563 (75.1)</td>
<td align="left">38 (52.1)</td>
<td align="left">&lt;0.001</td>
<td align="left"></td>
<td align="left">0.492</td>
</tr>
<tr class="even">
<td align="left">Hypertension = Y (%)</td>
<td align="left">25 ( 3.3)</td>
<td align="left">0 ( 0.0)</td>
<td align="left">0.220</td>
<td align="left"></td>
<td align="left">0.263</td>
</tr>
<tr class="odd">
<td align="left">Diabetes = Yes (%)</td>
<td align="left">24 ( 3.2)</td>
<td align="left">0 ( 0.0)</td>
<td align="left">0.235</td>
<td align="left"></td>
<td align="left">0.257</td>
</tr>
<tr class="even">
<td align="left">Use.Tob (%)</td>
<td align="left"></td>
<td align="left"></td>
<td align="left">0.153</td>
<td align="left"></td>
<td align="left">0.269</td>
</tr>
<tr class="odd">
<td align="left">No</td>
<td align="left">636 (84.8)</td>
<td align="left">68 (93.2)</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left">Yes</td>
<td align="left">89 (11.9)</td>
<td align="left">4 ( 5.5)</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left">NA</td>
<td align="left">25 ( 3.3)</td>
<td align="left">1 ( 1.4)</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left">Use.Alc (%)</td>
<td align="left"></td>
<td align="left"></td>
<td align="left">0.583</td>
<td align="left"></td>
<td align="left">0.146</td>
</tr>
<tr class="odd">
<td align="left">No</td>
<td align="left">709 (94.5)</td>
<td align="left">71 (97.3)</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left">Yes</td>
<td align="left">15 ( 2.0)</td>
<td align="left">1 ( 1.4)</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left">NA</td>
<td align="left">26 ( 3.5)</td>
<td align="left">1 ( 1.4)</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left">Drug.Add (%)</td>
<td align="left"></td>
<td align="left"></td>
<td align="left">0.434</td>
<td align="left"></td>
<td align="left">0.161</td>
</tr>
<tr class="odd">
<td align="left">No</td>
<td align="left">720 (96.0)</td>
<td align="left">71 (97.3)</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left">Yes</td>
<td align="left">4 ( 0.5)</td>
<td align="left">1 ( 1.4)</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left">NA</td>
<td align="left">26 ( 3.5)</td>
<td align="left">1 ( 1.4)</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left">Prev.preg = Yes (%)</td>
<td align="left">555 (74.0)</td>
<td align="left">56 (76.7)</td>
<td align="left">0.715</td>
<td align="left"></td>
<td align="left">0.063</td>
</tr>
<tr class="odd">
<td align="left">Birthweight (mean (SD))</td>
<td align="left">3194.08 (684.92)</td>
<td align="left">3247.29 (669.27)</td>
<td align="left">0.529</td>
<td align="left"></td>
<td align="left">0.079</td>
</tr>
</tbody>
</table>
<p>We see that there appears to be a strong relationship between <code>clinic</code> and missingness of BMI. In particular, a disproportionately high number of missing BMI values seem to be from the New York (NY) clinic. There also appears to be less missingness for those with <code>public.asstce=1</code> (those for whom the government paid for the delivery).</p>
<p>Next we look at <code>Use.Alc</code></p>
<div class="sourceCode" id="cb147"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb147-1"><a href="computer-practical-1---missing-data.html#cb147-1" tabindex="-1"></a><span class="fu">kable</span>(asmd_opt<span class="sc">$</span>Use.Alc<span class="sc">$</span>asmd_table1)</span></code></pre></div>
<table>
<colgroup>
<col width="31%" />
<col width="22%" />
<col width="22%" />
<col width="9%" />
<col width="6%" />
<col width="7%" />
</colgroup>
<thead>
<tr class="header">
<th align="left"></th>
<th align="left">0</th>
<th align="left">1</th>
<th align="left">p</th>
<th align="left">test</th>
<th align="left">SMD</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">n</td>
<td align="left">796</td>
<td align="left">27</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left">Clinic (%)</td>
<td align="left"></td>
<td align="left"></td>
<td align="left">&lt;0.001</td>
<td align="left"></td>
<td align="left">0.874</td>
</tr>
<tr class="odd">
<td align="left">KY</td>
<td align="left">207 (26.0)</td>
<td align="left">4 (14.8)</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left">MN</td>
<td align="left">239 (30.0)</td>
<td align="left">8 (29.6)</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left">MS</td>
<td align="left">191 (24.0)</td>
<td align="left">1 ( 3.7)</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left">NY</td>
<td align="left">159 (20.0)</td>
<td align="left">14 (51.9)</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left">Group = T (%)</td>
<td align="left">399 (50.1)</td>
<td align="left">14 (51.9)</td>
<td align="left">1.000</td>
<td align="left"></td>
<td align="left">0.035</td>
</tr>
<tr class="even">
<td align="left">Age (mean (SD))</td>
<td align="left">25.96 (5.59)</td>
<td align="left">26.37 (4.99)</td>
<td align="left">0.710</td>
<td align="left"></td>
<td align="left">0.077</td>
</tr>
<tr class="odd">
<td align="left">Education (%)</td>
<td align="left"></td>
<td align="left"></td>
<td align="left">0.936</td>
<td align="left"></td>
<td align="left">0.070</td>
</tr>
<tr class="even">
<td align="left">8-12 yrs</td>
<td align="left">464 (58.3)</td>
<td align="left">15 (55.6)</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left">LT 8 yrs</td>
<td align="left">149 (18.7)</td>
<td align="left">5 (18.5)</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left">MT 12 yrs</td>
<td align="left">183 (23.0)</td>
<td align="left">7 (25.9)</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left">Public.Asstce = Yes (%)</td>
<td align="left">582 (73.1)</td>
<td align="left">19 (70.4)</td>
<td align="left">0.924</td>
<td align="left"></td>
<td align="left">0.061</td>
</tr>
<tr class="even">
<td align="left">Hypertension = Y (%)</td>
<td align="left">23 ( 2.9)</td>
<td align="left">2 ( 7.4)</td>
<td align="left">0.438</td>
<td align="left"></td>
<td align="left">0.206</td>
</tr>
<tr class="odd">
<td align="left">Diabetes = Yes (%)</td>
<td align="left">24 ( 3.0)</td>
<td align="left">0 ( 0.0)</td>
<td align="left">0.738</td>
<td align="left"></td>
<td align="left">0.249</td>
</tr>
<tr class="even">
<td align="left">BMI (mean (SD))</td>
<td align="left">27.70 (7.16)</td>
<td align="left">26.88 (6.18)</td>
<td align="left">0.568</td>
<td align="left"></td>
<td align="left">0.122</td>
</tr>
<tr class="odd">
<td align="left">Use.Tob (%)</td>
<td align="left"></td>
<td align="left"></td>
<td align="left">&lt;0.001</td>
<td align="left"></td>
<td align="left">8.204</td>
</tr>
<tr class="even">
<td align="left">No</td>
<td align="left">704 (88.4)</td>
<td align="left">0 ( 0.0)</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left">Yes</td>
<td align="left">92 (11.6)</td>
<td align="left">1 ( 3.7)</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left">NA</td>
<td align="left">0 ( 0.0)</td>
<td align="left">26 (96.3)</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left">Drug.Add (%)</td>
<td align="left"></td>
<td align="left"></td>
<td align="left">&lt;0.001</td>
<td align="left"></td>
<td align="left">7.079</td>
</tr>
<tr class="even">
<td align="left">No</td>
<td align="left">790 (99.2)</td>
<td align="left">1 ( 3.7)</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left">Yes</td>
<td align="left">5 ( 0.6)</td>
<td align="left">0 ( 0.0)</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left">NA</td>
<td align="left">1 ( 0.1)</td>
<td align="left">26 (96.3)</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left">Prev.preg = Yes (%)</td>
<td align="left">591 (74.2)</td>
<td align="left">20 (74.1)</td>
<td align="left">1.000</td>
<td align="left"></td>
<td align="left">0.004</td>
</tr>
<tr class="even">
<td align="left">Birthweight (mean (SD))</td>
<td align="left">3198.27 (677.67)</td>
<td align="left">3225.88 (949.61)</td>
<td align="left">0.873</td>
<td align="left"></td>
<td align="left">0.033</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb148"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb148-1"><a href="computer-practical-1---missing-data.html#cb148-1" tabindex="-1"></a>asmd_opt<span class="sc">$</span>Use.Alc<span class="sc">$</span>asmd_plot</span></code></pre></div>
<p><img src="CT4H_notes_files/figure-html/unnamed-chunk-167-1.png" width="672" /></p>
<p>This time the two most strongly related covariates are <code>Use.Tob</code> and <code>Drug.Add</code>. This is perhaps not surprising because they are quite similar variables. Notice that <code>clinic</code> still has a strong effect (the <span class="math inline">\(x\)</span>-axis goes a lot higher on this plot than the one for BMI). From the table, we see that again a disproportionately high number of missing values come from the NY clinic, and that missingness in <code>Use.Alc</code> is much more likely if <code>Use.Tob</code> and/or <code>Drug.Add</code> are missing.</p>
</div>
</details>
</div>
</div>
<div id="modelling-missingness" class="section level3 hasAnchor" number="9.3.2">
<h3><span class="header-section-number">A.3.2</span> Modelling missingness<a href="computer-practical-1---missing-data.html#modelling-missingness" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>One of the most common ways to model missingness is using <strong>logistic regression</strong>. You might already have come across this in your degree, and we’ll do more about it later, but for now the box below tells you all you need to know.</p>
<div class="technique">
<p><strong>Logistic regression</strong> is a type of <strong>generalised linear model</strong> that is used to model a binary categorical variable <span class="math inline">\(Y\)</span> (often labelled <code>0</code> and <code>1</code>). In our cases the values are <code>NA</code> and <code>!NA</code> or ‘missing’ and ‘not missing’.</p>
<p>The logistic regression model has the form</p>
<p><span class="math display">\[ \operatorname{logit}\left(p\right) = \log \left(\frac{p}{1-p}\right) = \beta_0 + \beta_1 x_1 + \ldots + \beta_p x_p,\]</span>
where <span class="math inline">\(p = p\left(Y=1\right)\)</span> the <span class="math inline">\(x_i\)</span> are explanatory variables (in our case this will be the baseline covariates and the trial arm), the <span class="math inline">\(\beta_i\)</span> are coefficients and <span class="math inline">\(p\)</span> is the probability of an outcome of <code>1</code>.</p>
<p>The logit function rescales the probability (which can only be in <span class="math inline">\(\left[0,1\right]\)</span>) to the real line, so that it works with linear combination on the right hand side. Conversely, applying the inverse logit function to the RHS gives a value in <span class="math inline">\(\left[0,1\right]\)</span>.</p>
<p>Fitting a logistic regression model in R is very similar to fitting a linear regression. We use the function <code>glm</code>, which is a general function for generalised linear models. To specify that we want logistic regression, we must include the argument <code>family = binoial(link = "logit")</code>.</p>
</div>
<p>We’ll use our <code>nabular</code> objects for this, since we already have variables denoting missingness. For example, we can see whether missingness of BMI in the <code>supraclavicular</code> dataset relates to any of the other variables.</p>
<div class="sourceCode" id="cb149"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb149-1"><a href="computer-practical-1---missing-data.html#cb149-1" tabindex="-1"></a>sup_nab <span class="ot">=</span> <span class="fu">nabular</span>(sup_df)</span>
<span id="cb149-2"><a href="computer-practical-1---missing-data.html#cb149-2" tabindex="-1"></a>sup_glm <span class="ot">=</span> <span class="fu">glm</span>(bmi_NA <span class="sc">~</span> group <span class="sc">+</span> gender <span class="sc">+</span> age <span class="sc">+</span> onset_sensory, </span>
<span id="cb149-3"><a href="computer-practical-1---missing-data.html#cb149-3" tabindex="-1"></a>              <span class="at">data =</span> sup_nab, </span>
<span id="cb149-4"><a href="computer-practical-1---missing-data.html#cb149-4" tabindex="-1"></a>              <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">&quot;logit&quot;</span>))</span>
<span id="cb149-5"><a href="computer-practical-1---missing-data.html#cb149-5" tabindex="-1"></a><span class="fu">summary</span>(sup_glm)</span></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = bmi_NA ~ group + gender + age + onset_sensory, 
##     family = binomial(link = &quot;logit&quot;), data = sup_nab)
## 
## Coefficients:
##               Estimate Std. Error z value Pr(&gt;|z|)
## (Intercept)   -2.45041    2.26927  -1.080    0.280
## group2        -1.46042    1.38616  -1.054    0.292
## gender1        0.99119    1.28605   0.771    0.441
## age           -0.04954    0.04609  -1.075    0.282
## onset_sensory  0.06444    0.04116   1.566    0.117
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 27.128  on 102  degrees of freedom
## Residual deviance: 22.854  on  98  degrees of freedom
## AIC: 32.854
## 
## Number of Fisher Scoring iterations: 7</code></pre>
<p>In this case none of the other variables are significant, so it would be reasonable to proceed as though the missingness of BMI is MCAR (unless there is expert knowledge to suggest that missingness might be linked to some other observed factor). This agrees with what we found in Section <a href="computer-practical-1---missing-data.html#sec-statsum">A.3.1</a></p>
<p><strong>A word of caution</strong>: the default in most R functions, particularly for plotting or fitting models, is to remove all rows with any missingness. In a situation where there are missing values for multiple variables, particularly if the missingness is related, this could in itself introduce bias.</p>
<div class="exercise">
<p><span id="exr:unlabeled-div-62" class="exercise"><strong>Exercise A.8  </strong></span>Model the patterns of missingness for <code>smdi</code> and <code>opt</code> (use the <code>opt_tmp</code> data for this, without the severely missing variables). What do you find?</p>
</div>
<div class="technique">
<p>To avoid typing out all the column names for the formula, you can copy and paste the output from</p>
<div class="sourceCode" id="cb151"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb151-1"><a href="computer-practical-1---missing-data.html#cb151-1" tabindex="-1"></a><span class="fu">paste</span>(<span class="fu">names</span>(smdi_data), <span class="at">collapse =</span> <span class="st">&quot; + &quot;</span>)</span></code></pre></div>
<p>and delete the terms you don’t want.</p>
</div>
<details>
<summary>
Click for solution
</summary>
<div class="solution">
<p><span id="unlabeled-div-63" class="solution"><em>Solution</em>. </span><strong>Lung cancer data</strong></p>
<p>We can fit a few models, to see what we find. First we’ll tackle <code>ecog_cat_NA</code>.</p>
<p>Missingness in <code>ecog_cat</code> doesn’t appear to be associated with any other baseline covariates:</p>
<div class="sourceCode" id="cb152"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb152-1"><a href="computer-practical-1---missing-data.html#cb152-1" tabindex="-1"></a>ecog_NA_glm1 <span class="ot">=</span> <span class="fu">glm</span>(ecog_cat_NA <span class="sc">~</span> exposure <span class="sc">+</span> age_num <span class="sc">+</span> female_cat <span class="sc">+</span> smoking_cat <span class="sc">+</span> physical_cat <span class="sc">+</span> alk_cat <span class="sc">+</span> histology_cat <span class="sc">+</span> ses_cat <span class="sc">+</span> copd_cat, </span>
<span id="cb152-2"><a href="computer-practical-1---missing-data.html#cb152-2" tabindex="-1"></a>                <span class="at">data=</span>smdi_nab, <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link=</span><span class="st">&quot;logit&quot;</span>))</span>
<span id="cb152-3"><a href="computer-practical-1---missing-data.html#cb152-3" tabindex="-1"></a><span class="fu">summary</span>(ecog_NA_glm1)</span></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = ecog_cat_NA ~ exposure + age_num + female_cat + 
##     smoking_cat + physical_cat + alk_cat + histology_cat + ses_cat + 
##     copd_cat, family = binomial(link = &quot;logit&quot;), data = smdi_nab)
## 
## Coefficients:
##                  Estimate Std. Error z value Pr(&gt;|z|)  
## (Intercept)     -0.546409   0.226805  -2.409    0.016 *
## exposure        -0.089400   0.088616  -1.009    0.313  
## age_num         -0.002654   0.003034  -0.875    0.382  
## female_cat1     -0.034202   0.086890  -0.394    0.694  
## smoking_cat1     0.101202   0.097823   1.035    0.301  
## physical_cat1    0.137491   0.087074   1.579    0.114  
## alk_cat1        -0.049371   0.257094  -0.192    0.848  
## histology_cat1  -0.002256   0.104115  -0.022    0.983  
## ses_cat2_middle  0.128238   0.113992   1.125    0.261  
## ses_cat3_high    0.098773   0.113447   0.871    0.384  
## copd_cat1       -0.017240   0.098015  -0.176    0.860  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 3265.9  on 2499  degrees of freedom
## Residual deviance: 3259.5  on 2489  degrees of freedom
## AIC: 3281.5
## 
## Number of Fisher Scoring iterations: 4</code></pre>
<p>Now including the other variables with missing values:</p>
<div class="sourceCode" id="cb154"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb154-1"><a href="computer-practical-1---missing-data.html#cb154-1" tabindex="-1"></a>ecog_NA_glm2 <span class="ot">=</span> <span class="fu">glm</span>(ecog_cat_NA <span class="sc">~</span> exposure <span class="sc">+</span> age_num <span class="sc">+</span> female_cat <span class="sc">+</span> smoking_cat <span class="sc">+</span> physical_cat <span class="sc">+</span> alk_cat <span class="sc">+</span> histology_cat <span class="sc">+</span> ses_cat <span class="sc">+</span> copd_cat <span class="sc">+</span> egfr_cat <span class="sc">+</span> pdl1_num, </span>
<span id="cb154-2"><a href="computer-practical-1---missing-data.html#cb154-2" tabindex="-1"></a>                <span class="at">data=</span>smdi_nab, <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link=</span><span class="st">&quot;logit&quot;</span>))</span>
<span id="cb154-3"><a href="computer-practical-1---missing-data.html#cb154-3" tabindex="-1"></a><span class="fu">summary</span>(ecog_NA_glm2)</span></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = ecog_cat_NA ~ exposure + age_num + female_cat + 
##     smoking_cat + physical_cat + alk_cat + histology_cat + ses_cat + 
##     copd_cat + egfr_cat + pdl1_num, family = binomial(link = &quot;logit&quot;), 
##     data = smdi_nab)
## 
## Coefficients:
##                  Estimate Std. Error z value Pr(&gt;|z|)
## (Intercept)     -0.063844   0.418284  -0.153    0.879
## exposure        -0.094567   0.140956  -0.671    0.502
## age_num         -0.005729   0.004484  -1.278    0.201
## female_cat1     -0.215749   0.133629  -1.615    0.106
## smoking_cat1     0.036868   0.139759   0.264    0.792
## physical_cat1    0.149057   0.130846   1.139    0.255
## alk_cat1         1.050366   0.741154   1.417    0.156
## histology_cat1  -0.092049   0.173989  -0.529    0.597
## ses_cat2_middle  0.215523   0.166471   1.295    0.195
## ses_cat3_high    0.179477   0.166802   1.076    0.282
## copd_cat1        0.106252   0.137255   0.774    0.439
## egfr_cat1        0.082752   0.148229   0.558    0.577
## pdl1_num        -0.008005   0.006214  -1.288    0.198
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 1620.9  on 1240  degrees of freedom
## Residual deviance: 1606.6  on 1228  degrees of freedom
##   (1259 observations deleted due to missingness)
## AIC: 1632.6
## 
## Number of Fisher Scoring iterations: 4</code></pre>
<p>None of the variables are significant, so it is probably reasonable to suppose that <code>ecog_cat</code> is MCAR (indeed the help file tells us it is).</p>
<p>Now for <code>egfr_cat</code>:</p>
<div class="sourceCode" id="cb156"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb156-1"><a href="computer-practical-1---missing-data.html#cb156-1" tabindex="-1"></a>egfr_NA_glm1 <span class="ot">=</span> <span class="fu">glm</span>(egfr_cat_NA <span class="sc">~</span> exposure <span class="sc">+</span> age_num <span class="sc">+</span> female_cat <span class="sc">+</span> smoking_cat <span class="sc">+</span> physical_cat <span class="sc">+</span> alk_cat <span class="sc">+</span> histology_cat <span class="sc">+</span> ses_cat <span class="sc">+</span> copd_cat, </span>
<span id="cb156-2"><a href="computer-practical-1---missing-data.html#cb156-2" tabindex="-1"></a>                <span class="at">data=</span>smdi_nab, <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link=</span><span class="st">&quot;logit&quot;</span>))</span>
<span id="cb156-3"><a href="computer-practical-1---missing-data.html#cb156-3" tabindex="-1"></a><span class="fu">summary</span>(egfr_NA_glm1)</span></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = egfr_cat_NA ~ exposure + age_num + female_cat + 
##     smoking_cat + physical_cat + alk_cat + histology_cat + ses_cat + 
##     copd_cat, family = binomial(link = &quot;logit&quot;), data = smdi_nab)
## 
## Coefficients:
##                  Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)     -2.776612   0.253687 -10.945  &lt; 2e-16 ***
## exposure         0.855880   0.093967   9.108  &lt; 2e-16 ***
## age_num          0.014198   0.003271   4.340 1.42e-05 ***
## female_cat1      0.781194   0.092458   8.449  &lt; 2e-16 ***
## smoking_cat1     0.626782   0.102280   6.128 8.89e-10 ***
## physical_cat1    0.513986   0.092421   5.561 2.68e-08 ***
## alk_cat1         1.116563   0.271932   4.106 4.03e-05 ***
## histology_cat1   0.807125   0.108896   7.412 1.25e-13 ***
## ses_cat2_middle -0.253823   0.119805  -2.119   0.0341 *  
## ses_cat3_high   -0.165891   0.118853  -1.396   0.1628    
## copd_cat1        0.579084   0.102993   5.623 1.88e-08 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 3376.8  on 2499  degrees of freedom
## Residual deviance: 2949.9  on 2489  degrees of freedom
## AIC: 2971.9
## 
## Number of Fisher Scoring iterations: 3</code></pre>
<div class="sourceCode" id="cb158"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb158-1"><a href="computer-practical-1---missing-data.html#cb158-1" tabindex="-1"></a>egfr_NA_glm2 <span class="ot">=</span> <span class="fu">glm</span>(egfr_cat_NA <span class="sc">~</span> exposure <span class="sc">+</span> age_num <span class="sc">+</span> female_cat <span class="sc">+</span> smoking_cat <span class="sc">+</span> physical_cat <span class="sc">+</span> alk_cat <span class="sc">+</span> histology_cat <span class="sc">+</span> ses_cat <span class="sc">+</span> copd_cat <span class="sc">+</span> ecog_cat <span class="sc">+</span> pdl1_num, </span>
<span id="cb158-2"><a href="computer-practical-1---missing-data.html#cb158-2" tabindex="-1"></a>                <span class="at">data=</span>smdi_nab, <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link=</span><span class="st">&quot;logit&quot;</span>))</span>
<span id="cb158-3"><a href="computer-practical-1---missing-data.html#cb158-3" tabindex="-1"></a><span class="fu">summary</span>(egfr_NA_glm2)</span></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = egfr_cat_NA ~ exposure + age_num + female_cat + 
##     smoking_cat + physical_cat + alk_cat + histology_cat + ses_cat + 
##     copd_cat + ecog_cat + pdl1_num, family = binomial(link = &quot;logit&quot;), 
##     data = smdi_nab)
## 
## Coefficients:
##                  Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)     -7.111213   0.592182 -12.008  &lt; 2e-16 ***
## exposure         1.003371   0.164023   6.117 9.52e-10 ***
## age_num          0.023939   0.005328   4.493 7.02e-06 ***
## female_cat1      0.886902   0.149387   5.937 2.90e-09 ***
## smoking_cat1     1.048884   0.165025   6.356 2.07e-10 ***
## physical_cat1    1.089550   0.150277   7.250 4.16e-13 ***
## alk_cat1         3.727345   0.719142   5.183 2.18e-07 ***
## histology_cat1   1.294128   0.173948   7.440 1.01e-13 ***
## ses_cat2_middle -0.072720   0.189281  -0.384    0.701    
## ses_cat3_high   -0.123102   0.189587  -0.649    0.516    
## copd_cat1        0.994580   0.164698   6.039 1.55e-09 ***
## ecog_cat1        0.939474   0.152432   6.163 7.13e-10 ***
## pdl1_num         0.040946   0.007493   5.465 4.63e-08 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 1686.9  on 1273  degrees of freedom
## Residual deviance: 1209.5  on 1261  degrees of freedom
##   (1226 observations deleted due to missingness)
## AIC: 1235.5
## 
## Number of Fisher Scoring iterations: 5</code></pre>
<p>This time there is a definite relationship between missingness and the values of the other covariates, suggesting an MAR or MNAR mechanism.</p>
<p>Finally, let’s model missingness in <code>pdl1_num</code>:</p>
<div class="sourceCode" id="cb160"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb160-1"><a href="computer-practical-1---missing-data.html#cb160-1" tabindex="-1"></a>pdl1_NA_glm1 <span class="ot">=</span> <span class="fu">glm</span>(</span>
<span id="cb160-2"><a href="computer-practical-1---missing-data.html#cb160-2" tabindex="-1"></a>  pdl1_num_NA <span class="sc">~</span> exposure <span class="sc">+</span> age_num <span class="sc">+</span> female_cat <span class="sc">+</span> smoking_cat <span class="sc">+</span> physical_cat <span class="sc">+</span> </span>
<span id="cb160-3"><a href="computer-practical-1---missing-data.html#cb160-3" tabindex="-1"></a>    alk_cat <span class="sc">+</span> histology_cat <span class="sc">+</span> ses_cat <span class="sc">+</span> copd_cat, </span>
<span id="cb160-4"><a href="computer-practical-1---missing-data.html#cb160-4" tabindex="-1"></a>  <span class="at">data=</span>smdi_nab, <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link=</span><span class="st">&quot;logit&quot;</span>))</span>
<span id="cb160-5"><a href="computer-practical-1---missing-data.html#cb160-5" tabindex="-1"></a><span class="fu">summary</span>(pdl1_NA_glm1)</span></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = pdl1_num_NA ~ exposure + age_num + female_cat + 
##     smoking_cat + physical_cat + alk_cat + histology_cat + ses_cat + 
##     copd_cat, family = binomial(link = &quot;logit&quot;), data = smdi_nab)
## 
## Coefficients:
##                  Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)     -1.337969   0.271141  -4.935 8.03e-07 ***
## exposure        -0.707361   0.112571  -6.284 3.31e-10 ***
## age_num          0.002670   0.003621   0.737 0.460901    
## female_cat1      0.115354   0.102830   1.122 0.261947    
## smoking_cat1     0.070899   0.117623   0.603 0.546663    
## physical_cat1   -0.057181   0.105602  -0.541 0.588177    
## alk_cat1         0.880597   0.260178   3.385 0.000713 ***
## histology_cat1  -0.106808   0.127451  -0.838 0.402014    
## ses_cat2_middle -0.072022   0.135175  -0.533 0.594168    
## ses_cat3_high   -0.034611   0.133995  -0.258 0.796175    
## copd_cat1        0.094061   0.118031   0.797 0.425500    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 2548.4  on 2499  degrees of freedom
## Residual deviance: 2488.3  on 2489  degrees of freedom
## AIC: 2510.3
## 
## Number of Fisher Scoring iterations: 4</code></pre>
<div class="sourceCode" id="cb162"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb162-1"><a href="computer-practical-1---missing-data.html#cb162-1" tabindex="-1"></a>pdl1_NA_glm2 <span class="ot">=</span> <span class="fu">glm</span>(pdl1_num_NA <span class="sc">~</span> exposure <span class="sc">+</span> age_num <span class="sc">+</span> female_cat <span class="sc">+</span> smoking_cat <span class="sc">+</span> physical_cat <span class="sc">+</span> alk_cat <span class="sc">+</span> histology_cat <span class="sc">+</span> ses_cat <span class="sc">+</span> copd_cat <span class="sc">+</span> ecog_cat <span class="sc">+</span> egfr_cat, </span>
<span id="cb162-2"><a href="computer-practical-1---missing-data.html#cb162-2" tabindex="-1"></a>                <span class="at">data=</span>smdi_nab, <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link=</span><span class="st">&quot;logit&quot;</span>))</span>
<span id="cb162-3"><a href="computer-practical-1---missing-data.html#cb162-3" tabindex="-1"></a><span class="fu">summary</span>(pdl1_NA_glm2)</span></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = pdl1_num_NA ~ exposure + age_num + female_cat + 
##     smoking_cat + physical_cat + alk_cat + histology_cat + ses_cat + 
##     copd_cat + ecog_cat + egfr_cat, family = binomial(link = &quot;logit&quot;), 
##     data = smdi_nab)
## 
## Coefficients:
##                  Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)     -3.834316   0.566570  -6.768 1.31e-11 ***
## exposure        -0.431716   0.221450  -1.950   0.0512 .  
## age_num          0.015682   0.007177   2.185   0.0289 *  
## female_cat1      0.358442   0.197460   1.815   0.0695 .  
## smoking_cat1     0.300876   0.220606   1.364   0.1726    
## physical_cat1    0.500724   0.201918   2.480   0.0131 *  
## alk_cat1         3.890278   0.673079   5.780 7.48e-09 ***
## histology_cat1   0.479733   0.245695   1.953   0.0509 .  
## ses_cat2_middle -0.102158   0.261232  -0.391   0.6958    
## ses_cat3_high    0.125765   0.253598   0.496   0.6199    
## copd_cat1        0.882138   0.225914   3.905 9.43e-05 ***
## ecog_cat1        0.307018   0.195834   1.568   0.1169    
## egfr_cat1        0.301910   0.227109   1.329   0.1837    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 830.66  on 945  degrees of freedom
## Residual deviance: 737.55  on 933  degrees of freedom
##   (1554 observations deleted due to missingness)
## AIC: 763.55
## 
## Number of Fisher Scoring iterations: 5</code></pre>
<p>This time there are far fewer significantly related variables, but we can again be confident that the mechanism isn’t MCAR.</p>
<p>Frustratingly, the only way we could determine whether the mechanisms for <code>egfr_cat</code> and <code>pdl1_num</code> was MAR or MNAR would be to measure (or otherwise procure) some of the missing data. We simply do not have the necessary information to work out which is the case. If this were a real trial, we would now talk at length with the experts/clinicians, who will have a much better understanding of the probable causes of missingness.</p>
<p><strong>opt</strong></p>
<p>Now we’ll do the same with <code>opt_tmp</code>. We have missingness in several variables: <code>BMI</code>, <code>Use.Tob</code>, <code>Use.Alc</code>, <code>Drug.Add</code>, <code>Birthweight</code>. A model fit to the data in R will remove cases with any of these missing (which for this dataset might mean a lot are removed!). So, as well as building models with all variables, we can build models using only the fully observed data, and use the <code>_NA</code> variables from <code>nabular</code> as covariates:</p>
<div class="sourceCode" id="cb164"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb164-1"><a href="computer-practical-1---missing-data.html#cb164-1" tabindex="-1"></a>glm_opt_BMI_allvar <span class="ot">=</span> <span class="fu">glm</span>(</span>
<span id="cb164-2"><a href="computer-practical-1---missing-data.html#cb164-2" tabindex="-1"></a>  BMI_NA <span class="sc">~</span> Clinic <span class="sc">+</span> Group <span class="sc">+</span> Age <span class="sc">+</span>  </span>
<span id="cb164-3"><a href="computer-practical-1---missing-data.html#cb164-3" tabindex="-1"></a>    Education <span class="sc">+</span> Public.Asstce <span class="sc">+</span> Hypertension <span class="sc">+</span> Diabetes <span class="sc">+</span> Use.Tob <span class="sc">+</span> Use.Alc <span class="sc">+</span> Drug.Add <span class="sc">+</span> Prev.preg, </span>
<span id="cb164-4"><a href="computer-practical-1---missing-data.html#cb164-4" tabindex="-1"></a>  <span class="at">data =</span> <span class="fu">nabular</span>(opt_tmp),</span>
<span id="cb164-5"><a href="computer-practical-1---missing-data.html#cb164-5" tabindex="-1"></a>  <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">&quot;logit&quot;</span>)) </span>
<span id="cb164-6"><a href="computer-practical-1---missing-data.html#cb164-6" tabindex="-1"></a><span class="fu">summary</span>(glm_opt_BMI_allvar)</span></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = BMI_NA ~ Clinic + Group + Age + Education + Public.Asstce + 
##     Hypertension + Diabetes + Use.Tob + Use.Alc + Drug.Add + 
##     Prev.preg, family = binomial(link = &quot;logit&quot;), data = nabular(opt_tmp))
## 
## Coefficients:
##                      Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)          -3.69872    0.86773  -4.263 2.02e-05 ***
## ClinicMN              0.38878    0.58170   0.668   0.5039    
## ClinicMS            -15.63977  755.63175  -0.021   0.9835    
## ClinicNY              3.02941    0.51105   5.928 3.07e-09 ***
## GroupT                0.15793    0.28816   0.548   0.5837    
## Age                  -0.00288    0.02650  -0.109   0.9135    
## EducationLT 8 yrs     0.67635    0.35763   1.891   0.0586 .  
## EducationMT 12 yrs    0.23558    0.37844   0.622   0.5336    
## Public.AsstceYes     -0.18766    0.30399  -0.617   0.5370    
## HypertensionY       -15.53379 1839.84596  -0.008   0.9933    
## DiabetesYes         -15.18021 1942.81416  -0.008   0.9938    
## Use.TobYes           -0.24898    0.59964  -0.415   0.6780    
## Use.AlcYes            0.60910    1.49054   0.409   0.6828    
## Drug.AddYes           0.09438    1.58954   0.059   0.9527    
## Prev.pregYes          0.02862    0.36074   0.079   0.9368    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 483.11  on 794  degrees of freedom
## Residual deviance: 330.17  on 780  degrees of freedom
##   (28 observations deleted due to missingness)
## AIC: 360.17
## 
## Number of Fisher Scoring iterations: 18</code></pre>
<p>Complete cases only:</p>
<div class="sourceCode" id="cb166"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb166-1"><a href="computer-practical-1---missing-data.html#cb166-1" tabindex="-1"></a>glm_opt_BMI_comp <span class="ot">=</span> <span class="fu">glm</span>(</span>
<span id="cb166-2"><a href="computer-practical-1---missing-data.html#cb166-2" tabindex="-1"></a>  BMI_NA <span class="sc">~</span> Clinic <span class="sc">+</span> Group <span class="sc">+</span> Age <span class="sc">+</span>  </span>
<span id="cb166-3"><a href="computer-practical-1---missing-data.html#cb166-3" tabindex="-1"></a>    Education <span class="sc">+</span> Public.Asstce <span class="sc">+</span> Hypertension <span class="sc">+</span> Diabetes <span class="sc">+</span> Prev.preg, </span>
<span id="cb166-4"><a href="computer-practical-1---missing-data.html#cb166-4" tabindex="-1"></a>  <span class="at">data =</span> <span class="fu">nabular</span>(opt_tmp),</span>
<span id="cb166-5"><a href="computer-practical-1---missing-data.html#cb166-5" tabindex="-1"></a>  <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">&quot;logit&quot;</span>)) </span>
<span id="cb166-6"><a href="computer-practical-1---missing-data.html#cb166-6" tabindex="-1"></a><span class="fu">summary</span>(glm_opt_BMI_comp)</span></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = BMI_NA ~ Clinic + Group + Age + Education + Public.Asstce + 
##     Hypertension + Diabetes + Prev.preg, family = binomial(link = &quot;logit&quot;), 
##     data = nabular(opt_tmp))
## 
## Coefficients:
##                      Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)        -3.522e+00  8.233e-01  -4.279 1.88e-05 ***
## ClinicMN            1.960e-01  5.469e-01   0.358   0.7200    
## ClinicMS           -1.582e+01  7.539e+02  -0.021   0.9833    
## ClinicNY            2.752e+00  4.724e-01   5.825 5.72e-09 ***
## GroupT              1.292e-01  2.777e-01   0.465   0.6416    
## Age                -4.618e-03  2.615e-02  -0.177   0.8599    
## EducationLT 8 yrs   6.861e-01  3.442e-01   1.993   0.0463 *  
## EducationMT 12 yrs  2.811e-01  3.674e-01   0.765   0.4442    
## Public.AsstceYes   -2.250e-01  2.980e-01  -0.755   0.4502    
## HypertensionY      -1.633e+01  1.764e+03  -0.009   0.9926    
## DiabetesYes        -1.522e+01  1.938e+03  -0.008   0.9937    
## Prev.pregYes        9.714e-02  3.527e-01   0.275   0.7830    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 493.01  on 822  degrees of freedom
## Residual deviance: 348.69  on 811  degrees of freedom
## AIC: 372.69
## 
## Number of Fisher Scoring iterations: 18</code></pre>
<p>Using missingness of incomplete variables in model:</p>
<div class="sourceCode" id="cb168"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb168-1"><a href="computer-practical-1---missing-data.html#cb168-1" tabindex="-1"></a>glm_opt_BMI_NA <span class="ot">=</span> <span class="fu">glm</span>(</span>
<span id="cb168-2"><a href="computer-practical-1---missing-data.html#cb168-2" tabindex="-1"></a>  BMI_NA <span class="sc">~</span> Clinic <span class="sc">+</span> Group <span class="sc">+</span> Age <span class="sc">+</span>  </span>
<span id="cb168-3"><a href="computer-practical-1---missing-data.html#cb168-3" tabindex="-1"></a>    Education <span class="sc">+</span> Public.Asstce <span class="sc">+</span> Hypertension <span class="sc">+</span> Diabetes <span class="sc">+</span> Use.Tob_NA <span class="sc">+</span> Use.Alc_NA <span class="sc">+</span> Drug.Add_NA <span class="sc">+</span> Prev.preg, </span>
<span id="cb168-4"><a href="computer-practical-1---missing-data.html#cb168-4" tabindex="-1"></a>  <span class="at">data =</span> <span class="fu">nabular</span>(opt_tmp),</span>
<span id="cb168-5"><a href="computer-practical-1---missing-data.html#cb168-5" tabindex="-1"></a>  <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">&quot;logit&quot;</span>)) </span>
<span id="cb168-6"><a href="computer-practical-1---missing-data.html#cb168-6" tabindex="-1"></a><span class="fu">summary</span>(glm_opt_BMI_NA)</span></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = BMI_NA ~ Clinic + Group + Age + Education + Public.Asstce + 
##     Hypertension + Diabetes + Use.Tob_NA + Use.Alc_NA + Drug.Add_NA + 
##     Prev.preg, family = binomial(link = &quot;logit&quot;), data = nabular(opt_tmp))
## 
## Coefficients:
##                      Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)        -3.493e+00  8.286e-01  -4.215 2.49e-05 ***
## ClinicMN            2.307e-01  5.472e-01   0.422   0.6733    
## ClinicMS           -1.582e+01  7.547e+02  -0.021   0.9833    
## ClinicNY            2.825e+00  4.740e-01   5.960 2.52e-09 ***
## GroupT              1.310e-01  2.800e-01   0.468   0.6398    
## Age                -4.480e-03  2.613e-02  -0.171   0.8639    
## EducationLT 8 yrs   6.498e-01  3.462e-01   1.877   0.0605 .  
## EducationMT 12 yrs  2.335e-01  3.705e-01   0.630   0.5286    
## Public.AsstceYes   -2.047e-01  3.006e-01  -0.681   0.4959    
## HypertensionY      -1.563e+01  1.824e+03  -0.009   0.9932    
## DiabetesYes        -1.527e+01  1.945e+03  -0.008   0.9937    
## Use.Tob_NANA        1.737e+01  1.532e+04   0.001   0.9991    
## Use.Alc_NANA       -3.129e+00  1.091e+04   0.000   0.9998    
## Drug.Add_NANA      -1.604e+01  1.075e+04  -0.001   0.9988    
## Prev.pregYes        7.120e-02  3.553e-01   0.200   0.8412    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 493.01  on 822  degrees of freedom
## Residual deviance: 343.93  on 808  degrees of freedom
## AIC: 373.93
## 
## Number of Fisher Scoring iterations: 18</code></pre>
<p>From these three models it appears that BMI is much more likely to be missing for those from the NY clinic (we already knew this from our previous investigations!):</p>
<div class="sourceCode" id="cb170"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb170-1"><a href="computer-practical-1---missing-data.html#cb170-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span><span class="fu">nabular</span>(opt_tmp), <span class="fu">aes</span>(<span class="at">x=</span>Clinic, <span class="at">fill =</span> BMI_NA)) <span class="sc">+</span></span>
<span id="cb170-2"><a href="computer-practical-1---missing-data.html#cb170-2" tabindex="-1"></a>  <span class="fu">geom_bar</span>()</span></code></pre></div>
<p><img src="CT4H_notes_files/figure-html/unnamed-chunk-179-1.png" width="672" /></p>
<p>Perhaps the most concerning missing data in the <code>opt</code> dataset is in the outcome <code>Birthweight</code>.</p>
<div class="sourceCode" id="cb171"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb171-1"><a href="computer-practical-1---missing-data.html#cb171-1" tabindex="-1"></a>glm_opt_BW_allvar <span class="ot">=</span> <span class="fu">glm</span>(</span>
<span id="cb171-2"><a href="computer-practical-1---missing-data.html#cb171-2" tabindex="-1"></a>  Birthweight_NA <span class="sc">~</span> Clinic <span class="sc">+</span> Group <span class="sc">+</span> Age <span class="sc">+</span>  </span>
<span id="cb171-3"><a href="computer-practical-1---missing-data.html#cb171-3" tabindex="-1"></a>    Education <span class="sc">+</span> Public.Asstce <span class="sc">+</span> Hypertension <span class="sc">+</span> Diabetes <span class="sc">+</span> BMI <span class="sc">+</span> Use.Tob <span class="sc">+</span> Use.Alc <span class="sc">+</span> Drug.Add <span class="sc">+</span> Prev.preg, </span>
<span id="cb171-4"><a href="computer-practical-1---missing-data.html#cb171-4" tabindex="-1"></a>  <span class="at">data =</span> <span class="fu">nabular</span>(opt_tmp),</span>
<span id="cb171-5"><a href="computer-practical-1---missing-data.html#cb171-5" tabindex="-1"></a>  <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">&quot;logit&quot;</span>)) </span>
<span id="cb171-6"><a href="computer-practical-1---missing-data.html#cb171-6" tabindex="-1"></a><span class="fu">summary</span>(glm_opt_BW_allvar)</span></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = Birthweight_NA ~ Clinic + Group + Age + Education + 
##     Public.Asstce + Hypertension + Diabetes + BMI + Use.Tob + 
##     Use.Alc + Drug.Add + Prev.preg, family = binomial(link = &quot;logit&quot;), 
##     data = nabular(opt_tmp))
## 
## Coefficients:
##                      Estimate Std. Error z value Pr(&gt;|z|)
## (Intercept)            33.729  16752.867   0.002    0.998
## ClinicMN             -133.713  20792.481  -0.006    0.995
## ClinicMS             -103.928  39728.644  -0.003    0.998
## ClinicNY              137.894  40148.666   0.003    0.997
## GroupT                -85.621   6320.331  -0.014    0.989
## Age                   -14.213    877.730  -0.016    0.987
## EducationLT 8 yrs      38.459  39853.578   0.001    0.999
## EducationMT 12 yrs    234.150  38187.193   0.006    0.995
## Public.AsstceYes     -196.390  12389.447  -0.016    0.987
## HypertensionY          37.256  48814.207   0.001    0.999
## DiabetesYes           424.730  25942.553   0.016    0.987
## BMI                     2.829    615.616   0.005    0.996
## Use.TobYes            -41.710  44071.964  -0.001    0.999
## Use.AlcYes             26.362  75102.687   0.000    1.000
## Drug.AddYes           369.274 101563.415   0.004    0.997
## Prev.pregYes         -152.840   9926.365  -0.015    0.988
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 3.8896e+01  on 722  degrees of freedom
## Residual deviance: 9.5715e-07  on 707  degrees of freedom
##   (100 observations deleted due to missingness)
## AIC: 32
## 
## Number of Fisher Scoring iterations: 25</code></pre>
<div class="sourceCode" id="cb173"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb173-1"><a href="computer-practical-1---missing-data.html#cb173-1" tabindex="-1"></a>glm_opt_BW_comp <span class="ot">=</span> <span class="fu">glm</span>(</span>
<span id="cb173-2"><a href="computer-practical-1---missing-data.html#cb173-2" tabindex="-1"></a>  Birthweight_NA <span class="sc">~</span> Clinic <span class="sc">+</span> Group <span class="sc">+</span> Age <span class="sc">+</span>  </span>
<span id="cb173-3"><a href="computer-practical-1---missing-data.html#cb173-3" tabindex="-1"></a>    Education <span class="sc">+</span> Public.Asstce <span class="sc">+</span> Hypertension <span class="sc">+</span> Diabetes <span class="sc">+</span> Prev.preg, </span>
<span id="cb173-4"><a href="computer-practical-1---missing-data.html#cb173-4" tabindex="-1"></a>  <span class="at">data =</span> <span class="fu">nabular</span>(opt_tmp),</span>
<span id="cb173-5"><a href="computer-practical-1---missing-data.html#cb173-5" tabindex="-1"></a>  <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">&quot;logit&quot;</span>)) </span>
<span id="cb173-6"><a href="computer-practical-1---missing-data.html#cb173-6" tabindex="-1"></a><span class="fu">summary</span>(glm_opt_BW_comp)</span></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = Birthweight_NA ~ Clinic + Group + Age + Education + 
##     Public.Asstce + Hypertension + Diabetes + Prev.preg, family = binomial(link = &quot;logit&quot;), 
##     data = nabular(opt_tmp))
## 
## Coefficients:
##                      Estimate Std. Error z value Pr(&gt;|z|)  
## (Intercept)          -2.39389    1.55326  -1.541   0.1233  
## ClinicMN            -17.39271 1787.56149  -0.010   0.9922  
## ClinicMS             -1.66204    1.20073  -1.384   0.1663  
## ClinicNY              1.24364    0.72519   1.715   0.0864 .
## GroupT               -0.11738    0.56324  -0.208   0.8349  
## Age                  -0.04719    0.05873  -0.804   0.4217  
## EducationLT 8 yrs    -0.87213    1.07459  -0.812   0.4170  
## EducationMT 12 yrs    0.35302    0.66105   0.534   0.5933  
## Public.AsstceYes     -0.18665    0.66256  -0.282   0.7782  
## HypertensionY       -16.92650 5484.29344  -0.003   0.9975  
## DiabetesYes           2.48332    1.25710   1.975   0.0482 *
## Prev.pregYes         -0.49570    0.62136  -0.798   0.4250  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 141.83  on 822  degrees of freedom
## Residual deviance: 116.01  on 811  degrees of freedom
## AIC: 140.01
## 
## Number of Fisher Scoring iterations: 20</code></pre>
<div class="sourceCode" id="cb175"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb175-1"><a href="computer-practical-1---missing-data.html#cb175-1" tabindex="-1"></a>glm_opt_BW_NA <span class="ot">=</span> <span class="fu">glm</span>(</span>
<span id="cb175-2"><a href="computer-practical-1---missing-data.html#cb175-2" tabindex="-1"></a>  Birthweight_NA <span class="sc">~</span> Clinic <span class="sc">+</span> Group <span class="sc">+</span> Age <span class="sc">+</span>  </span>
<span id="cb175-3"><a href="computer-practical-1---missing-data.html#cb175-3" tabindex="-1"></a>    Education <span class="sc">+</span> Public.Asstce <span class="sc">+</span> Hypertension <span class="sc">+</span> Diabetes <span class="sc">+</span> BMI_NA <span class="sc">+</span> Use.Tob_NA <span class="sc">+</span> Use.Alc_NA <span class="sc">+</span> Drug.Add_NA <span class="sc">+</span> Prev.preg, </span>
<span id="cb175-4"><a href="computer-practical-1---missing-data.html#cb175-4" tabindex="-1"></a>  <span class="at">data =</span> <span class="fu">nabular</span>(opt_tmp),</span>
<span id="cb175-5"><a href="computer-practical-1---missing-data.html#cb175-5" tabindex="-1"></a>  <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">&quot;logit&quot;</span>)) </span>
<span id="cb175-6"><a href="computer-practical-1---missing-data.html#cb175-6" tabindex="-1"></a><span class="fu">summary</span>(glm_opt_BW_NA)</span></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = Birthweight_NA ~ Clinic + Group + Age + Education + 
##     Public.Asstce + Hypertension + Diabetes + BMI_NA + Use.Tob_NA + 
##     Use.Alc_NA + Drug.Add_NA + Prev.preg, family = binomial(link = &quot;logit&quot;), 
##     data = nabular(opt_tmp))
## 
## Coefficients:
##                      Estimate Std. Error z value Pr(&gt;|z|)  
## (Intercept)        -2.018e+00  2.652e+00  -0.761   0.4465  
## ClinicMN           -2.355e+01  2.073e+03  -0.011   0.9909  
## ClinicMS           -3.526e+00  2.002e+00  -1.761   0.0782 .
## ClinicNY           -2.028e-01  1.090e+00  -0.186   0.8524  
## GroupT              3.653e-01  9.552e-01   0.382   0.7021  
## Age                -2.149e-01  1.176e-01  -1.827   0.0677 .
## EducationLT 8 yrs   1.192e+00  1.840e+00   0.648   0.5170  
## EducationMT 12 yrs  4.508e+00  2.026e+00   2.225   0.0261 *
## Public.AsstceYes   -1.239e+00  1.108e+00  -1.118   0.2638  
## HypertensionY      -2.131e+01  7.405e+03  -0.003   0.9977  
## DiabetesYes         4.688e+00  1.901e+00   2.466   0.0137 *
## BMI_NANA           -2.385e-01  1.384e+00  -0.172   0.8632  
## Use.Tob_NANA       -1.047e+01  6.859e+04   0.000   0.9999  
## Use.Alc_NANA        8.377e+00  4.876e+04   0.000   0.9999  
## Drug.Add_NANA       1.078e+01  4.824e+04   0.000   0.9998  
## Prev.pregYes       -9.335e-02  9.792e-01  -0.095   0.9240  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 141.830  on 822  degrees of freedom
## Residual deviance:  42.686  on 807  degrees of freedom
## AIC: 74.686
## 
## Number of Fisher Scoring iterations: 21</code></pre>
<p>It appears from this that missing valuse of Birthweight aren’t associated with missingness in the other variables. Birthweight is more likely to be missing for patients with diabetes.</p>
<div class="sourceCode" id="cb177"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb177-1"><a href="computer-practical-1---missing-data.html#cb177-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> <span class="fu">nabular</span>(opt_tmp), <span class="fu">aes</span>(<span class="at">x=</span>Diabetes, <span class="at">fill =</span> Birthweight_NA)) <span class="sc">+</span></span>
<span id="cb177-2"><a href="computer-practical-1---missing-data.html#cb177-2" tabindex="-1"></a>  <span class="fu">geom_bar</span>()</span></code></pre></div>
<p><img src="CT4H_notes_files/figure-html/unnamed-chunk-183-1.png" width="672" /></p>
</div>
</details>
</div>
</div>
<div id="what-to-do-about-missing-data" class="section level2 hasAnchor" number="9.4">
<h2><span class="header-section-number">A.4</span> What to do about missing data?!<a href="computer-practical-1---missing-data.html#what-to-do-about-missing-data" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Having established that missing data can be a problem, we now need to do something about it. Methods for handling missing data fall into one of two categories:</p>
<ol style="list-style-type: decimal">
<li>Discard some (non-missing) data</li>
<li>Add in (‘impute’) some synthetic data</li>
</ol>
<p>We’ll look at a few versions of these methods now, and use them on our practice datasets.</p>
<div id="discarding-some-non-missing-data" class="section level3 hasAnchor" number="9.4.1">
<h3><span class="header-section-number">A.4.1</span> Discarding some (non-missing) data<a href="computer-practical-1---missing-data.html#discarding-some-non-missing-data" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="complete-case-analysis" class="section level4 hasAnchor" number="9.4.1.1">
<h4><span class="header-section-number">A.4.1.1</span> Complete case analysis<a href="computer-practical-1---missing-data.html#complete-case-analysis" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The very simplest thing we can do is to discard the data for any participant who has some missing data. This is called a <strong>complete-case</strong> analysis, because we only analyse data for participants whose data are complete.</p>
<p>There are two main problems with this:</p>
<ul>
<li>If the missing data are <strong>not</strong> MCAR, then this can induce bias.</li>
<li>This approach can drastically reduce the amount of data</li>
</ul>
<div class="exercise">
<p><span id="exr:unlabeled-div-64" class="exercise"><strong>Exercise A.9  </strong></span>For each of our datasets, how many complete cases are there? Would you recommend a complete case analysis for any of these datasets?
<em>Hint: you can use <code>na.omit</code> to remove all rows with at least one <code>NA</code> from a data frame</em>.</p>
</div>
<details>
<summary>
Click for solution
</summary>
<div class="solution">
<p><span id="unlabeled-div-65" class="solution"><em>Solution</em>. </span>All we need to do is find the number of complete rows in each dataset, and compare it to the number of participants.</p>
<div class="sourceCode" id="cb178"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb178-1"><a href="computer-practical-1---missing-data.html#cb178-1" tabindex="-1"></a><span class="fu">nrow</span>(<span class="fu">na.omit</span>(sup_df))</span></code></pre></div>
<pre><code>## [1] 100</code></pre>
<div class="sourceCode" id="cb180"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb180-1"><a href="computer-practical-1---missing-data.html#cb180-1" tabindex="-1"></a><span class="fu">nrow</span>(sup_df)</span></code></pre></div>
<pre><code>## [1] 103</code></pre>
<p>If we perform a complete case analysis on the <code>sup_df</code> data, we lose data from three participants.</p>
<div class="sourceCode" id="cb182"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb182-1"><a href="computer-practical-1---missing-data.html#cb182-1" tabindex="-1"></a><span class="fu">nrow</span>(<span class="fu">na.omit</span>(smdi_data))</span></code></pre></div>
<pre><code>## [1] 795</code></pre>
<div class="sourceCode" id="cb184"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb184-1"><a href="computer-practical-1---missing-data.html#cb184-1" tabindex="-1"></a><span class="fu">nrow</span>(smdi_data)</span></code></pre></div>
<pre><code>## [1] 2500</code></pre>
<p>A complete case analysis of the <code>smdi_data</code> would leave us with only 795 (about 32%!) of the participants.</p>
<div class="sourceCode" id="cb186"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb186-1"><a href="computer-practical-1---missing-data.html#cb186-1" tabindex="-1"></a><span class="fu">nrow</span>(<span class="fu">na.omit</span>(opt_tmp))</span></code></pre></div>
<pre><code>## [1] 720</code></pre>
<div class="sourceCode" id="cb188"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb188-1"><a href="computer-practical-1---missing-data.html#cb188-1" tabindex="-1"></a><span class="fu">nrow</span>(opt_tmp)</span></code></pre></div>
<pre><code>## [1] 823</code></pre>
<p>If we use a complete case analysis on <code>opt_tmp</code> (remember we’re ignoring some of the most missing variables for now!) we’d lose 113 cases (out of 823).</p>
</div>
</details>
<p>There are some other methods that involve discarding some data, but for the remainder of this practical we’ll focus on methods that involve imputing synthetic data.</p>
</div>
</div>
<div id="imputing-data" class="section level3 hasAnchor" number="9.4.2">
<h3><span class="header-section-number">A.4.2</span> Imputing data<a href="computer-practical-1---missing-data.html#imputing-data" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In order to keep all the data we have, even for those cases with some missing variables, we will need to impute (add in) some new data. Let’s assume we have no way of actually measuring the true value now, and our only option is to choose some value that seems appropriate.</p>
<p>One of our main reasons for imputing data is to avoid the bias that would result from discarding incomplete cases, but we could inadvertently introduce bias if we aren’t careful (or if we are careful and unlucky) while imputing synthetic data.</p>
<p>We’ll look at a few methods, ranging from the very simple to the moderately complex.</p>
<div id="mean-imputation" class="section level4 hasAnchor" number="9.4.2.1">
<h4><span class="header-section-number">A.4.2.1</span> Mean imputation<a href="computer-practical-1---missing-data.html#mean-imputation" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>In this method we simply replace each missing value by the mean of the observed values for that variable. This method is not uncommon in practice, but it can have a number of undesirable effects:</p>
<ul>
<li>If the data are not MCAR, bias is introduced</li>
<li>The sample standard deviation is reduced</li>
<li>Relationships between this and other variables are distorted</li>
</ul>
</div>
<div id="imputing-using-logic" class="section level4 hasAnchor" number="9.4.2.2">
<h4><span class="header-section-number">A.4.2.2</span> Imputing using logic<a href="computer-practical-1---missing-data.html#imputing-using-logic" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Sometimes there is missingness in a dataset that we can fill in using information about how that variable relates to other variables. For example, in the <code>opt</code> data, consider the two columns <code>Use.Tob</code> and <code>BL.Cig.Day</code>:</p>
<p><strong>Use.Tob</strong>: Self-reported participant history of tobacco use, factor; Yes, No; Blank = Missing</p>
<p><strong>BL.Cig.Day</strong>: Self-reported number of cigarettes per day for those with tobacco use history, numeric, range: 1-30; Blank = Missing (variable 16= Yes or blank) or non-smoker (variable 16 = No)`</p>
<p>The first, <code>Use.Tob</code>, is a binary variable indicating whether or not the participant uses tobacco. The second, <code>BL.Cig.Day</code> is a numerical variable indicating how many cigarettes per day the participant smokes. As the data are now, there are a lot of missing values for <code>BL.Cig.Day</code>. However, if for a particular participant we have <code>Use.Tob = No</code> then we know that <code>BL.Cig.Day</code> is zero, and we can impute that value.</p>
<div class="exercise">
<p><span id="exr:unlabeled-div-66" class="exercise"><strong>Exercise A.10  </strong></span>Using the information in the help file, impute values for the columns <code>BL.Cig.Day</code>, <code>BL.Drks.Day</code> and <code>N.prev.preg</code> in the <code>opt_df</code> data. Make a new version of <code>opt_df</code> so that we can compare before and after.</p>
<p><strong>Note the annoying space in some of the responses - often we have <code>"No "</code>!</strong></p>
</div>
<details>
<summary>
Click for solution
</summary>
<div class="solution">
<p><span id="unlabeled-div-67" class="solution"><em>Solution</em>. </span>One important thing to remember is that if the associated categorical variable is missing, then the value for the variable we’re imputing will also be missing. We therefore need to condition on the ‘parent’ variable, rather than replace all missing values of the ‘child’ variable. For example:</p>
<div class="sourceCode" id="cb190"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb190-1"><a href="computer-practical-1---missing-data.html#cb190-1" tabindex="-1"></a>opt_df_imp <span class="ot">=</span> opt_df</span>
<span id="cb190-2"><a href="computer-practical-1---missing-data.html#cb190-2" tabindex="-1"></a>opt_df_imp<span class="sc">$</span>BL.Cig.Day[opt_df_imp<span class="sc">$</span>Use.Tob<span class="sc">==</span><span class="st">&quot;No &quot;</span>] <span class="ot">=</span> <span class="dv">0</span></span></code></pre></div>
<p>By doing this we have ‘fixed’ 704 missing values.</p>
<p>Similarly we cand fix those for <code>BL.Drks.Day</code> and <code>N.prev.preg</code>:</p>
<div class="sourceCode" id="cb191"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb191-1"><a href="computer-practical-1---missing-data.html#cb191-1" tabindex="-1"></a>opt_df_imp<span class="sc">$</span>BL.Drks.Day[opt_df_imp<span class="sc">$</span>Use.Alc<span class="sc">==</span><span class="st">&quot;No &quot;</span>] <span class="ot">=</span> <span class="dv">0</span></span>
<span id="cb191-2"><a href="computer-practical-1---missing-data.html#cb191-2" tabindex="-1"></a>opt_df_imp<span class="sc">$</span>N.prev.preg[opt_df_imp<span class="sc">$</span>Prev.preg<span class="sc">==</span><span class="st">&quot;No &quot;</span>] <span class="ot">=</span> <span class="dv">0</span></span></code></pre></div>
<p>We can see that this has very much improved our situation! We could do something similar for <code>BL.Diab.Type</code> too since this is linked to <code>Diabetes</code>.</p>
<div class="sourceCode" id="cb192"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb192-1"><a href="computer-practical-1---missing-data.html#cb192-1" tabindex="-1"></a><span class="fu">vis_dat</span>(opt_df, <span class="at">sort_type =</span> F)</span></code></pre></div>
<p><img src="CT4H_notes_files/figure-html/unnamed-chunk-189-1.png" width="672" /></p>
<div class="sourceCode" id="cb193"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb193-1"><a href="computer-practical-1---missing-data.html#cb193-1" tabindex="-1"></a><span class="fu">vis_dat</span>(opt_df_imp, <span class="at">sort_type =</span> F)</span></code></pre></div>
<p><img src="CT4H_notes_files/figure-html/unnamed-chunk-189-2.png" width="672" /></p>
</div>
</details>
</div>
<div id="imputation-using-a-regression-model" class="section level4 hasAnchor" number="9.4.2.3">
<h4><span class="header-section-number">A.4.2.3</span> Imputation using a regression model<a href="computer-practical-1---missing-data.html#imputation-using-a-regression-model" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="technique">
<p>In this section we’re going to use the STAN regression functions from the package <code>rstanarm</code>. The syntax is very similar to the base R regression and glm functions, but random sampling is much simpler. The <code>rstanarm</code> functions use MCMC to generate samples from the posterior distribution of the regression model. There is a lot of output about chains (which you can ignore, in this practical). There are no p-values associated with coefficients,</p>
</div>
<p>We’ve already looked at using logistic regression to understand patterns of missingness, and so it may not come as a surprise that we can use regression models to choose appropriate values for imputation. This won’t be the same model, since we’re now interested in the <em>value</em>, rather than the missingness. Which type of regression model we use depends on the type of the variable we’re imputing values for. If the variable is continuous, linear regression is likely to work well. If the variable is binary, we should try logistic regression. There are plenty of other types of model we could use (as well as a whole host of machine learning type models!) but in this practical we’ll stick to those two.</p>
<p>Let’s suppose we want to use regression to impute values for <code>pdl1_num</code></p>
<div class="sourceCode" id="cb194"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb194-1"><a href="computer-practical-1---missing-data.html#cb194-1" tabindex="-1"></a>pdl1_lm <span class="ot">=</span> <span class="fu">stan_glm</span>(</span>
<span id="cb194-2"><a href="computer-practical-1---missing-data.html#cb194-2" tabindex="-1"></a>  pdl1_num <span class="sc">~</span> exposure <span class="sc">+</span> age_num <span class="sc">+</span> female_cat <span class="sc">+</span> smoking_cat <span class="sc">+</span> physical_cat <span class="sc">+</span> alk_cat <span class="sc">+</span> </span>
<span id="cb194-3"><a href="computer-practical-1---missing-data.html#cb194-3" tabindex="-1"></a>    histology_cat <span class="sc">+</span> ses_cat <span class="sc">+</span> copd_cat <span class="sc">+</span> eventtime <span class="sc">+</span> status <span class="sc">+</span> ecog_cat <span class="sc">+</span> egfr_cat, </span>
<span id="cb194-4"><a href="computer-practical-1---missing-data.html#cb194-4" tabindex="-1"></a>  <span class="at">data =</span> smdi_data</span>
<span id="cb194-5"><a href="computer-practical-1---missing-data.html#cb194-5" tabindex="-1"></a>  )</span></code></pre></div>
<pre><code>## 
## SAMPLING FOR MODEL &#39;continuous&#39; NOW (CHAIN 1).
## Chain 1: 
## Chain 1: Gradient evaluation took 0.00071 seconds
## Chain 1: 1000 transitions using 10 leapfrog steps per transition would take 7.1 seconds.
## Chain 1: Adjust your expectations accordingly!
## Chain 1: 
## Chain 1: 
## Chain 1: Iteration:    1 / 2000 [  0%]  (Warmup)
## Chain 1: Iteration:  200 / 2000 [ 10%]  (Warmup)
## Chain 1: Iteration:  400 / 2000 [ 20%]  (Warmup)
## Chain 1: Iteration:  600 / 2000 [ 30%]  (Warmup)
## Chain 1: Iteration:  800 / 2000 [ 40%]  (Warmup)
## Chain 1: Iteration: 1000 / 2000 [ 50%]  (Warmup)
## Chain 1: Iteration: 1001 / 2000 [ 50%]  (Sampling)
## Chain 1: Iteration: 1200 / 2000 [ 60%]  (Sampling)
## Chain 1: Iteration: 1400 / 2000 [ 70%]  (Sampling)
## Chain 1: Iteration: 1600 / 2000 [ 80%]  (Sampling)
## Chain 1: Iteration: 1800 / 2000 [ 90%]  (Sampling)
## Chain 1: Iteration: 2000 / 2000 [100%]  (Sampling)
## Chain 1: 
## Chain 1:  Elapsed Time: 0.063 seconds (Warm-up)
## Chain 1:                0.097 seconds (Sampling)
## Chain 1:                0.16 seconds (Total)
## Chain 1: 
## 
## SAMPLING FOR MODEL &#39;continuous&#39; NOW (CHAIN 2).
## Chain 2: 
## Chain 2: Gradient evaluation took 6e-06 seconds
## Chain 2: 1000 transitions using 10 leapfrog steps per transition would take 0.06 seconds.
## Chain 2: Adjust your expectations accordingly!
## Chain 2: 
## Chain 2: 
## Chain 2: Iteration:    1 / 2000 [  0%]  (Warmup)
## Chain 2: Iteration:  200 / 2000 [ 10%]  (Warmup)
## Chain 2: Iteration:  400 / 2000 [ 20%]  (Warmup)
## Chain 2: Iteration:  600 / 2000 [ 30%]  (Warmup)
## Chain 2: Iteration:  800 / 2000 [ 40%]  (Warmup)
## Chain 2: Iteration: 1000 / 2000 [ 50%]  (Warmup)
## Chain 2: Iteration: 1001 / 2000 [ 50%]  (Sampling)
## Chain 2: Iteration: 1200 / 2000 [ 60%]  (Sampling)
## Chain 2: Iteration: 1400 / 2000 [ 70%]  (Sampling)
## Chain 2: Iteration: 1600 / 2000 [ 80%]  (Sampling)
## Chain 2: Iteration: 1800 / 2000 [ 90%]  (Sampling)
## Chain 2: Iteration: 2000 / 2000 [100%]  (Sampling)
## Chain 2: 
## Chain 2:  Elapsed Time: 0.05 seconds (Warm-up)
## Chain 2:                0.096 seconds (Sampling)
## Chain 2:                0.146 seconds (Total)
## Chain 2: 
## 
## SAMPLING FOR MODEL &#39;continuous&#39; NOW (CHAIN 3).
## Chain 3: 
## Chain 3: Gradient evaluation took 4e-06 seconds
## Chain 3: 1000 transitions using 10 leapfrog steps per transition would take 0.04 seconds.
## Chain 3: Adjust your expectations accordingly!
## Chain 3: 
## Chain 3: 
## Chain 3: Iteration:    1 / 2000 [  0%]  (Warmup)
## Chain 3: Iteration:  200 / 2000 [ 10%]  (Warmup)
## Chain 3: Iteration:  400 / 2000 [ 20%]  (Warmup)
## Chain 3: Iteration:  600 / 2000 [ 30%]  (Warmup)
## Chain 3: Iteration:  800 / 2000 [ 40%]  (Warmup)
## Chain 3: Iteration: 1000 / 2000 [ 50%]  (Warmup)
## Chain 3: Iteration: 1001 / 2000 [ 50%]  (Sampling)
## Chain 3: Iteration: 1200 / 2000 [ 60%]  (Sampling)
## Chain 3: Iteration: 1400 / 2000 [ 70%]  (Sampling)
## Chain 3: Iteration: 1600 / 2000 [ 80%]  (Sampling)
## Chain 3: Iteration: 1800 / 2000 [ 90%]  (Sampling)
## Chain 3: Iteration: 2000 / 2000 [100%]  (Sampling)
## Chain 3: 
## Chain 3:  Elapsed Time: 0.056 seconds (Warm-up)
## Chain 3:                0.096 seconds (Sampling)
## Chain 3:                0.152 seconds (Total)
## Chain 3: 
## 
## SAMPLING FOR MODEL &#39;continuous&#39; NOW (CHAIN 4).
## Chain 4: 
## Chain 4: Gradient evaluation took 4e-06 seconds
## Chain 4: 1000 transitions using 10 leapfrog steps per transition would take 0.04 seconds.
## Chain 4: Adjust your expectations accordingly!
## Chain 4: 
## Chain 4: 
## Chain 4: Iteration:    1 / 2000 [  0%]  (Warmup)
## Chain 4: Iteration:  200 / 2000 [ 10%]  (Warmup)
## Chain 4: Iteration:  400 / 2000 [ 20%]  (Warmup)
## Chain 4: Iteration:  600 / 2000 [ 30%]  (Warmup)
## Chain 4: Iteration:  800 / 2000 [ 40%]  (Warmup)
## Chain 4: Iteration: 1000 / 2000 [ 50%]  (Warmup)
## Chain 4: Iteration: 1001 / 2000 [ 50%]  (Sampling)
## Chain 4: Iteration: 1200 / 2000 [ 60%]  (Sampling)
## Chain 4: Iteration: 1400 / 2000 [ 70%]  (Sampling)
## Chain 4: Iteration: 1600 / 2000 [ 80%]  (Sampling)
## Chain 4: Iteration: 1800 / 2000 [ 90%]  (Sampling)
## Chain 4: Iteration: 2000 / 2000 [100%]  (Sampling)
## Chain 4: 
## Chain 4:  Elapsed Time: 0.056 seconds (Warm-up)
## Chain 4:                0.098 seconds (Sampling)
## Chain 4:                0.154 seconds (Total)
## Chain 4:</code></pre>
<div class="sourceCode" id="cb196"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb196-1"><a href="computer-practical-1---missing-data.html#cb196-1" tabindex="-1"></a><span class="fu">summary</span>(pdl1_lm)</span></code></pre></div>
<pre><code>## 
## Model Info:
##  function:     stan_glm
##  family:       gaussian [identity]
##  formula:      pdl1_num ~ exposure + age_num + female_cat + smoking_cat + physical_cat + 
##     alk_cat + histology_cat + ses_cat + copd_cat + eventtime + 
##     status + ecog_cat + egfr_cat
##  algorithm:    sampling
##  sample:       4000 (posterior sample size)
##  priors:       see help(&#39;prior_summary&#39;)
##  observations: 795
##  predictors:   15
## 
## Estimates:
##                   mean   sd    10%   50%   90%
## (Intercept)      36.9    2.7  33.4  36.8  40.5
## exposure          8.8    0.7   7.9   8.8   9.7
## age_num           0.1    0.0   0.0   0.1   0.1
## female_cat1      -0.9    0.7  -1.8  -0.9   0.0
## smoking_cat1     -0.6    0.8  -1.6  -0.6   0.4
## physical_cat1    -0.8    0.8  -1.8  -0.8   0.2
## alk_cat1         -4.7    5.5 -11.9  -4.7   2.4
## histology_cat1    0.4    1.0  -0.8   0.4   1.7
## ses_cat2_middle   0.7    0.9  -0.5   0.6   1.8
## ses_cat3_high     1.0    0.9  -0.1   1.0   2.2
## copd_cat1         0.6    0.8  -0.4   0.6   1.6
## eventtime         0.5    0.3   0.1   0.5   1.0
## status1          -1.7    1.4  -3.5  -1.7   0.2
## ecog_cat1         0.4    0.7  -0.5   0.4   1.3
## egfr_cat1        -1.5    0.9  -2.7  -1.4  -0.3
## sigma             9.4    0.2   9.1   9.4   9.7
## 
## Fit Diagnostics:
##            mean   sd   10%   50%   90%
## mean_PPD 44.4    0.5 43.8  44.4  45.0 
## 
## The mean_ppd is the sample average posterior predictive distribution of the outcome variable (for details see help(&#39;summary.stanreg&#39;)).
## 
## MCMC diagnostics
##                 mcse Rhat n_eff
## (Intercept)     0.0  1.0  4046 
## exposure        0.0  1.0  5843 
## age_num         0.0  1.0  5425 
## female_cat1     0.0  1.0  6996 
## smoking_cat1    0.0  1.0  5452 
## physical_cat1   0.0  1.0  6963 
## alk_cat1        0.1  1.0  6964 
## histology_cat1  0.0  1.0  8206 
## ses_cat2_middle 0.0  1.0  4445 
## ses_cat3_high   0.0  1.0  4443 
## copd_cat1       0.0  1.0  5772 
## eventtime       0.0  1.0  3760 
## status1         0.0  1.0  3807 
## ecog_cat1       0.0  1.0  7711 
## egfr_cat1       0.0  1.0  6011 
## sigma           0.0  1.0  6827 
## mean_PPD        0.0  1.0  4953 
## log-posterior   0.1  1.0  1617 
## 
## For each parameter, mcse is Monte Carlo standard error, n_eff is a crude measure of effective sample size, and Rhat is the potential scale reduction factor on split chains (at convergence Rhat=1).</code></pre>
<div class="exercise">
<p><span id="exr:unlabeled-div-68" class="exercise"><strong>Exercise A.11  </strong></span>This approach is going to fail! Can you tell why? Can you suggest what to do about it?</p>
</div>
<details>
<summary>
Click for solution
</summary>
<div class="solution">
<p><span id="unlabeled-div-69" class="solution"><em>Solution</em>. </span>The model involves variables that also have missingness (<code>ecog_cat1</code> and <code>egfr_cat</code>), and so for any case with either of those missing, we won’t be able to impute a value.</p>
<p>There are a couple of possibilities:</p>
<ul>
<li>Use the missingness of those values as an input (by creating a <code>nabular</code> object)</li>
<li>Remove those variables from the model</li>
<li>Work iteratively, generating temporary imputed values and cycling round the variables with missingness</li>
</ul>
<p>Because all our investigations suggest that <code>ecog_cat1</code> is more-or-less unrelated to anything, we will remove it from the model. However, because <code>egfr_cat</code> is quite close to being significant in the model, we will keep it in but use missingness in the model.</p>
<div class="sourceCode" id="cb198"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb198-1"><a href="computer-practical-1---missing-data.html#cb198-1" tabindex="-1"></a>smdi_nab <span class="ot">=</span> <span class="fu">nabular</span>(smdi_data)</span>
<span id="cb198-2"><a href="computer-practical-1---missing-data.html#cb198-2" tabindex="-1"></a></span>
<span id="cb198-3"><a href="computer-practical-1---missing-data.html#cb198-3" tabindex="-1"></a>pdl1_lm2 <span class="ot">=</span> <span class="fu">stan_glm</span>(</span>
<span id="cb198-4"><a href="computer-practical-1---missing-data.html#cb198-4" tabindex="-1"></a>  pdl1_num <span class="sc">~</span> exposure <span class="sc">+</span> age_num <span class="sc">+</span> female_cat <span class="sc">+</span> smoking_cat <span class="sc">+</span> physical_cat <span class="sc">+</span> alk_cat <span class="sc">+</span> </span>
<span id="cb198-5"><a href="computer-practical-1---missing-data.html#cb198-5" tabindex="-1"></a>    histology_cat <span class="sc">+</span> ses_cat <span class="sc">+</span> copd_cat <span class="sc">+</span> eventtime <span class="sc">+</span> status <span class="sc">+</span> egfr_cat_NA, </span>
<span id="cb198-6"><a href="computer-practical-1---missing-data.html#cb198-6" tabindex="-1"></a>  <span class="at">data =</span> smdi_nab</span>
<span id="cb198-7"><a href="computer-practical-1---missing-data.html#cb198-7" tabindex="-1"></a>  )</span></code></pre></div>
<pre><code>## 
## SAMPLING FOR MODEL &#39;continuous&#39; NOW (CHAIN 1).
## Chain 1: 
## Chain 1: Gradient evaluation took 1.8e-05 seconds
## Chain 1: 1000 transitions using 10 leapfrog steps per transition would take 0.18 seconds.
## Chain 1: Adjust your expectations accordingly!
## Chain 1: 
## Chain 1: 
## Chain 1: Iteration:    1 / 2000 [  0%]  (Warmup)
## Chain 1: Iteration:  200 / 2000 [ 10%]  (Warmup)
## Chain 1: Iteration:  400 / 2000 [ 20%]  (Warmup)
## Chain 1: Iteration:  600 / 2000 [ 30%]  (Warmup)
## Chain 1: Iteration:  800 / 2000 [ 40%]  (Warmup)
## Chain 1: Iteration: 1000 / 2000 [ 50%]  (Warmup)
## Chain 1: Iteration: 1001 / 2000 [ 50%]  (Sampling)
## Chain 1: Iteration: 1200 / 2000 [ 60%]  (Sampling)
## Chain 1: Iteration: 1400 / 2000 [ 70%]  (Sampling)
## Chain 1: Iteration: 1600 / 2000 [ 80%]  (Sampling)
## Chain 1: Iteration: 1800 / 2000 [ 90%]  (Sampling)
## Chain 1: Iteration: 2000 / 2000 [100%]  (Sampling)
## Chain 1: 
## Chain 1:  Elapsed Time: 0.048 seconds (Warm-up)
## Chain 1:                0.159 seconds (Sampling)
## Chain 1:                0.207 seconds (Total)
## Chain 1: 
## 
## SAMPLING FOR MODEL &#39;continuous&#39; NOW (CHAIN 2).
## Chain 2: 
## Chain 2: Gradient evaluation took 1.1e-05 seconds
## Chain 2: 1000 transitions using 10 leapfrog steps per transition would take 0.11 seconds.
## Chain 2: Adjust your expectations accordingly!
## Chain 2: 
## Chain 2: 
## Chain 2: Iteration:    1 / 2000 [  0%]  (Warmup)
## Chain 2: Iteration:  200 / 2000 [ 10%]  (Warmup)
## Chain 2: Iteration:  400 / 2000 [ 20%]  (Warmup)
## Chain 2: Iteration:  600 / 2000 [ 30%]  (Warmup)
## Chain 2: Iteration:  800 / 2000 [ 40%]  (Warmup)
## Chain 2: Iteration: 1000 / 2000 [ 50%]  (Warmup)
## Chain 2: Iteration: 1001 / 2000 [ 50%]  (Sampling)
## Chain 2: Iteration: 1200 / 2000 [ 60%]  (Sampling)
## Chain 2: Iteration: 1400 / 2000 [ 70%]  (Sampling)
## Chain 2: Iteration: 1600 / 2000 [ 80%]  (Sampling)
## Chain 2: Iteration: 1800 / 2000 [ 90%]  (Sampling)
## Chain 2: Iteration: 2000 / 2000 [100%]  (Sampling)
## Chain 2: 
## Chain 2:  Elapsed Time: 0.053 seconds (Warm-up)
## Chain 2:                0.164 seconds (Sampling)
## Chain 2:                0.217 seconds (Total)
## Chain 2: 
## 
## SAMPLING FOR MODEL &#39;continuous&#39; NOW (CHAIN 3).
## Chain 3: 
## Chain 3: Gradient evaluation took 5e-06 seconds
## Chain 3: 1000 transitions using 10 leapfrog steps per transition would take 0.05 seconds.
## Chain 3: Adjust your expectations accordingly!
## Chain 3: 
## Chain 3: 
## Chain 3: Iteration:    1 / 2000 [  0%]  (Warmup)
## Chain 3: Iteration:  200 / 2000 [ 10%]  (Warmup)
## Chain 3: Iteration:  400 / 2000 [ 20%]  (Warmup)
## Chain 3: Iteration:  600 / 2000 [ 30%]  (Warmup)
## Chain 3: Iteration:  800 / 2000 [ 40%]  (Warmup)
## Chain 3: Iteration: 1000 / 2000 [ 50%]  (Warmup)
## Chain 3: Iteration: 1001 / 2000 [ 50%]  (Sampling)
## Chain 3: Iteration: 1200 / 2000 [ 60%]  (Sampling)
## Chain 3: Iteration: 1400 / 2000 [ 70%]  (Sampling)
## Chain 3: Iteration: 1600 / 2000 [ 80%]  (Sampling)
## Chain 3: Iteration: 1800 / 2000 [ 90%]  (Sampling)
## Chain 3: Iteration: 2000 / 2000 [100%]  (Sampling)
## Chain 3: 
## Chain 3:  Elapsed Time: 0.055 seconds (Warm-up)
## Chain 3:                0.161 seconds (Sampling)
## Chain 3:                0.216 seconds (Total)
## Chain 3: 
## 
## SAMPLING FOR MODEL &#39;continuous&#39; NOW (CHAIN 4).
## Chain 4: 
## Chain 4: Gradient evaluation took 4e-06 seconds
## Chain 4: 1000 transitions using 10 leapfrog steps per transition would take 0.04 seconds.
## Chain 4: Adjust your expectations accordingly!
## Chain 4: 
## Chain 4: 
## Chain 4: Iteration:    1 / 2000 [  0%]  (Warmup)
## Chain 4: Iteration:  200 / 2000 [ 10%]  (Warmup)
## Chain 4: Iteration:  400 / 2000 [ 20%]  (Warmup)
## Chain 4: Iteration:  600 / 2000 [ 30%]  (Warmup)
## Chain 4: Iteration:  800 / 2000 [ 40%]  (Warmup)
## Chain 4: Iteration: 1000 / 2000 [ 50%]  (Warmup)
## Chain 4: Iteration: 1001 / 2000 [ 50%]  (Sampling)
## Chain 4: Iteration: 1200 / 2000 [ 60%]  (Sampling)
## Chain 4: Iteration: 1400 / 2000 [ 70%]  (Sampling)
## Chain 4: Iteration: 1600 / 2000 [ 80%]  (Sampling)
## Chain 4: Iteration: 1800 / 2000 [ 90%]  (Sampling)
## Chain 4: Iteration: 2000 / 2000 [100%]  (Sampling)
## Chain 4: 
## Chain 4:  Elapsed Time: 0.066 seconds (Warm-up)
## Chain 4:                0.159 seconds (Sampling)
## Chain 4:                0.225 seconds (Total)
## Chain 4:</code></pre>
<div class="sourceCode" id="cb200"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb200-1"><a href="computer-practical-1---missing-data.html#cb200-1" tabindex="-1"></a><span class="fu">summary</span>(pdl1_lm2)</span></code></pre></div>
<pre><code>## 
## Model Info:
##  function:     stan_glm
##  family:       gaussian [identity]
##  formula:      pdl1_num ~ exposure + age_num + female_cat + smoking_cat + physical_cat + 
##     alk_cat + histology_cat + ses_cat + copd_cat + eventtime + 
##     status + egfr_cat_NA
##  algorithm:    sampling
##  sample:       4000 (posterior sample size)
##  priors:       see help(&#39;prior_summary&#39;)
##  observations: 1983
##  predictors:   14
## 
## Estimates:
##                   mean   sd   10%   50%   90%
## (Intercept)     39.7    1.7 37.6  39.7  41.9 
## exposure         8.0    0.5  7.4   8.0   8.7 
## age_num          0.0    0.0  0.0   0.0   0.1 
## female_cat1     -0.4    0.5 -1.0  -0.4   0.2 
## smoking_cat1    -0.5    0.5 -1.2  -0.5   0.2 
## physical_cat1   -1.5    0.5 -2.2  -1.5  -0.9 
## alk_cat1        -1.8    1.5 -3.7  -1.8   0.2 
## histology_cat1  -0.4    0.6 -1.1  -0.4   0.3 
## ses_cat2_middle  0.1    0.6 -0.7   0.1   0.8 
## ses_cat3_high    1.2    0.6  0.4   1.2   1.9 
## copd_cat1       -0.9    0.5 -1.6  -0.9  -0.2 
## eventtime        0.6    0.2  0.3   0.6   0.8 
## status1         -1.6    0.9 -2.7  -1.6  -0.5 
## egfr_cat_NANA    4.1    0.5  3.4   4.1   4.8 
## sigma            9.8    0.2  9.6   9.8  10.0 
## 
## Fit Diagnostics:
##            mean   sd   10%   50%   90%
## mean_PPD 46.0    0.3 45.6  46.0  46.4 
## 
## The mean_ppd is the sample average posterior predictive distribution of the outcome variable (for details see help(&#39;summary.stanreg&#39;)).
## 
## MCMC diagnostics
##                 mcse Rhat n_eff
## (Intercept)     0.0  1.0  4788 
## exposure        0.0  1.0  5888 
## age_num         0.0  1.0  5881 
## female_cat1     0.0  1.0  6882 
## smoking_cat1    0.0  1.0  5807 
## physical_cat1   0.0  1.0  6488 
## alk_cat1        0.0  1.0  7446 
## histology_cat1  0.0  1.0  6248 
## ses_cat2_middle 0.0  1.0  4656 
## ses_cat3_high   0.0  1.0  4302 
## copd_cat1       0.0  1.0  6487 
## eventtime       0.0  1.0  4531 
## status1         0.0  1.0  4847 
## egfr_cat_NANA   0.0  1.0  5651 
## sigma           0.0  1.0  6860 
## mean_PPD        0.0  1.0  4764 
## log-posterior   0.1  1.0  1358 
## 
## For each parameter, mcse is Monte Carlo standard error, n_eff is a crude measure of effective sample size, and Rhat is the potential scale reduction factor on split chains (at convergence Rhat=1).</code></pre>
<p>We can see from the means and standard deviations that most of the coefficients are not even close to ‘significant’, but if we want to investigate some more closely we can visualise them using the <code>plot</code> function (separately in this case because they are quite far apart numerically)</p>
<div class="sourceCode" id="cb202"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb202-1"><a href="computer-practical-1---missing-data.html#cb202-1" tabindex="-1"></a><span class="fu">plot</span>(pdl1_lm2, <span class="at">plotfun=</span><span class="st">&quot;areas&quot;</span>, <span class="at">prob =</span> <span class="fl">0.95</span>, <span class="at">pars =</span> <span class="fu">c</span>(<span class="st">&quot;exposure&quot;</span>))</span></code></pre></div>
<p><img src="CT4H_notes_files/figure-html/unnamed-chunk-192-1.png" width="672" /></p>
<div class="sourceCode" id="cb203"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb203-1"><a href="computer-practical-1---missing-data.html#cb203-1" tabindex="-1"></a><span class="fu">plot</span>(pdl1_lm2, <span class="at">plotfun=</span><span class="st">&quot;areas&quot;</span>, <span class="at">prob =</span> <span class="fl">0.95</span>, <span class="at">pars =</span> <span class="fu">c</span>(<span class="st">&quot;age_num&quot;</span>))</span></code></pre></div>
<p><img src="CT4H_notes_files/figure-html/unnamed-chunk-192-2.png" width="672" /></p>
<p>We see that for both variables, zero is not in the central 95% of the distribution. This isn’t directly relevant here but it’s nice to know about!</p>
</div>
</details>
<p>We will now use this second model to impute values for <code>pdl1_num</code>.</p>
<div class="sourceCode" id="cb204"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb204-1"><a href="computer-practical-1---missing-data.html#cb204-1" tabindex="-1"></a><span class="do">## Split the data according to whether egfr_cat is missing</span></span>
<span id="cb204-2"><a href="computer-practical-1---missing-data.html#cb204-2" tabindex="-1"></a></span>
<span id="cb204-3"><a href="computer-practical-1---missing-data.html#cb204-3" tabindex="-1"></a>smdi_pdl1_comp <span class="ot">=</span> smdi_nab[<span class="sc">!</span><span class="fu">is.na</span>(smdi_nab<span class="sc">$</span>pdl1_num),]</span>
<span id="cb204-4"><a href="computer-practical-1---missing-data.html#cb204-4" tabindex="-1"></a>smdi_pdl1_miss <span class="ot">=</span> smdi_nab[<span class="fu">is.na</span>(smdi_nab<span class="sc">$</span>pdl1_num),]</span>
<span id="cb204-5"><a href="computer-practical-1---missing-data.html#cb204-5" tabindex="-1"></a></span>
<span id="cb204-6"><a href="computer-practical-1---missing-data.html#cb204-6" tabindex="-1"></a><span class="do">## Use the GLM to fit values to egfr_cat</span></span>
<span id="cb204-7"><a href="computer-practical-1---missing-data.html#cb204-7" tabindex="-1"></a></span>
<span id="cb204-8"><a href="computer-practical-1---missing-data.html#cb204-8" tabindex="-1"></a>pdl1_imp_lm <span class="ot">=</span> <span class="fu">predict</span>(<span class="at">object =</span> pdl1_lm2, </span>
<span id="cb204-9"><a href="computer-practical-1---missing-data.html#cb204-9" tabindex="-1"></a>                      <span class="at">newdata =</span> smdi_pdl1_miss)</span>
<span id="cb204-10"><a href="computer-practical-1---missing-data.html#cb204-10" tabindex="-1"></a>                </span>
<span id="cb204-11"><a href="computer-practical-1---missing-data.html#cb204-11" tabindex="-1"></a>smdi_pdl1_miss<span class="sc">$</span>pdl1_num <span class="ot">=</span> pdl1_imp_lm</span>
<span id="cb204-12"><a href="computer-practical-1---missing-data.html#cb204-12" tabindex="-1"></a></span>
<span id="cb204-13"><a href="computer-practical-1---missing-data.html#cb204-13" tabindex="-1"></a><span class="do">## Join the data back together again (in a different order, but it doesn&#39;t matter)</span></span>
<span id="cb204-14"><a href="computer-practical-1---missing-data.html#cb204-14" tabindex="-1"></a></span>
<span id="cb204-15"><a href="computer-practical-1---missing-data.html#cb204-15" tabindex="-1"></a>smdi_imp <span class="ot">=</span> <span class="fu">rbind</span>(smdi_pdl1_miss, smdi_pdl1_comp)</span></code></pre></div>
<p>This might seem sensible, but actually it isn’t a very realistic use of a regression model.</p>
<p>Compared to the observed values, the imputed values have a strong central tendency. This is because we have imputed the mean fitted value for each point, ignoring the measure of spread / uncertainty in the model. We can see this by comparing the observed values of <code>pdl1_num</code> to their fitted values (which we would have imputed had they been missing).</p>
<div class="sourceCode" id="cb205"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb205-1"><a href="computer-practical-1---missing-data.html#cb205-1" tabindex="-1"></a>smdi_pdl1_comp<span class="sc">$</span>pdl1_imp <span class="ot">=</span> <span class="fu">predict</span>(pdl1_lm2, <span class="at">newdata =</span> smdi_pdl1_comp)</span>
<span id="cb205-2"><a href="computer-practical-1---missing-data.html#cb205-2" tabindex="-1"></a><span class="co"># The next line just recreates the imputataion so that we can bind the datasets together</span></span>
<span id="cb205-3"><a href="computer-practical-1---missing-data.html#cb205-3" tabindex="-1"></a>smdi_pdl1_miss<span class="sc">$</span>pdl1_imp <span class="ot">=</span> <span class="fu">predict</span>(pdl1_lm2, <span class="at">newdata =</span> smdi_pdl1_miss)</span>
<span id="cb205-4"><a href="computer-practical-1---missing-data.html#cb205-4" tabindex="-1"></a></span>
<span id="cb205-5"><a href="computer-practical-1---missing-data.html#cb205-5" tabindex="-1"></a>smdi_pdl1_imp <span class="ot">=</span> <span class="fu">rbind</span>(smdi_pdl1_comp, smdi_pdl1_miss)</span>
<span id="cb205-6"><a href="computer-practical-1---missing-data.html#cb205-6" tabindex="-1"></a></span>
<span id="cb205-7"><a href="computer-practical-1---missing-data.html#cb205-7" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> smdi_pdl1_imp, <span class="fu">aes</span>(<span class="at">x=</span>pdl1_imp, <span class="at">y=</span>pdl1_num, <span class="at">col =</span> pdl1_num_NA)) <span class="sc">+</span> </span>
<span id="cb205-8"><a href="computer-practical-1---missing-data.html#cb205-8" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb205-9"><a href="computer-practical-1---missing-data.html#cb205-9" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Regression fit&quot;</span>) <span class="sc">+</span> </span>
<span id="cb205-10"><a href="computer-practical-1---missing-data.html#cb205-10" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Observed value / imputed value&quot;</span>) <span class="sc">+</span></span>
<span id="cb205-11"><a href="computer-practical-1---missing-data.html#cb205-11" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code></pre></div>
<p><img src="CT4H_notes_files/figure-html/unnamed-chunk-194-1.png" width="672" /></p>
<p>A more realistic approach would be to sample one value from the posterior distribution for each point (this is why we are using <code>rstanarm</code>!)</p>
<div class="sourceCode" id="cb206"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb206-1"><a href="computer-practical-1---missing-data.html#cb206-1" tabindex="-1"></a>smdi_pdl1_comp<span class="sc">$</span>pdl1_imp_rand <span class="ot">=</span> smdi_pdl1_comp<span class="sc">$</span>pdl1_num</span>
<span id="cb206-2"><a href="computer-practical-1---missing-data.html#cb206-2" tabindex="-1"></a></span>
<span id="cb206-3"><a href="computer-practical-1---missing-data.html#cb206-3" tabindex="-1"></a><span class="do">## This time draw one point at random from the posterior distribution for each participant</span></span>
<span id="cb206-4"><a href="computer-practical-1---missing-data.html#cb206-4" tabindex="-1"></a><span class="do">## The output is a 1xdraws matrix, which we&#39;ll convert to a vector</span></span>
<span id="cb206-5"><a href="computer-practical-1---missing-data.html#cb206-5" tabindex="-1"></a>pdl1_rand_draw <span class="ot">=</span> <span class="fu">posterior_predict</span>(pdl1_lm2, <span class="at">newdata =</span> smdi_pdl1_miss, <span class="at">draws=</span><span class="dv">1</span>)</span>
<span id="cb206-6"><a href="computer-practical-1---missing-data.html#cb206-6" tabindex="-1"></a>smdi_pdl1_miss<span class="sc">$</span>pdl1_imp_rand <span class="ot">=</span> <span class="fu">as.numeric</span>(pdl1_rand_draw)</span>
<span id="cb206-7"><a href="computer-practical-1---missing-data.html#cb206-7" tabindex="-1"></a></span>
<span id="cb206-8"><a href="computer-practical-1---missing-data.html#cb206-8" tabindex="-1"></a><span class="do">## Now we can bind the two dataframes together and plot the randomly imputed / observed</span></span>
<span id="cb206-9"><a href="computer-practical-1---missing-data.html#cb206-9" tabindex="-1"></a><span class="do">## data against the deterministically fitted data</span></span>
<span id="cb206-10"><a href="computer-practical-1---missing-data.html#cb206-10" tabindex="-1"></a></span>
<span id="cb206-11"><a href="computer-practical-1---missing-data.html#cb206-11" tabindex="-1"></a>smdi_pdl1_imp <span class="ot">=</span> <span class="fu">rbind</span>(smdi_pdl1_comp, smdi_pdl1_miss)</span>
<span id="cb206-12"><a href="computer-practical-1---missing-data.html#cb206-12" tabindex="-1"></a></span>
<span id="cb206-13"><a href="computer-practical-1---missing-data.html#cb206-13" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> smdi_pdl1_imp, <span class="fu">aes</span>(<span class="at">x=</span>pdl1_imp, <span class="at">y=</span>pdl1_imp_rand, <span class="at">col =</span> pdl1_num_NA)) <span class="sc">+</span> </span>
<span id="cb206-14"><a href="computer-practical-1---missing-data.html#cb206-14" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb206-15"><a href="computer-practical-1---missing-data.html#cb206-15" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Regression fit&quot;</span>) <span class="sc">+</span> </span>
<span id="cb206-16"><a href="computer-practical-1---missing-data.html#cb206-16" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Observed value / randomly imputed value&quot;</span>) <span class="sc">+</span></span>
<span id="cb206-17"><a href="computer-practical-1---missing-data.html#cb206-17" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code></pre></div>
<p><img src="CT4H_notes_files/figure-html/unnamed-chunk-195-1.png" width="672" /></p>
<p>This imputed data looks much more representative of the actual dataset.</p>
<div class="exercise">
<p><span id="exr:unlabeled-div-70" class="exercise"><strong>Exercise A.12  </strong></span>Use regression imputation to impute values for <code>BMI</code> in <code>opt_tmp</code>.</p>
</div>
</div>
</div>
<div id="multiple-imputation" class="section level3 hasAnchor" number="9.4.3">
<h3><span class="header-section-number">A.4.3</span> Multiple imputation<a href="computer-practical-1---missing-data.html#multiple-imputation" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Having reached the point of acknowledging the randomness needed in imputation, a natural next step would be to draw multiple values from the posterior distribution, rather than just one. This leads to a method called <em>multiple imputation</em>, which is (arguably) the most widely used approach to imputing missing data, though sadly we don’t have time to go into it in this practical.</p>

</div>
</div>
</div>
<h3>References</h3>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-gelman2021regression" class="csl-entry">
Gelman, Andrew, Jennifer Hill, and Aki Vehtari. 2021. <em>Regression and Other Stories</em>. Cambridge University Press.
</div>
<div id="ref-hotelling1931generalization" class="csl-entry">
Hotelling, Harold et al. 1931. <span>“The Generalization of Student’s Ratio.”</span>
</div>
<div id="ref-little2019statistical" class="csl-entry">
Little, Roderick JA, and Donald B Rubin. 2019. <em>Statistical Analysis with Missing Data</em>. Vol. 793. John Wiley &amp; Sons.
</div>
<div id="ref-rubin1976inference" class="csl-entry">
Rubin, Donald B. 1976. <span>“Inference and Missing Data.”</span> <em>Biometrika</em> 63 (3): 581–92.
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="comparing-survival-curves.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="computer-practical-2---allocation-analysis.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["CT4H_notes.pdf"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
},
"bookdown": null
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
