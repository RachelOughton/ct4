<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>2 Sample size for a normally distributed primary outcome variable | Clinical Trials 4H</title>
  <meta name="description" content="These notes mirror what we’ll follow in lectures for Clinical Trials 4H. If you have any questions or notice any errors, please email me (Rachel Oughton)." />
  <meta name="generator" content="bookdown 0.42 and GitBook 2.6.7" />

  <meta property="og:title" content="2 Sample size for a normally distributed primary outcome variable | Clinical Trials 4H" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="These notes mirror what we’ll follow in lectures for Clinical Trials 4H. If you have any questions or notice any errors, please email me (Rachel Oughton)." />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="2 Sample size for a normally distributed primary outcome variable | Clinical Trials 4H" />
  
  <meta name="twitter:description" content="These notes mirror what we’ll follow in lectures for Clinical Trials 4H. If you have any questions or notice any errors, please email me (Rachel Oughton)." />
  

<meta name="author" content="Rachel Oughton" />


<meta name="date" content="2025-03-10" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="rct-intro.html"/>
<link rel="next" href="alloc.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<link href="libs/font-awesome-6.5.2/css/all.min.css" rel="stylesheet" />
<link href="libs/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet" />
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<link href="libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="libs/pagedtable-1.1/js/pagedtable.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #204a87; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #8f5902; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #204a87; font-weight: bold; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #ce5c00; font-weight: bold; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Welcome to Clinical Trials 4H!</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#practical-details"><i class="fa fa-check"></i>Practical details</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#lectures"><i class="fa fa-check"></i>Lectures</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#computer-classes"><i class="fa fa-check"></i>Computer classes</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#office-hour"><i class="fa fa-check"></i>Office Hour</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#assessment"><i class="fa fa-check"></i>Assessment</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#books-and-resources"><i class="fa fa-check"></i>Books and resources</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#what-to-expect-from-this-module"><i class="fa fa-check"></i>What to expect from this module</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#what-i-expect-from-you"><i class="fa fa-check"></i>What I expect from you</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="1" data-path="rct-intro.html"><a href="rct-intro.html"><i class="fa fa-check"></i><b>1</b> Introduction to Clinical Trials</a>
<ul>
<li class="chapter" data-level="1.1" data-path="rct-intro.html"><a href="rct-intro.html#causal-inference-and-clinical-trials"><i class="fa fa-check"></i><b>1.1</b> Causal inference and clinical trials</a></li>
<li class="chapter" data-level="1.2" data-path="rct-intro.html"><a href="rct-intro.html#the-structure-of-a-clinical-trial"><i class="fa fa-check"></i><b>1.2</b> The structure of a clinical trial</a>
<ul>
<li class="chapter" data-level="" data-path="rct-intro.html"><a href="rct-intro.html#the-population-of-eligible-patients"><i class="fa fa-check"></i>The population of eligible patients</a></li>
<li class="chapter" data-level="" data-path="rct-intro.html"><a href="rct-intro.html#entry-to-the-trial"><i class="fa fa-check"></i>Entry to the trial</a></li>
<li class="chapter" data-level="" data-path="rct-intro.html"><a href="rct-intro.html#allocation-to-groups"><i class="fa fa-check"></i>Allocation to groups</a></li>
<li class="chapter" data-level="" data-path="rct-intro.html"><a href="rct-intro.html#comparing-results"><i class="fa fa-check"></i>Comparing results</a></li>
<li class="chapter" data-level="" data-path="rct-intro.html"><a href="rct-intro.html#why-bother-with-a-control-group"><i class="fa fa-check"></i>Why bother with a control group?</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="rct-intro.html"><a href="rct-intro.html#primout"><i class="fa fa-check"></i><b>1.3</b> The primary outcome</a></li>
<li class="chapter" data-level="1.4" data-path="rct-intro.html"><a href="rct-intro.html#ethical-issues"><i class="fa fa-check"></i><b>1.4</b> Ethical issues</a></li>
<li class="chapter" data-level="1.5" data-path="rct-intro.html"><a href="rct-intro.html#phases-of-clinical-trials"><i class="fa fa-check"></i><b>1.5</b> Phases of clinical trials</a>
<ul>
<li class="chapter" data-level="" data-path="rct-intro.html"><a href="rct-intro.html#phase-zero"><i class="fa fa-check"></i>Phase zero</a></li>
<li class="chapter" data-level="" data-path="rct-intro.html"><a href="rct-intro.html#phase-one"><i class="fa fa-check"></i>Phase one</a></li>
<li class="chapter" data-level="" data-path="rct-intro.html"><a href="rct-intro.html#phase-two"><i class="fa fa-check"></i>Phase two</a></li>
<li class="chapter" data-level="" data-path="rct-intro.html"><a href="rct-intro.html#phase-three"><i class="fa fa-check"></i>Phase three</a></li>
<li class="chapter" data-level="" data-path="rct-intro.html"><a href="rct-intro.html#phase-four"><i class="fa fa-check"></i>Phase four</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>I Part I: Continuous outcome variables</b></span></li>
<li class="chapter" data-level="2" data-path="rct-plan.html"><a href="rct-plan.html"><i class="fa fa-check"></i><b>2</b> Sample size for a normally distributed primary outcome variable</a>
<ul>
<li class="chapter" data-level="2.1" data-path="rct-plan.html"><a href="rct-plan.html#the-treatment-effect"><i class="fa fa-check"></i><b>2.1</b> The treatment effect</a></li>
<li class="chapter" data-level="2.2" data-path="rct-plan.html"><a href="rct-plan.html#reminder-hypothesis-tests-with-a-focus-on-rcts"><i class="fa fa-check"></i><b>2.2</b> Reminder: hypothesis tests (with a focus on RCTs)</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="rct-plan.html"><a href="rct-plan.html#one-tailed-or-two-tailed"><i class="fa fa-check"></i><b>2.2.1</b> One-tailed or two-tailed?</a></li>
<li class="chapter" data-level="2.2.2" data-path="rct-plan.html"><a href="rct-plan.html#insignificant-results"><i class="fa fa-check"></i><b>2.2.2</b> Insignificant results</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="rct-plan.html"><a href="rct-plan.html#sec-measDcont"><i class="fa fa-check"></i><b>2.3</b> Constructing a measure of effect size</a></li>
<li class="chapter" data-level="2.4" data-path="rct-plan.html"><a href="rct-plan.html#sec-power"><i class="fa fa-check"></i><b>2.4</b> Power: If <span class="math inline">\(H_0\)</span> is false</a></li>
<li class="chapter" data-level="2.5" data-path="rct-plan.html"><a href="rct-plan.html#sec-ssformulacont"><i class="fa fa-check"></i><b>2.5</b> A sample size formula</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="alloc.html"><a href="alloc.html"><i class="fa fa-check"></i><b>3</b> Allocation</a>
<ul>
<li class="chapter" data-level="3.1" data-path="alloc.html"><a href="alloc.html#bias"><i class="fa fa-check"></i><b>3.1</b> Bias</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="alloc.html"><a href="alloc.html#where-does-bias-come-from"><i class="fa fa-check"></i><b>3.1.1</b> Where does bias come from?</a></li>
<li class="chapter" data-level="3.1.2" data-path="alloc.html"><a href="alloc.html#implications-for-allocation"><i class="fa fa-check"></i><b>3.1.2</b> Implications for allocation</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="alloc.html"><a href="alloc.html#sec-allocation"><i class="fa fa-check"></i><b>3.2</b> Allocation methods</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="alloc.html"><a href="alloc.html#simple-random-allocation"><i class="fa fa-check"></i><b>3.2.1</b> Simple random allocation</a></li>
<li class="chapter" data-level="3.2.2" data-path="alloc.html"><a href="alloc.html#random-permuted-blocks"><i class="fa fa-check"></i><b>3.2.2</b> Random permuted blocks</a></li>
<li class="chapter" data-level="3.2.3" data-path="alloc.html"><a href="alloc.html#bcurn"><i class="fa fa-check"></i><b>3.2.3</b> Biased coin designs and urn schemes</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="alloc.html"><a href="alloc.html#incorporating-baseline-measurements"><i class="fa fa-check"></i><b>3.3</b> Incorporating baseline measurements</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="alloc.html"><a href="alloc.html#stratified-sampling"><i class="fa fa-check"></i><b>3.3.1</b> Stratified sampling</a></li>
<li class="chapter" data-level="3.3.2" data-path="alloc.html"><a href="alloc.html#minimization"><i class="fa fa-check"></i><b>3.3.2</b> Minimization</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="alloc.html"><a href="alloc.html#problems-around-allocation"><i class="fa fa-check"></i><b>3.4</b> Problems around allocation</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="rct-analysis.html"><a href="rct-analysis.html"><i class="fa fa-check"></i><b>4</b> Analyzing RCT data</a>
<ul>
<li class="chapter" data-level="4.1" data-path="rct-analysis.html"><a href="rct-analysis.html#ttest"><i class="fa fa-check"></i><b>4.1</b> Confidence intervals and P-values</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="rct-analysis.html"><a href="rct-analysis.html#what-do-we-do-with-this-outcome"><i class="fa fa-check"></i><b>4.1.1</b> What do we do with this outcome?</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="rct-analysis.html"><a href="rct-analysis.html#baseline"><i class="fa fa-check"></i><b>4.2</b> Using baseline values</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="rct-analysis.html"><a href="rct-analysis.html#the-variance-of-the-treatment-effect-estimate"><i class="fa fa-check"></i><b>4.2.1</b> The variance of the treatment effect estimate</a></li>
<li class="chapter" data-level="4.2.2" data-path="rct-analysis.html"><a href="rct-analysis.html#a-dodgy-way-to-use-baseline-variables"><i class="fa fa-check"></i><b>4.2.2</b> A dodgy way to use baseline variables</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="rct-analysis.html"><a href="rct-analysis.html#analysis-of-covariance-ancova"><i class="fa fa-check"></i><b>4.3</b> Analysis of covariance (ANCOVA)</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="rct-analysis.html"><a href="rct-analysis.html#ancovatheory"><i class="fa fa-check"></i><b>4.3.1</b> The theory</a></li>
<li class="chapter" data-level="4.3.2" data-path="rct-analysis.html"><a href="rct-analysis.html#ancova-practice"><i class="fa fa-check"></i><b>4.3.2</b> The practice</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="rct-analysis.html"><a href="rct-analysis.html#some-follow-up-questions."><i class="fa fa-check"></i><b>4.4</b> Some follow-up questions….</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="rct-analysis.html"><a href="rct-analysis.html#didnt-we-say-that-x_t---x_c-was-an-unbiased-estimator-of-tau"><i class="fa fa-check"></i><b>4.4.1</b> Didn’t we say that <span class="math inline">\(X_T - X_C\)</span> was an unbiased estimator of <span class="math inline">\(\tau\)</span>?</a></li>
<li class="chapter" data-level="4.4.2" data-path="rct-analysis.html"><a href="rct-analysis.html#what-if-the-lines-shouldnt-be-parallel-the-unequal-slopes-model"><i class="fa fa-check"></i><b>4.4.2</b> What if the lines shouldn’t be parallel? The unequal slopes model</a></li>
<li class="chapter" data-level="4.4.3" data-path="rct-analysis.html"><a href="rct-analysis.html#can-we-include-any-other-baseline-covariates"><i class="fa fa-check"></i><b>4.4.3</b> Can we include any other baseline covariates?</a></li>
<li class="chapter" data-level="" data-path="rct-analysis.html"><a href="rct-analysis.html#an-important-caution"><i class="fa fa-check"></i>An important caution!</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>II Part II: Binary outcome variable</b></span></li>
<li class="chapter" data-level="5" data-path="ss-bin.html"><a href="ss-bin.html"><i class="fa fa-check"></i><b>5</b> Sample size for a binary variable</a>
<ul>
<li class="chapter" data-level="5.1" data-path="ss-bin.html"><a href="ss-bin.html#delta-method"><i class="fa fa-check"></i><b>5.1</b> The Delta Method</a></li>
<li class="chapter" data-level="5.2" data-path="ss-bin.html"><a href="ss-bin.html#a-sample-size-formula"><i class="fa fa-check"></i><b>5.2</b> A sample size formula</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="binary-analysis.html"><a href="binary-analysis.html"><i class="fa fa-check"></i><b>6</b> Analysis for binary outcomes</a>
<ul>
<li class="chapter" data-level="6.1" data-path="binary-analysis.html"><a href="binary-analysis.html#bin-point-est"><i class="fa fa-check"></i><b>6.1</b> Simple hypothesis tests</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="binary-analysis.html"><a href="binary-analysis.html#a-simple-method-chi-squared"><i class="fa fa-check"></i><b>6.1.1</b> A simple method: chi-squared</a></li>
<li class="chapter" data-level="6.1.2" data-path="binary-analysis.html"><a href="binary-analysis.html#likelihood-a-more-rigorous-way"><i class="fa fa-check"></i><b>6.1.2</b> Likelihood: A more rigorous way</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="binary-analysis.html"><a href="binary-analysis.html#measures-of-difference-for-binary-data"><i class="fa fa-check"></i><b>6.2</b> Measures of difference for binary data</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="binary-analysis.html"><a href="binary-analysis.html#ard-and-nnt"><i class="fa fa-check"></i><b>6.2.1</b> Absolute risk difference and Number Needed to Treat</a></li>
<li class="chapter" data-level="6.2.2" data-path="binary-analysis.html"><a href="binary-analysis.html#risk-ratio-rr-and-odds-ratio-or"><i class="fa fa-check"></i><b>6.2.2</b> Risk Ratio (RR) and Odds ratio (OR)</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="binary-analysis.html"><a href="binary-analysis.html#logreg"><i class="fa fa-check"></i><b>6.3</b> Accounting for baseline observations: logistic regression</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="binary-analysis.html"><a href="binary-analysis.html#what-does-this-model-tell-us"><i class="fa fa-check"></i><b>6.3.1</b> What does this model tell us?</a></li>
<li class="chapter" data-level="6.3.2" data-path="binary-analysis.html"><a href="binary-analysis.html#fitting-a-logistic-regression-model"><i class="fa fa-check"></i><b>6.3.2</b> Fitting a logistic regression model</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="binary-analysis.html"><a href="binary-analysis.html#diaglogreg"><i class="fa fa-check"></i><b>6.4</b> Diagnostics for logistic regression</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="binary-analysis.html"><a href="binary-analysis.html#discrimination"><i class="fa fa-check"></i><b>6.4.1</b> Discrimination</a></li>
<li class="chapter" data-level="6.4.2" data-path="binary-analysis.html"><a href="binary-analysis.html#calibration"><i class="fa fa-check"></i><b>6.4.2</b> Calibration</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>III Part III: Survival data</b></span></li>
<li class="chapter" data-level="7" data-path="working-with-time-to-event-data.html"><a href="working-with-time-to-event-data.html"><i class="fa fa-check"></i><b>7</b> Working with time-to-event data</a>
<ul>
<li class="chapter" data-level="7.1" data-path="working-with-time-to-event-data.html"><a href="working-with-time-to-event-data.html#censored-times"><i class="fa fa-check"></i><b>7.1</b> Censored times</a></li>
<li class="chapter" data-level="7.2" data-path="working-with-time-to-event-data.html"><a href="working-with-time-to-event-data.html#survhaz"><i class="fa fa-check"></i><b>7.2</b> The Survival Curve and the Hazard function</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="working-with-time-to-event-data.html"><a href="working-with-time-to-event-data.html#the-kaplan-meier-estimator"><i class="fa fa-check"></i><b>7.2.1</b> The Kaplan-Meier estimator</a></li>
<li class="chapter" data-level="7.2.2" data-path="working-with-time-to-event-data.html"><a href="working-with-time-to-event-data.html#a-parametric-approach"><i class="fa fa-check"></i><b>7.2.2</b> A parametric approach</a></li>
<li class="chapter" data-level="7.2.3" data-path="working-with-time-to-event-data.html"><a href="working-with-time-to-event-data.html#weibull"><i class="fa fa-check"></i><b>7.2.3</b> The Weibull distribution</a></li>
<li class="chapter" data-level="" data-path="working-with-time-to-event-data.html"><a href="working-with-time-to-event-data.html#aside-sample-size-calculations-for-time-to-event-data"><i class="fa fa-check"></i>Aside: Sample size calculations for time-to-event data</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="comparing-survival-curves.html"><a href="comparing-survival-curves.html"><i class="fa fa-check"></i><b>8</b> Comparing survival curves</a>
<ul>
<li class="chapter" data-level="8.1" data-path="comparing-survival-curves.html"><a href="comparing-survival-curves.html#survlrtest"><i class="fa fa-check"></i><b>8.1</b> Parametric: likelihood ratio test</a></li>
<li class="chapter" data-level="8.2" data-path="comparing-survival-curves.html"><a href="comparing-survival-curves.html#non-parametric-the-log-rank-test"><i class="fa fa-check"></i><b>8.2</b> Non-parametric: the log-rank test</a></li>
<li class="chapter" data-level="8.3" data-path="comparing-survival-curves.html"><a href="comparing-survival-curves.html#semi-parametric-the-proportional-hazards-model"><i class="fa fa-check"></i><b>8.3</b> Semi-parametric: the proportional hazards model</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="comparing-survival-curves.html"><a href="comparing-survival-curves.html#general-proportional-hazards-model"><i class="fa fa-check"></i><b>8.3.1</b> General proportional hazards model</a></li>
<li class="chapter" data-level="8.3.2" data-path="comparing-survival-curves.html"><a href="comparing-survival-curves.html#coxreg"><i class="fa fa-check"></i><b>8.3.2</b> Cox regression</a></li>
<li class="chapter" data-level="" data-path="comparing-survival-curves.html"><a href="comparing-survival-curves.html#how-can-we-tell-if-a-proportional-hazards-model-is-appropriate"><i class="fa fa-check"></i>How can we tell if a proportional hazards model is appropriate?</a></li>
<li class="chapter" data-level="8.3.3" data-path="comparing-survival-curves.html"><a href="comparing-survival-curves.html#diagnostics-for-cox-regression"><i class="fa fa-check"></i><b>8.3.3</b> Diagnostics for Cox regression</a></li>
</ul></li>
</ul></li>
<li class="appendix"><span><b>Computer practicals</b></span></li>
<li class="chapter" data-level="A" data-path="computer-practical-1---missing-data.html"><a href="computer-practical-1---missing-data.html"><i class="fa fa-check"></i><b>A</b> Computer Practical 1 - Missing data</a>
<ul>
<li class="chapter" data-level="" data-path="computer-practical-1---missing-data.html"><a href="computer-practical-1---missing-data.html#r-practicalities"><i class="fa fa-check"></i>R practicalities</a></li>
<li class="chapter" data-level="A.1" data-path="computer-practical-1---missing-data.html"><a href="computer-practical-1---missing-data.html#missing-data"><i class="fa fa-check"></i><b>A.1</b> Missing data</a>
<ul>
<li class="chapter" data-level="A.1.1" data-path="computer-practical-1---missing-data.html"><a href="computer-practical-1---missing-data.html#datasets"><i class="fa fa-check"></i><b>A.1.1</b> Datasets</a></li>
</ul></li>
<li class="chapter" data-level="A.2" data-path="computer-practical-1---missing-data.html"><a href="computer-practical-1---missing-data.html#understanding-the-patterns-of-missingness"><i class="fa fa-check"></i><b>A.2</b> Understanding the patterns of missingness</a>
<ul>
<li class="chapter" data-level="A.2.1" data-path="computer-practical-1---missing-data.html"><a href="computer-practical-1---missing-data.html#visualising-missingness"><i class="fa fa-check"></i><b>A.2.1</b> Visualising missingness</a></li>
<li class="chapter" data-level="A.2.2" data-path="computer-practical-1---missing-data.html"><a href="computer-practical-1---missing-data.html#summary-tables"><i class="fa fa-check"></i><b>A.2.2</b> Summary tables</a></li>
<li class="chapter" data-level="A.2.3" data-path="computer-practical-1---missing-data.html"><a href="computer-practical-1---missing-data.html#mechanisms-of-missingness"><i class="fa fa-check"></i><b>A.2.3</b> Mechanisms of missingness</a></li>
</ul></li>
<li class="chapter" data-level="A.3" data-path="computer-practical-1---missing-data.html"><a href="computer-practical-1---missing-data.html#exploring-the-relationship-between-missingness-and-other-variables"><i class="fa fa-check"></i><b>A.3</b> Exploring the relationship between missingness and other variables</a>
<ul>
<li class="chapter" data-level="A.3.1" data-path="computer-practical-1---missing-data.html"><a href="computer-practical-1---missing-data.html#sec-statsum"><i class="fa fa-check"></i><b>A.3.1</b> Statistical summaries of the effect of missingness</a></li>
<li class="chapter" data-level="A.3.2" data-path="computer-practical-1---missing-data.html"><a href="computer-practical-1---missing-data.html#modelling-missingness"><i class="fa fa-check"></i><b>A.3.2</b> Modelling missingness</a></li>
</ul></li>
<li class="chapter" data-level="A.4" data-path="computer-practical-1---missing-data.html"><a href="computer-practical-1---missing-data.html#what-to-do-about-missing-data"><i class="fa fa-check"></i><b>A.4</b> What to do about missing data?!</a>
<ul>
<li class="chapter" data-level="A.4.1" data-path="computer-practical-1---missing-data.html"><a href="computer-practical-1---missing-data.html#discarding-some-non-missing-data"><i class="fa fa-check"></i><b>A.4.1</b> Discarding some (non-missing) data</a></li>
<li class="chapter" data-level="A.4.2" data-path="computer-practical-1---missing-data.html"><a href="computer-practical-1---missing-data.html#imputing-data"><i class="fa fa-check"></i><b>A.4.2</b> Imputing data</a></li>
<li class="chapter" data-level="A.4.3" data-path="computer-practical-1---missing-data.html"><a href="computer-practical-1---missing-data.html#multiple-imputation"><i class="fa fa-check"></i><b>A.4.3</b> Multiple imputation</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="B" data-path="computer-practical-2---allocation-analysis.html"><a href="computer-practical-2---allocation-analysis.html"><i class="fa fa-check"></i><b>B</b> Computer Practical 2 - Allocation &amp; Analysis</a>
<ul>
<li class="chapter" data-level="" data-path="computer-practical-2---allocation-analysis.html"><a href="computer-practical-2---allocation-analysis.html#health-warning"><i class="fa fa-check"></i>Health warning!</a>
<ul>
<li class="chapter" data-level="" data-path="computer-practical-2---allocation-analysis.html"><a href="computer-practical-2---allocation-analysis.html#preliminaries"><i class="fa fa-check"></i>Preliminaries</a></li>
<li class="chapter" data-level="" data-path="computer-practical-2---allocation-analysis.html"><a href="computer-practical-2---allocation-analysis.html#r-practicalities-1"><i class="fa fa-check"></i>R practicalities</a></li>
</ul></li>
<li class="chapter" data-level="B.1" data-path="computer-practical-2---allocation-analysis.html"><a href="computer-practical-2---allocation-analysis.html#cp1allocation"><i class="fa fa-check"></i><b>B.1</b> Allocation</a>
<ul>
<li class="chapter" data-level="B.1.1" data-path="computer-practical-2---allocation-analysis.html"><a href="computer-practical-2---allocation-analysis.html#licorice-gargle-dataset"><i class="fa fa-check"></i><b>B.1.1</b> Licorice gargle dataset</a></li>
<li class="chapter" data-level="B.1.2" data-path="computer-practical-2---allocation-analysis.html"><a href="computer-practical-2---allocation-analysis.html#allocmethods"><i class="fa fa-check"></i><b>B.1.2</b> Allocation methods</a></li>
<li class="chapter" data-level="B.1.3" data-path="computer-practical-2---allocation-analysis.html"><a href="computer-practical-2---allocation-analysis.html#stratifying-the-dataset"><i class="fa fa-check"></i><b>B.1.3</b> Stratifying the dataset</a></li>
<li class="chapter" data-level="B.1.4" data-path="computer-practical-2---allocation-analysis.html"><a href="computer-practical-2---allocation-analysis.html#minimisation"><i class="fa fa-check"></i><b>B.1.4</b> Minimisation</a></li>
</ul></li>
<li class="chapter" data-level="B.2" data-path="computer-practical-2---allocation-analysis.html"><a href="computer-practical-2---allocation-analysis.html#cp1analysis"><i class="fa fa-check"></i><b>B.2</b> Analysis</a>
<ul>
<li class="chapter" data-level="B.2.1" data-path="computer-practical-2---allocation-analysis.html"><a href="computer-practical-2---allocation-analysis.html#polyps-data"><i class="fa fa-check"></i><b>B.2.1</b> Polyps data</a></li>
</ul></li>
<li class="chapter" data-level="B.3" data-path="computer-practical-2---allocation-analysis.html"><a href="computer-practical-2---allocation-analysis.html#extension-problems"><i class="fa fa-check"></i><b>B.3</b> Extension problems</a>
<ul>
<li class="chapter" data-level="B.3.1" data-path="computer-practical-2---allocation-analysis.html"><a href="computer-practical-2---allocation-analysis.html#a-simulation-experiment"><i class="fa fa-check"></i><b>B.3.1</b> A simulation experiment!</a></li>
<li class="chapter" data-level="B.3.2" data-path="computer-practical-2---allocation-analysis.html"><a href="computer-practical-2---allocation-analysis.html#treatment-for-maternal-periodontal-disease"><i class="fa fa-check"></i><b>B.3.2</b> Treatment for maternal periodontal disease</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="C" data-path="cp3sim.html"><a href="cp3sim.html"><i class="fa fa-check"></i><b>C</b> Computer Practical 3 - Sample size by simulation</a>
<ul>
<li class="chapter" data-level="C.1" data-path="cp3sim.html"><a href="cp3sim.html#power-simulation-for-a-t-test"><i class="fa fa-check"></i><b>C.1</b> Power simulation for a t-test</a></li>
<li class="chapter" data-level="C.2" data-path="cp3sim.html"><a href="cp3sim.html#power-simulation-for-ancova"><i class="fa fa-check"></i><b>C.2</b> Power simulation for ANCOVA</a></li>
<li class="chapter" data-level="C.3" data-path="cp3sim.html"><a href="cp3sim.html#conclusion"><i class="fa fa-check"></i><b>C.3</b> Conclusion</a></li>
</ul></li>
<li class="chapter" data-level="D" data-path="computer-practical-4---analysis-for-binary-and-survival-data.html"><a href="computer-practical-4---analysis-for-binary-and-survival-data.html"><i class="fa fa-check"></i><b>D</b> Computer practical 4 - Analysis for Binary and Survival data</a>
<ul>
<li class="chapter" data-level="D.1" data-path="computer-practical-4---analysis-for-binary-and-survival-data.html"><a href="computer-practical-4---analysis-for-binary-and-survival-data.html#binary-outcome-data"><i class="fa fa-check"></i><b>D.1</b> Binary outcome data</a>
<ul>
<li class="chapter" data-level="D.1.1" data-path="computer-practical-4---analysis-for-binary-and-survival-data.html"><a href="computer-practical-4---analysis-for-binary-and-survival-data.html#confidence-intervals"><i class="fa fa-check"></i><b>D.1.1</b> Confidence Intervals</a></li>
<li class="chapter" data-level="D.1.2" data-path="computer-practical-4---analysis-for-binary-and-survival-data.html"><a href="computer-practical-4---analysis-for-binary-and-survival-data.html#cp2logreg"><i class="fa fa-check"></i><b>D.1.2</b> Logistic regression</a></li>
</ul></li>
<li class="chapter" data-level="D.2" data-path="computer-practical-4---analysis-for-binary-and-survival-data.html"><a href="computer-practical-4---analysis-for-binary-and-survival-data.html#cp2-surv"><i class="fa fa-check"></i><b>D.2</b> Analysis for Survival data</a>
<ul>
<li class="chapter" data-level="D.2.1" data-path="computer-practical-4---analysis-for-binary-and-survival-data.html"><a href="computer-practical-4---analysis-for-binary-and-survival-data.html#fitting-a-survival-curve"><i class="fa fa-check"></i><b>D.2.1</b> Fitting a survival curve</a></li>
<li class="chapter" data-level="D.2.2" data-path="computer-practical-4---analysis-for-binary-and-survival-data.html"><a href="computer-practical-4---analysis-for-binary-and-survival-data.html#comparing-survival-curves-1"><i class="fa fa-check"></i><b>D.2.2</b> Comparing survival curves</a></li>
</ul></li>
<li class="chapter" data-level="D.3" data-path="computer-practical-4---analysis-for-binary-and-survival-data.html"><a href="computer-practical-4---analysis-for-binary-and-survival-data.html#cp2sim2"><i class="fa fa-check"></i><b>D.3</b> Extension problem: Sample size by simulation (part II)</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Clinical Trials 4H</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="rct-plan" class="section level1 hasAnchor" number="2">
<h1><span class="header-section-number">2</span> Sample size for a normally distributed primary outcome variable<a href="rct-plan.html#rct-plan" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>For most of this module, we’ll focus on randomised controlled trials (RCTs). These have mainly been used for clinical applications (for example, to test a particular drug), but have also recently become popular ways to test interventions in areas such as education and policing.</p>
<p>Having laid the groundwork in Chapter <a href="rct-intro.html#rct-intro">1</a>, we now go on to some more technical details. In this Chapter, we focus on the ‘vanilla’ scenario, where we have a trial with two arms, and our unit of randomization is individuals. At first we will focus only on continuous outcomes, but in later weeks we will go on to think about binary and time-to-event data.</p>
<p>The topics we cover fall into the categories of ‘before the trial’ (design and planning) or ‘after the trial’ (analysis), although as we’ll see there is some interaction between these stages.</p>
<p>The first big question asked of a trial statistician is usually how many participants does the trial need in order to be viable: the sample size. We will clarify what is meant by ‘viable’ later in this section.</p>
<p>Broadly speaking, there are two (opposing) ethical issues around sample size:</p>
<ol style="list-style-type: decimal">
<li>If we don’t recruit enough patients, then we may not gather enough evidence to draw any conclusion about the research question (eg. whether there is a treatment effect). As well as being scientifically disappointing, this is unethical. To conduct the trial, some of the patients will have been subject to an inferior treatment (assuming one treatment was actually better), and if there is no conclusion then this was effectively for no purpose.</li>
<li>If we recruit too many patients (ie. we would be sufficiently likely to reach a conclusion with many fewer) then we have subjected more patients than necessary to an inferior treatment, and possibly also taken up more time and resources than was necessary.</li>
</ol>
<p>It is therefore important to think about this issue carefully. We’ve framed the question in quite a woolly way so far, but now we’ll start to think more carefully.</p>
<div id="the-treatment-effect" class="section level2 hasAnchor" number="2.1">
<h2><span class="header-section-number">2.1</span> The treatment effect<a href="rct-plan.html#the-treatment-effect" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In Section <a href="rct-intro.html#primout">1.3</a> we discussed the need to settle on a <strong>primary outcome variable</strong>. One reason this is important is that we base our sample size calculations on the primary outcome variable.</p>
<div class="definition">
<p><span id="def:unlabeled-div-4" class="definition"><strong>Definition 2.1  </strong></span>Suppose our primary outcome variable is <span class="math inline">\(X\)</span>, which has mean <span class="math inline">\(\mu\)</span> for the control group and mean <span class="math inline">\(\mu + \tau\)</span> for the treatment group. The variable <span class="math inline">\(\tau\)</span> is the <strong>treatment effect</strong>. The goal of our RCT is to learn about <span class="math inline">\(\tau\)</span>. The larger <span class="math inline">\(\tau\)</span> is (in magnitude), the more pronounced the effect of the intervention.</p>
</div>
<p>This problem is usually framed as a <strong>hypothesis test</strong>, where the null hypothesis is that <span class="math inline">\(\tau=0\)</span>.</p>
</div>
<div id="reminder-hypothesis-tests-with-a-focus-on-rcts" class="section level2 hasAnchor" number="2.2">
<h2><span class="header-section-number">2.2</span> Reminder: hypothesis tests (with a focus on RCTs)<a href="rct-plan.html#reminder-hypothesis-tests-with-a-focus-on-rcts" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>When performing a hypothesis test, what we are aiming to find is the <strong>P-value</strong>.</p>
<div class="definition">
<p><span id="def:unlabeled-div-5" class="definition"><strong>Definition 2.2  </strong></span>The <strong>P-value</strong> is the probability of obtaining a result as extreme as or more extreme (ie. further away from the null hypothesis value) than the one obtained <em>given that the null hypothesis is true</em>.</p>
</div>
<p>Put simply, the P-value is a measure of the probability of obtaining whatever result (eg. treatment effect) we have have found simply by random chance, when in fact there is no treatment effect (ie. <span class="math inline">\(\tau=0\)</span>). Generally, a P-value of <span class="math inline">\(\alpha = 0.05\)</span> is accepted as sufficient evidence to reject the null hypothesis, although in clinical settings it can often be smaller (eg. <span class="math inline">\(\alpha = 0.01\)</span>). It is conventional to present the P-value by simply saying whether it is smaller than some threshold (often 0.05), rather than giving the exact value.</p>
<div class="definition">
<p><span id="def:unlabeled-div-6" class="definition"><strong>Definition 2.3  </strong></span>The threshold for the P-value below which the results are considered ‘significant’ is known as the <strong>significance level</strong> of the test, and is generally written <span class="math inline">\(\alpha\)</span> (as above).</p>
</div>
<p>This use of a significance level is (in part) a legacy from early days when computers were rare and values were looked up in <span class="math inline">\(t\)</span>-tables (or similar). Now that it is very simple to find the exact P-value, it is becoming more and more common to report the actual number. Indeed, there is a big difference between <span class="math inline">\(p=0.049\)</span> and <span class="math inline">\(p=0.000049\)</span>.</p>
<div id="one-tailed-or-two-tailed" class="section level3 hasAnchor" number="2.2.1">
<h3><span class="header-section-number">2.2.1</span> One-tailed or two-tailed?<a href="rct-plan.html#one-tailed-or-two-tailed" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>It is highly likely that the scientists running the trial will have a strong idea of the likely ‘direction’ of the treatment effect. Assuming that a larger value of the primary outcome variable <span class="math inline">\(X\)</span> is good, they will expect a positive value of the treatment effect <span class="math inline">\(\tau\)</span> (or be prepared to accept a possible value of zero for no effect).</p>
<p>It would therefore be tempting to perform a one-sided test, with</p>
<p><span class="math display">\[\begin{align*}
  H_0\,&amp;:\, \tau=0\\
  H_1\,&amp;:\, \tau&gt;0.
\end{align*}\]</span></p>
<p>For example, suppose our test statistic <span class="math inline">\(t\)</span> has a <span class="math inline">\(t\)</span> distribution with 31 degrees of freedom and we obtain a value of 2, as shown in Figure <a href="rct-plan.html#fig:t31-onesided">2.1</a>.
In this case our P-value is <span class="math inline">\(1 - F_t\left(2, df=31\right)= 0.0272\)</span> (where <span class="math inline">\(F_t\left(\cdot\right)\)</span> is the cumulative distribution function of the <span class="math inline">\(t\)</span> distribution) , and the result would be considered significant at the 0.05 level.</p>
<div class="figure"><span style="display:block;" id="fig:t31-onesided"></span>
<img src="CT4H_notes_files/figure-html/t31-onesided-1.png" alt="The distribution $t_{31}$, with the area corresponding to $t &gt; 2$ shaded." width="672" />
<p class="caption">
Figure 2.1: The distribution <span class="math inline">\(t_{31}\)</span>, with the area corresponding to <span class="math inline">\(t &gt; 2\)</span> shaded.
</p>
</div>
<p>For a large positive value of <span class="math inline">\(t\)</span>, we obtain a small P-value, and reject <span class="math inline">\(H_0\)</span>, concluding that the intervention is effective (in a good way). However, what if we obtain a large negative value of <span class="math inline">\(t\)</span>? In this one-sided set-up, there is no value of <span class="math inline">\(t&lt;0\)</span> that would give a significant result; negative values of <span class="math inline">\(t\)</span> are simply considered consistent with <span class="math inline">\(H_0\)</span>, and there is no mechanism to conclude that an intervention has a significantly negative effect.</p>
<p>For this reason, we always conduct two sided hypothesis tests, with</p>
<p><span class="math display">\[\begin{align*}
  H_0\,&amp;:\, \tau=0\\
  H_1\,&amp;:\, \tau\neq 0.
\end{align*}\]</span></p>
<p>In this scenario, Figure <a href="rct-plan.html#fig:t31-onesided">2.1</a> is replaced by the plot shown in Figure <a href="rct-plan.html#fig:t31-twosided">2.2</a>, where values of <span class="math inline">\(t\)</span> with <span class="math inline">\(t&lt;-2\)</span> are considered ‘equivalent’ to those with <span class="math inline">\(t&gt;2\)</span>, in the sense of how unlikely they are under <span class="math inline">\(H_0\)</span>.</p>
<div class="figure"><span style="display:block;" id="fig:t31-twosided"></span>
<img src="CT4H_notes_files/figure-html/t31-twosided-1.png" alt="The distribution $t_{31}$, with the area corresponding to $|t| &gt; 2$ shaded." width="672" />
<p class="caption">
Figure 2.2: The distribution <span class="math inline">\(t_{31}\)</span>, with the area corresponding to <span class="math inline">\(|t| &gt; 2\)</span> shaded.
</p>
</div>
<p>The P-value for the two-sided test as shown in Figure <a href="rct-plan.html#fig:t31-twosided">2.2</a> is</p>
<p><span class="math display">\[ F\left(-2, df=31\right) + \left[1 - F\left(2, df=31\right)\right] = 2\times{0.0272} = 0.0543\]</span>
and the result is no longer significant at the 0.05 level. Throughout this course, we will always assume two-tailed tests.</p>
<div class="figure"><span style="display:block;" id="fig:starbucks"></span>
<img src="images/starbucks.jpg" alt="A rather ubiquitous two-tailed mermaid" width="320" />
<p class="caption">
Figure 2.3: A rather ubiquitous two-tailed mermaid
</p>
</div>
</div>
<div id="insignificant-results" class="section level3 hasAnchor" number="2.2.2">
<h3><span class="header-section-number">2.2.2</span> Insignificant results<a href="rct-plan.html#insignificant-results" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>If our P-value is relatively large, say 0.3 or 0.5 (or really, greater than <span class="math inline">\(\alpha\)</span>), then our result is not at all unlikely (or sufficiently unlikely) under the null hypothesis, and provides insufficient evidence to reject <span class="math inline">\(H_0.\)</span> However, it is not inconsistent with the existence of a treatment effect, so we don’t say there is evidence to accept <span class="math inline">\(H_0\)</span>. One can imagine that if the true treatment effect <span class="math inline">\(\tau\)</span> were tiny, many trials would fail to find evidence to reject <span class="math inline">\(H_0\)</span>. However, if our sample size were sufficiently large, we should be able to detect it. Conversely, if <span class="math inline">\(\tau\)</span> is very large, even a relatively small sample size is likely to provide enough evidence to reject <span class="math inline">\(H_0\)</span>.</p>
<p>A non-significant P-value means that our results are consistent with the null hypothesis <span class="math inline">\(\tau=0\)</span>, but they are also consistent with some small treatment effect, and therefore we can’t conclude very much. The key issue is, what size of treatment effect do we care about? We must ensure that our sample size is large enough to be sufficiently likely to detect a clinically meaningful treatment effect.</p>
<p>We are being vague for now, but this is a key issue in determining an appropriate sample size.</p>
</div>
</div>
<div id="sec-measDcont" class="section level2 hasAnchor" number="2.3">
<h2><span class="header-section-number">2.3</span> Constructing a measure of effect size<a href="rct-plan.html#sec-measDcont" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Let’s say we are recruiting participants into two groups: group <span class="math inline">\(T\)</span> will be given the new treatment (they will sometimes be referred to as the <em>treatment group</em> or <em>treatment arm</em>, or alternatively the <em>intervention group</em>) and group <span class="math inline">\(C\)</span> will be given the control (they are the <em>control group</em> or <em>control arm</em>).</p>
<p>Suppose that we have <span class="math inline">\(n\)</span> patients in group <span class="math inline">\(C\)</span>, and <span class="math inline">\(m\)</span> in group <span class="math inline">\(T\)</span>. The primary outcome variable <span class="math inline">\(X\)</span> is normally distributed with mean <span class="math inline">\(\mu\)</span> in group C (the control group) and mean <span class="math inline">\(\mu+\tau\)</span> in group T (the intervention group), and common standard deviation <span class="math inline">\(\sigma\)</span>. So</p>
<p><span class="math display">\[\begin{align*}
X &amp; \sim N\left(\mu, \sigma^2\right) \text{ in group }C\\
X &amp; \sim N\left(\mu + \tau, \sigma^2\right) \text{ in group }T.
\end{align*}\]</span></p>
<p>We are testing the null hypothesis <span class="math inline">\(H_0: \tau=0\)</span> against the alternative hypothesis <span class="math inline">\(H_1: \tau\neq{0}\)</span>.</p>
<p>Using the data obtained in the trial, we will be able to obtain sample means <span class="math inline">\(\bar{x}_C\)</span> and <span class="math inline">\(\bar{x}_T\)</span> from each group, and a pooled estimate of the standard deviation</p>
<p><span class="math display">\[ s = \sqrt{\frac{\left(n-1\right)s_C^2 + (m-1)s_T^2}{n+m - 2}},
\]</span>
where <span class="math inline">\(s_C\)</span> and <span class="math inline">\(s_T\)</span> are the sample standard deviations for groups <span class="math inline">\(C\)</span> and <span class="math inline">\(T\)</span> respectively, for example</p>
<p><span class="math display">\[
s_C = \sqrt{\frac{\sum\limits_{i=1}^n{\left(x_i - \bar{x}_C\right)^2}}{n-1}}.
\]</span></p>
<p>Using these values we can compute</p>
<p><span class="math display">\[D = \frac{\bar{x}_T - \bar{x}_C}{s\sqrt{\frac{1}{n} + \frac{1}{m}}}\]</span>
as a standardised measure of the effect <span class="math inline">\(\tau\)</span>.</p>
<div class="theorem">
<p><span id="thm:unlabeled-div-7" class="theorem"><strong>Theorem 2.1  </strong></span>Under <span class="math inline">\(H_0\)</span>, and the model we’ve specified, <span class="math inline">\(D\)</span> has a <span class="math inline">\(t\)</span>-distribution with <span class="math inline">\(n+m-2\)</span> degrees of freedom.</p>
</div>
<div class="proof">
<p><span id="unlabeled-div-8" class="proof"><em>Proof</em>. </span>Under <span class="math inline">\(H_0\)</span> the <span class="math inline">\(x_i\)</span> are iid <span class="math inline">\(N\left(\mu,\;\sigma^2\right)\)</span>, and so</p>
<p><span class="math display">\[\begin{align*}
\bar{x}_C &amp; \sim{N\left(\mu, \frac{\sigma^2}{n}\right)}\\
\bar{x}_T &amp; \sim{N\left(\mu, \frac{\sigma^2}{m}\right)}
\end{align*}\]</span></p>
<p>and therefore</p>
<p><span class="math display">\[
\bar{x}_T - \bar{x}_C \sim{N \left(0, \sigma^2\left[\frac{1}{n} + \frac{1}{m}\right] \right)}\]</span></p>
<p>and
<span class="math display">\[
\frac{\bar{x}_T - \bar{x}_C}{\sigma \sqrt{\frac{1}{n}+\frac{1}{m}}} \sim{N\left(0,1\right)}.\]</span></p>
<p>We know that for <span class="math inline">\(x_1,\ldots,x_n,\sim N\left(\mu,\sigma^2\right)\)</span> for some arbitrary <span class="math inline">\(\mu\)</span> and <span class="math inline">\(\sigma^2\)</span>,</p>
<p><span class="math display">\[\frac{1}{\sigma^2}\sum\limits_{i=1}^n\left(x_i - \bar{x}\right)^2 \sim{\chi^2_{n-1}},\]</span>
and so we have</p>
<p><span class="math display">\[\begin{align*}
\frac{n-1}{\sigma^2}s_C^2 &amp; \sim \chi^2_{n-1}\\
\frac{m-1}{\sigma^2}s_T^2 &amp; \sim \chi^2_{m-1}\\
\text{and} &amp;\\
\frac{1}{\sigma^2}\left[\left(n-1\right)s_C^2 + \left(m-1\right)s_T^2\right] &amp; = \frac{n+m-2}{\sigma^2}s^2\\
&amp;\sim \chi^2_{n+m-2}.
\end{align*}\]</span></p>
<p>The definition of a <span class="math inline">\(t\)</span>-distribution is that if <span class="math inline">\(Z\sim N\left(0,1\right)\)</span> and <span class="math inline">\(Y \sim{\chi^2_n}\)</span> then</p>
<p><span class="math display">\[X = \frac{Z} {\sqrt{\frac{Y}{n}}} \sim{t_n},\]</span>
that is <span class="math inline">\(X\)</span> has a <span class="math inline">\(t\)</span> distribution with <span class="math inline">\(n\)</span> degrees of freedom.</p>
<p>Plugging in our <span class="math inline">\(N\left(0,1\right)\)</span> variable for <span class="math inline">\(Z\)</span> and our <span class="math inline">\(\chi^2_{n+m-2}\)</span> variable for <span class="math inline">\(Y\)</span>, we have</p>
<p><span class="math display">\[\begin{align*}
\frac{\frac{\bar{x}_T - \bar{x}_C}{\sigma\sqrt{\frac{1}{n} + \frac{1}{m}}}}{\sqrt{\left(\frac{n+m-2}{\sigma^2}s^2\right) \bigg/ \left(n+m-2\right)}} &amp; = \frac{\bar{x}_T - \bar{x}_C}{\sigma\sqrt{\frac{1}{n} + \frac{1}{m}}} \bigg/ \frac{s}{\sigma} \\
&amp; = \frac{\bar{x}_T - \bar{x}_C}{s\sqrt{\frac{1}{n} + \frac{1}{m}}} \\
&amp; = D
\end{align*}\]</span></p>
<p>and therefore <span class="math inline">\(D\)</span> has a <span class="math inline">\(t\)</span> distribution with <span class="math inline">\(n+m-2\)</span> degrees of freedom.</p>
</div>
<p>We can therefore use <span class="math inline">\(D\)</span> as our test statistic; if <span class="math inline">\(D\)</span> is such that</p>
<p><span class="math display">\[ |D| &gt; t_{n+m-2}\left(\alpha/2\right)\]</span>
where
<span class="math inline">\(t_{n+m-2}\left(\cdot\right)\)</span> is the function such that <span class="math inline">\(P\left(T&gt;t_{df}\left(\xi\right)\right) = \xi\)</span> when <span class="math inline">\(T \sim{t_{df}}\)</span> then we can reject <span class="math inline">\(H_0\)</span>.</p>
<p>In practical terms, for more than around 40 degrees of freedom, the <span class="math inline">\(t\)</span> distribution is indistinguishable from the normal distribution, and since it is rare to have fewer than 40 participants in an RCT, we use a normal approximation in what follows, and a difference is significant at the <span class="math inline">\(100\left(1-\alpha\right) \%\)</span> level if <span class="math inline">\(|D| &gt; z_{\alpha/2}\)</span>, where <span class="math inline">\(z\)</span> are standard normal quantile values. For example, for <span class="math inline">\(\alpha=0.05\)</span> we have <span class="math inline">\(z_{\alpha/2} = 1.960\)</span>, since the probability of a standard normal variable exceeding this value is 0.025.</p>
<p>So, if we have run a trial, and have obtained <span class="math inline">\(n\)</span> values of <span class="math inline">\(X\)</span> from group <span class="math inline">\(C\)</span> and <span class="math inline">\(m\)</span> values of <span class="math inline">\(X\)</span> from group <span class="math inline">\(T\)</span>, we can compute <span class="math inline">\(D\)</span>. If <span class="math inline">\(D\)</span> lies outside the interval <span class="math inline">\(\left[-z_{\alpha/2}, z_{\alpha/2}\right]\)</span> then we reject <span class="math inline">\(H_0\)</span>.</p>
<p>This is equivalent to <span class="math inline">\(\bar{x}_T - \bar{x}_C\)</span> falling outside the interval</p>
<p><span class="math display">\[\left[-z_{\alpha/2}s\sqrt{\frac{1}{n} + \frac{1}{m}},\; z_{\alpha/2}s\sqrt{\frac{1}{n} + \frac{1}{m}}  \right]. \]</span></p>
<div id="brief-aside-on-notation" class="section level4 unnumbered hasAnchor">
<h4>Brief aside on notation<a href="rct-plan.html#brief-aside-on-notation" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="aside">
<p>We’ll see a lot of the notation <span class="math inline">\(z_{\alpha/2}\)</span> and similar, so to clarify:</p>
<p><img src="CT4H_notes_files/figure-html/unnamed-chunk-157-1.png" width="672" /></p>
<p>In R, we have <span class="math inline">\(\Phi\left(z_{\alpha/2}\right) = \texttt{pnorm}\left(z_{\alpha/2}\right)\)</span> and <span class="math inline">\(z_{\alpha/2} = \texttt{qnorm}\left(\Phi\left(z_{\alpha/2}\right)\right)\)</span>. <code>qnorm</code> is the quantile and <code>pnorm</code> is the cumulative distribution function. So, for example
<span class="math display">\[\frac{\alpha}{2} = 1 - \Phi\left(z_{\alpha/2}\right)\]</span></p>
</div>
<p>We have constructed our whole argument under the assumption that <span class="math inline">\(H_0\)</span> is true, and that the probability of such a value is therefore <span class="math inline">\(\alpha\)</span>. We want this probability to be small, since it constitutes an error; <span class="math inline">\(H_0\)</span> is true, but our value of <span class="math inline">\(D\)</span> (or the difference in means) leads us to reject <span class="math inline">\(H_0\)</span>. This is sometimes called the ‘type I’ error rate. But what if <span class="math inline">\(H_0\)</span> is false?</p>
</div>
</div>
<div id="sec-power" class="section level2 hasAnchor" number="2.4">
<h2><span class="header-section-number">2.4</span> Power: If <span class="math inline">\(H_0\)</span> is false<a href="rct-plan.html#sec-power" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>We have constructed things so that if <span class="math inline">\(H_0\)</span> is true, we have a small probability of rejecting <span class="math inline">\(H_0\)</span>. But if <span class="math inline">\(H_0\)</span> is false, and <span class="math inline">\(\tau\neq{0}\)</span>, we want our test to have a high probability of rejecting <span class="math inline">\(H_0\)</span>.</p>
<div class="definition">
<p><span id="def:unlabeled-div-9" class="definition"><strong>Definition 2.4  </strong></span>The <strong>power</strong> of a test is the probability that we reject <span class="math inline">\(H_0\)</span>, given that <span class="math inline">\(H_0\)</span> is false. The <strong>power function</strong> depends on the value of <span class="math inline">\(\tau\)</span> and is</p>
<p><span class="math display">\[\Psi\left(\tau\right) = \Pr\left(\text{Reject } H_0\mid{\tau\neq{0}}\right) = 1 - \beta.\]</span>
We therefore also have</p>
<p><span class="math display">\[\beta = \Pr\left(\text{Fail to reject } H_0\mid{\tau\neq{0}}\right). \]</span></p>
<p>We call <span class="math inline">\(\beta\)</span> the <strong>type II error rate</strong>.</p>
</div>
<p>If you find the notation confusing (as I do!) then it might be helpful to remember that both <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(\beta\)</span> are <strong>error rates</strong> - probabilities of coming to the wrong conclusion. It is common to talk in terms of <span class="math inline">\(\alpha\)</span>, the significance level, (which will be a low number, often 0.05) and of <span class="math inline">\(1-\beta\)</span>, the power (which will be a high number, often 0.8). I’ve found though that it is not uncommon to find people refer to <span class="math inline">\(\beta\)</span> (rather than <span class="math inline">\(1-\beta\)</span>) as the power. If in doubt, keep in mind that we require <span class="math inline">\(\alpha,\;\beta \ll 0.5\)</span>. It is also common to use percentages: a significance level of <span class="math inline">\(\alpha=0.05\)</span> can also be referred to as “the 95% level”, and <span class="math inline">\(\beta=0.2\)</span> is the same as a “power of 80%”. When using percentages, we talk in terms of the amount of time we expect the test to come to the correct conclusion.</p>
<p>If you notice any mistakes in these notes along these (or other!) lines, please point them out.</p>
<p>Under <span class="math inline">\(H_1\)</span>, we have (approximately)</p>
<p><span class="math display">\[D \sim{N\left(\frac{\tau}{\sigma\lambda\left(n,m\right)}, 1\right)},\]</span>
where <span class="math inline">\(\lambda\left(n,m\right) = \sqrt{\frac{1}{n}+\frac{1}{m}}\)</span> and
<span class="math display">\[D = \frac{\bar{x}_T - \bar{x}_C}{s\sqrt{\frac{1}{n} + \frac{1}{m}}}.\]</span></p>
<p>Figure <a href="rct-plan.html#fig:accepth0">2.4</a> shows the distribution of <span class="math inline">\(D\)</span> under <span class="math inline">\(H_0\)</span> and <span class="math inline">\(H_1\)</span> for some arbitrary (non-zero) effect size <span class="math inline">\(\tau\)</span>. The turquoise bar shows the ‘acceptance region’ of <span class="math inline">\(H_0\)</span>, ie. the range of observed values of <span class="math inline">\(D\)</span> for which we will fail to reject <span class="math inline">\(H_0\)</span>. We see that this contains 95% of the area of the <span class="math inline">\(H_0\)</span> distribution (we have set <span class="math inline">\(\alpha = 0.05\)</span> here), so under <span class="math inline">\(H_0\)</span>, we have a 0.95 probability of observing a value of <span class="math inline">\(D\)</span> that is consistent with <span class="math inline">\(H_0\)</span>. This could easily generalise to another value of <span class="math inline">\(\alpha\)</span>.</p>
<div class="figure"><span style="display:block;" id="fig:accepth0"></span>
<img src="CT4H_notes_files/figure-html/accepth0-1.png" alt="The distribution of $D$ under both $H_0$ and $H_1$ for some arbitrary values of effect size, population variance, $n$ and $m$, with the region in which we fail to reject $H_0$ shown by the turquoise bar and the red shading." width="672" />
<p class="caption">
Figure 2.4: The distribution of <span class="math inline">\(D\)</span> under both <span class="math inline">\(H_0\)</span> and <span class="math inline">\(H_1\)</span> for some arbitrary values of effect size, population variance, <span class="math inline">\(n\)</span> and <span class="math inline">\(m\)</span>, with the region in which we fail to reject <span class="math inline">\(H_0\)</span> shown by the turquoise bar and the red shading.
</p>
</div>
<p>However, if <span class="math inline">\(H_1\)</span> is true, and <span class="math inline">\(\tau\neq{0}\)</span>, there is a non-zero probability of observing a value of <span class="math inline">\(D\)</span> that would lead us to fail to reject <span class="math inline">\(H_0\)</span>. This is shown by the area shaded in red, and it has area <span class="math inline">\(\beta\)</span>. One minus this area (ie. the area under <span class="math inline">\(H_1\)</span> that leads us to reject <span class="math inline">\(H_0\)</span>) is the power, <span class="math inline">\(1-\beta\)</span>.</p>
<p>We can see that if the distributions have better separation, as in Figure <a href="rct-plan.html#fig:accepth0-1">2.5</a>, the power becomes greater. This can be as a result of a larger <span class="math inline">\(\tau\)</span>, a smaller <span class="math inline">\(\sigma\)</span> or a smaller <span class="math inline">\(\lambda\)</span> (therefore larger <span class="math inline">\(m\)</span> and/or <span class="math inline">\(n\)</span>).</p>
<div class="figure"><span style="display:block;" id="fig:accepth0-1"></span>
<img src="CT4H_notes_files/figure-html/accepth0-1-1.png" alt="The distribution of D under both $H_0$ and $H_1$ for some arbitrary values of effect size, population variance, $n$ and $m$, with the region in which we fail to reject $H_0$ shown by the turquoise bar and the red shading." width="672" />
<p class="caption">
Figure 2.5: The distribution of D under both <span class="math inline">\(H_0\)</span> and <span class="math inline">\(H_1\)</span> for some arbitrary values of effect size, population variance, <span class="math inline">\(n\)</span> and <span class="math inline">\(m\)</span>, with the region in which we fail to reject <span class="math inline">\(H_0\)</span> shown by the turquoise bar and the red shading.
</p>
</div>
<p>For given values of <span class="math inline">\(\alpha\)</span>, <span class="math inline">\(\sigma\)</span> and <span class="math inline">\(\lambda\left(n,m\right)\)</span>, we can calculate the power function in terms of <span class="math inline">\(\tau\)</span> by finding the area of the distribution of <span class="math inline">\(D\)</span> under <span class="math inline">\(H_1\)</span> for which we accept <span class="math inline">\(H_1\)</span>.</p>
<p><span class="math display" id="eq:powerfun">\[\begin{equation}
\Psi\left(\tau\right) = 1-\beta = \left[1 - \operatorname{\Phi}\left(z_{\frac{\alpha}{2}} - \frac{\tau}{\sigma\lambda}\right)\right] + \operatorname{\Phi}\left(-z_{\frac{\alpha}{2}} - \frac{\tau}{\sigma\lambda}\right)
\tag{2.1}
\end{equation}\]</span></p>
<p>The first term in Equation <a href="rct-plan.html#eq:powerfun">(2.1)</a> is the area in the direction of <span class="math inline">\(\tau\)</span>. In Figures <a href="rct-plan.html#fig:accepth0">2.4</a> and <a href="rct-plan.html#fig:accepth0-1">2.5</a> this is the region to the right of the interval for which we fail to reject <span class="math inline">\(H_0\)</span>, ie. where <span class="math display">\[D &gt; z_{\frac{\alpha}{2}}.\]</span></p>
<p>The second term in Equation <a href="rct-plan.html#eq:powerfun">(2.1)</a> represents the area away from the direction of <span class="math inline">\(\tau\)</span>, ie. a value of <span class="math inline">\(D\)</span> such that</p>
<p><span class="math display">\[ D &lt; - z_{\frac{\alpha}{2}},\]</span>
assuming without loss of generality that <span class="math inline">\(\tau&gt;0\)</span>.</p>
<p>Figure <a href="rct-plan.html#fig:powercurve">2.6</a> shows the power function <span class="math inline">\(\Psi\left(\tau\right)\)</span> for <span class="math inline">\(\tau\)</span> in units of <span class="math inline">\(\sigma\)</span> (or you could think of this as for <span class="math inline">\(\sigma=1\)</span>), for three different pairs of values of <span class="math inline">\(n\)</span> and <span class="math inline">\(m\)</span> (remember that these enter the power function via <span class="math inline">\(\lambda\)</span>) with <span class="math inline">\(\alpha=0.05\)</span>. We see that in general the power is higher for larger sample sizes, and that of the two designs where <span class="math inline">\(n+m=200\)</span>, the balanced one with <span class="math inline">\(n=m=100\)</span> achieves the greatest power.</p>
<p>In general, the probability of rejecting <span class="math inline">\(H_0\)</span> increases as <span class="math inline">\(\tau\)</span> moves away from zero.</p>
<p>Notice also that all the curves pass through the point <span class="math inline">\(\tau=0,\,\beta=0.05\)</span>. Since <span class="math inline">\(\tau=0\)</span> corresponds to <span class="math inline">\(H_0\)</span> being true, it makes sense that the probability of rejecting the <span class="math inline">\(H_0\)</span> is the significance level <span class="math inline">\(\alpha\)</span>.</p>
<div class="figure"><span style="display:block;" id="fig:powercurve"></span>
<img src="CT4H_notes_files/figure-html/powercurve-1.png" alt="Power curves for various values of $n$ and $m$, with effect size in units of standard deviation, given a type I error rate of 0.05." width="768" />
<p class="caption">
Figure 2.6: Power curves for various values of <span class="math inline">\(n\)</span> and <span class="math inline">\(m\)</span>, with effect size in units of standard deviation, given a type I error rate of 0.05.
</p>
</div>
<p>It is common to think of the effect size in units of <span class="math inline">\(\sigma\)</span>, as we have done here. This makes results more intuitive, since we don’t need to have a good knowledge of the actual outcome variable to know what is a small or large effect size. It is also helpful in situations where the population standard deviation is not well understood, since the trial can be planned with this sort of effect size in mind. To denote the effect size in units of <span class="math inline">\(\sigma\)</span>, we will write <span class="math inline">\(\tau_\sigma\)</span>, although in practice it is more usual to give both the same notation. In a medical setting we will often have an estimate for <span class="math inline">\(\sigma\)</span> (for example from previous studies).</p>
</div>
<div id="sec-ssformulacont" class="section level2 hasAnchor" number="2.5">
<h2><span class="header-section-number">2.5</span> A sample size formula<a href="rct-plan.html#sec-ssformulacont" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Equation <a href="rct-plan.html#eq:powerfun">(2.1)</a> allows us to find any one of <span class="math inline">\(\tau_\sigma,\,\alpha,\,\beta\)</span> and <span class="math inline">\(\lambda\left(n,m\right)\)</span> given values for the others.</p>
<p>Values for <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(\beta\)</span> are often specified by those planning the trial as around <span class="math inline">\(\alpha \in \left[0.01,0.05\right],\,1-\beta\in\left[0.8,0.9\right]\)</span>. The remaining two values, <span class="math inline">\(\tau_\sigma\)</span> and <span class="math inline">\(\lambda\left(n,m\right)\)</span> are generally settled using one or both of the following questions:</p>
<ul>
<li>Given our budget constraints, and their implications for <span class="math inline">\(n\)</span> and <span class="math inline">\(m\)</span>, what is the smallest value of <span class="math inline">\(\tau_\sigma\)</span> we can achieve?</li>
<li>What is the smallest value of <span class="math inline">\(\tau_\sigma\)</span> that would be clinically useful to detect, and what value of <span class="math inline">\(\lambda\left(n,m\right)\)</span> do we need in order to achieve it?</li>
</ul>
<p>An important quantity is therefore the <strong>minimum detectable effect size</strong>, which we will denote <span class="math inline">\(\tau_M\)</span>.</p>
<div class="definition">
<p><span id="def:unlabeled-div-10" class="definition"><strong>Definition 2.5  </strong></span>The <strong>minimum detectable effect size</strong> <span class="math inline">\(\tau_M\)</span> for a particular trial is the smallest value of effect size that is able to be detected with power <span class="math inline">\(1-\beta\)</span> and at significance level <span class="math inline">\(\alpha\)</span> (for some specified values of <span class="math inline">\(\alpha,\;\beta\)</span>).</p>
</div>
<p>Note that we will not <em>definitely</em> detect an effect of size <span class="math inline">\(\tau_M\)</span>, if it exists; by construction, we will detect it with probability <span class="math inline">\(1-\beta\)</span>. If <span class="math inline">\(|\tau| &gt; |\tau_M|\)</span> (ie. the true effect size is further from zero than <span class="math inline">\(\tau_M\)</span> is) then the probability of detecting it will be greater than <span class="math inline">\(1-\beta\)</span>. If <span class="math inline">\(|\tau| &lt; |\tau_M|\)</span> then the probability of detecting it will be less than <span class="math inline">\(1-\beta\)</span>.</p>
<p>Although we could solve Equation <a href="rct-plan.html#eq:powerfun">(2.1)</a> numerically, in practice we use an approximation. The second term, representing observed values of <span class="math inline">\(D\)</span> that are far enough away from 0 <em>in the opposite direction from the true <span class="math inline">\(\tau\)</span></em> to lead us to reject <span class="math inline">\(H_0\)</span> is so negligible as to be able to be discounted entirely. Indeed, if we were to observe such a value of <span class="math inline">\(D\)</span>, we would come to the wrong conclusion about <span class="math inline">\(\tau\)</span>.</p>
<p>Therefore, Equation <a href="rct-plan.html#eq:powerfun">(2.1)</a> becomes</p>
<p><span class="math display" id="eq:powerfun2">\[\begin{equation}
\Psi\left(\tau\right) = 1-\beta = \left[1 - \operatorname{\Phi}\left(z_{\frac{\alpha}{2}} - \frac{\tau_M}{\sigma\lambda}\right)\right].
\tag{2.2}
\end{equation}\]</span></p>
<p>Because <span class="math inline">\(\operatorname{\Phi}\left(z_\beta\right) = 1 - \beta\)</span> (by definition) and <span class="math inline">\(\operatorname{\Phi}\left(-z\right) = 1 - \operatorname{\Phi}\left(z\right)\)</span> we can write this as</p>
<p><span class="math display">\[ \operatorname{\Phi}\left(z_\beta\right) = \operatorname{\Phi}\left(\frac{\tau_M}{\sigma\lambda} - z_{\frac{\alpha}{2}}\right), \]</span>
where <span class="math inline">\(\tau_M\)</span> is our minimum detectable effect size. Because of the monotonicity of <span class="math inline">\(\operatorname{\Phi}\left(\cdot\right)\)</span>, this becomes</p>
<p><span class="math display" id="eq:powerfun3">\[\begin{equation}
\begin{aligned}
  z_\beta &amp; = \frac{\tau_M}{\sigma\lambda} - z_{\frac{\alpha}{2}} \\
  z_\beta + z_{\frac{\alpha}{2}} &amp; = \frac{\tau_M}{\sigma\lambda}.
\end{aligned}
\tag{2.3}
\end{equation}\]</span></p>
<p>Because we want to think about sample sizes, we rewrite this further. It is most common to perform trials with <span class="math inline">\(n=m=N\)</span> participants in each group, in which case</p>
<p><span class="math display">\[ \lambda\left(n,m\right) = \sqrt{\frac{2}{N}}\]</span></p>
<p>and Equation <a href="rct-plan.html#eq:powerfun3">(2.3)</a> rearranges to</p>
<p><span class="math display" id="eq:sscont">\[\begin{equation}
    N = \frac{2\sigma^2\left(z_\beta + z_{\frac{\alpha}{2}}\right)^2}{\tau_M^2}.
    \tag{2.4}
\end{equation}\]</span></p>
<div class="example">
<p><span id="exm:sseg1" class="example"><strong>Example 2.1  </strong></span><span class="citation">(from <a href="#ref-zhong2009calculate">Zhong 2009</a>)</span>
A trial is being planned to test whether there is a difference in the efficacy of ACEII antagonist (a new drug) and ACE inhibitor (the standard drug) for the treatment of primary hypertension (high blood pressure). The primary outcome variable is change in sitting diastolic blood pressure (SDBP, mmHg) compared to a baseline measurement taken at the start of the trial. The trial should have a significance level of <span class="math inline">\(\alpha=0.05\)</span> and a power of <span class="math inline">\(1-\beta = 0.8\)</span>, with the same number of participants in each group. The minimum clinically important difference is <span class="math inline">\(\tau_M = 3 \text{ mmHg}\)</span> and the pooled standard deviation is <span class="math inline">\(s = 8 \text{ mmHg}\)</span>. Therefore, using equation <a href="rct-plan.html#eq:sscont">(2.4)</a> the sample size should be at least</p>
<p><span class="math display">\[\begin{align*}
      N &amp; = \frac{2\times{8}^2\left(0.842 + 1.96\right)^2}{3^2}\\
      &amp; = 111.6,
\end{align*}\]</span></p>
<p>and therefore we need at least 112 participants in each trial arm.</p>
</div>

</div>
</div>
<h3>References</h3>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-zhong2009calculate" class="csl-entry">
Zhong, Baoliang. 2009. <span>“How to Calculate Sample Size in Randomized Controlled Trial?”</span> <em>Journal of Thoracic Disease</em> 1 (1): 51.
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="rct-intro.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="alloc.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["CT4H_notes.pdf"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
},
"bookdown": null
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
